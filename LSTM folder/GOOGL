---
title: "Udvælgelse LSTM GOOGL"
author: "Cecilie B., Cecilie F. og Jakob K."
date: '2023-06-01'
output: html_document
---

```{r, include=FALSE}
rm(list = ls())
```

```{r, WARNING = FALSE}
library(tidyverse) #Collection of all the good stuff like dplyr, ggplot2 ect.
library(magrittr) #For advanced piping
library(keras) #For ANN models
library(tidymodels)
library(ggpubr) #package that helps mixing multiple plots on the same page
library(tstools)
library(fabletools)
```




```{r, include=FALSE}
set.seed(3434)
```


# Data overblik

Indlæser data.

```{r, warning=FALSE, results='hide'}
data <- read.csv("https://raw.githubusercontent.com/JakobTheSlott/Kandidat/main/Assets.csv")
SP500 <- read.csv("https://raw.githubusercontent.com/JakobTheSlott/Kandidat/main/SP%20500.csv")
```

Ændre navn af data kollonen i datasættet data.

```{r, warning=FALSE, results='hide'}
colnames(data)[1]  <- "Date"
```

Laver Date kollonnen om til data-typen date.

```{r, warning=FALSE, results='hide'} 
data$Date <- as.Date(data$Date, "%d/%m/%Y")
```

```{r, warning=FALSE, results='hide'} 
SP500$Date <- as.Date(SP500$Date, "%d/%m/%Y")
```


Afkorter data i overensstemmelse med specialets valgte periode. 

```{r, warning=FALSE, results='hide'}
SP500 %<>% filter(Date<=as.Date('2023-01-01') & Date >= ('2013-01-01'))
```

```{r, warning=FALSE, results='hide'}
data %<>% filter(Date<=as.Date('2023-01-01') & Date >= ('2013-01-01'))
```


```{r, warning=FALSE, results='hide'}
data %<>% arrange(Date)
SP500 %<>% arrange(Date)
```


Med henblik på at anvende ARIMA modeller, er det nødvendigt at der forekommer samme antal observationer årligt, da dette skaber grundlag for en ensartet frekvens når data omdannes til et ts objekt i R. Der fjernes derfor tilfældige observationer de år hvor der forekommer flere end 251 observationer.



```{r, warning=FALSE, results='hide'}
data <- data[-c(10, 350, 700 , 1000, 1900, 1600, 2000, 2100), ]
```

```{r, warning=FALSE, results='hide'}
data_GOOGL_price <- data %>%
  select(Date, GOOGL) %>%
  drop_na()
```

```{r, warning=FALSE, results='hide'}
data_test_GOOGL_price <- data_GOOGL_price %>% filter(Date >= "2020-01-01")
```


# Split af træning og test data
```{r, warning=FALSE, results='hide'}
data_GOOGL <- data %>%
  mutate(AGOOGL = (GOOGL - lag(GOOGL,1))) %>%
  select(Date, AGOOGL) %>%
  drop_na()
```

```{r, warning=FALSE, results='hide'}
data_train_GOOGL <- data_GOOGL %>% filter(Date <= "2019-12-31")
data_test_GOOGL <- data_GOOGL %>% filter(Date >= "2020-01-01")
```



# Definerer recipe
Værdierne normaliseres og skaleres
```{r, warning=FALSE, results='hide'}
data_recipe <- data_train_GOOGL %>%
 recipe(AGOOGL ~ .) %>% 
  step_normalize(AGOOGL) %>%
  step_arrange(Date) %>%
  prep()
```


Gemmer normalisering og skalerings værdierne til gendannelse senere.
```{r, warning=FALSE, results='hide'}
prep_history <- tibble(
  mean = data_recipe$steps[[1]]$means,
  sds = data_recipe$steps[[1]]$sds
)

prep_history
```


```{r, warning=FALSE, results='hide'}
reverse_norm<- function(x, mean, sds) {
  x_re <- (x * sds) + mean
  return(x_re)
  }
```


```{r, warning=FALSE, results='hide'}
n_lag <- 10

# Trænings-data
x_train_GOOGL <- data_recipe %>% juice() %>% select(-Date)  %>%   as.matrix()

y_train_GOOGL <- data_recipe %>%  juice() %>%
  mutate(value = AGOOGL %>% lead(n_lag)) %>%
  tidyr::fill(value, .direction = "downup") %>% select(AGOOGL) %>%   as.matrix()

# Test-data
x_test_GOOGL <- data_recipe %>% bake(data_test_GOOGL)  %>% select(-Date) %>%   as.matrix()

y_test_GOOGL <- data_recipe %>%  bake(data_test_GOOGL) %>%  
  mutate(value = AGOOGL %>% lead(n_lag)) %>%
  tidyr::fill(value, .direction = "downup") %>% select(AGOOGL) %>%   as.matrix()
```



## Transformerer det til en 3d tensor således at Kreas er i stand til at bearbejde data
```{r, warning=FALSE, results='hide'}
## Transformerer til et time-step
x_train_arr_GOOGL <- x_train_GOOGL  %>% as.numeric() %>% array_reshape(dim = c(length(.),1, 1))
x_test_arr_GOOGL <- x_test_GOOGL  %>% as.numeric() %>% array_reshape(dim = c(length(.), 1, 1))

y_train_arr_GOOGL <- y_train_GOOGL  %>% as.numeric() %>% array_reshape(dim = c(length(.), 1))
y_test_arr_GOOGL <- y_test_GOOGL %>% as.numeric() %>% array_reshape(dim = c(length(.), 1))
```


```{r, warning=FALSE, results='hide'}
datalags <- 10
```

```{r, warning=FALSE, results='hide'}
## Transformerer til ti time-step
x_train_arr_GOOGL1 <- array(data = x_train_GOOGL, dim = c(nrow(x_train_GOOGL)+1,n_lag, 1))
x_test_arr_GOOGL1 <- array(data = x_test_GOOGL, dim = c(nrow(x_test_GOOGL)+1,n_lag, 1))

y_train_arr_GOOGL1 <- array(data = y_train_GOOGL, dim = c(nrow(y_train_GOOGL)+1, 1))
y_test_arr_GOOGL1 <- array(data = y_test_GOOGL, dim = c(nrow(y_test_GOOGL)+1, 1))
```


```{r, warning=FALSE, results='hide'}
n_features <- 1
timesteps <- 10
batch_size16 <- 16
batch_size32 <- 32
batch_size64 <- 64
```









# LSTM GOOGL -  10  time-steps, 2 Layers og drop-out 0.2


### GOOGL: 2 Layers, 10 time-steps, drop-out rate 0.2 og batch size 16
```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U128_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U128_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U8_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U8_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```





### GOOGL: 2 Layers, 10 time-steps, drop-out rate 0.2 og batch size 32 



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U128_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U128_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U8_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U8_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U128_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U128_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U8_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U8_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```




### GOOGL: 2 Layers, 10 time-steps, drop-out rate 0.2 og batch size 64



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U128_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U128_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U8_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U8_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U128_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U128_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U8_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U8_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```










# LSTM GOOGL -  10  time-steps, 2 Layers og drop-out 0.3


### GOOGL: 2 Layers, 10 time-steps, drop-out rate 0.3 og batch size 16
```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U128_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U128_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U8_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U8_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```





### GOOGL: 2 Layers, 10 time-steps, drop-out rate 0.3 og batch size 32 GOOGL



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U128_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U128_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U8_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U8_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U128_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U128_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U8_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U8_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```




### GOOGL: 2 Layers, 10 time-steps, drop-out rate 0.3 og batch size 64



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U128_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U128_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U8_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U8_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U128_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U128_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U128_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U128_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U64_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U64_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U32_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U32_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U16_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U16_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L2_U8_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L2_U8_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```





# LSTM GOOGL -  10  time-steps, 3 Layers og drop-out 0.2


### GOOGL: 3 Layers, 10 time-steps, drop-out rate 0.2 og batch size 16


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U128_U128_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U128_U128_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U128_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U128_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U64_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U64_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U64_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U64_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U64_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U64_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U64_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U64_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U32_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U32_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U32_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U32_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U32_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U32_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U32_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U32_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U16_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U16_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U16_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U16_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U16_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U16_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U16_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U16_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U8_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U8_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U8_U8_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U8_U8_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



### GOOGL: 3 Layers, 10 time-steps, drop-out rate 0.2 og batch size 32


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U128_U128_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U128_U128_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U128_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U128_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U64_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U64_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U64_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U64_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U64_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U64_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U64_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U64_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U32_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U32_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U32_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U32_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U32_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U32_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U32_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U32_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U16_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U16_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U16_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U16_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U16_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U16_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U16_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U16_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U8_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U8_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U8_U8_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U8_U8_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



### GOOGL: 3 Layers, 10 time-steps, drop-out rate 0.2 og batch size 64


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U128_U128_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U128_U128_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U128_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U128_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U64_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U64_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U64_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U64_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U64_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U64_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U64_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U64_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U32_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U32_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U32_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U32_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U32_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U32_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U32_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U32_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U16_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U16_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U16_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U16_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U16_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U16_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U16_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U16_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U8_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U8_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U8_U8_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U8_U8_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```





# LSTM GOOGL -  10  time-steps, 3 Layers og drop-out 0.3



### GOOGL: 3 Layers, 10 time-steps, drop-out rate 0.3 og batch size 16


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U128_U128_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U128_U128_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U128_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U128_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U64_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U64_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U64_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U64_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U64_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U64_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U64_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U64_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U32_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U32_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U32_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U32_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U32_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U32_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U32_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U32_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U16_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U16_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U16_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U16_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U16_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U16_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U16_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U16_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U8_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U8_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U8_U8_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U8_U8_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



### GOOGL: 3 Layers, 10 time-steps, drop-out rate 0.3 og batch size 32


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U128_U128_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U128_U128_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U128_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U128_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U64_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U64_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U64_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U64_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U64_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U64_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U64_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U64_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U32_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U32_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U32_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U32_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U32_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U32_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U32_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U32_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U16_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U16_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U16_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U16_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U16_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U16_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U16_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U16_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U8_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U8_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U8_U8_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U8_U8_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



### GOOGL: 3 Layers, 10 time-steps, drop-out rate 0.3 og batch size 64


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U128_U128_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U128_U128_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U128_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U128_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U64_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U64_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U128_U64_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U128_U64_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U64_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U64_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U64_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U64_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U32_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U32_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U64_U32_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U64_U32_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U32_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U32_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U32_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U32_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U16_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U16_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U32_U16_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U32_U16_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U16_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U16_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U16_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U16_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U16_U8_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U16_U8_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L3_U8_U8_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L3_U8_U8_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```








# LSTM GOOGL -  10  time-steps, 4 Layers og drop-out 0.2


### GOOGL: 4 Layers, 10 time-steps, drop-out rate 0.2 og batch size 16


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U128_U128_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U128_U128_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U128_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U128_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U64_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U64_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U64_U64_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U64_U64_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U64_U64_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U64_U64_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U64_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U64_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U64_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U64_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U32_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U32_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U32_U32_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U32_U32_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U32_U32_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U32_U32_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U32_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U32_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U32_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U32_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U16_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U16_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U16_U16_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 16, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U16_U16_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U16_U16_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U16_U16_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U16_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U16_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U16_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U16_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U8_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U8_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U8_U8_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U8_U8_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U8_U8_U8_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U8_U8_U8_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



### GOOGL: 4 Layers, 10 time-steps, drop-out rate 0.2 og batch size 32

```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U128_U128_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U128_U128_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U128_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U128_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U64_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U64_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U64_U64_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U64_U64_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U64_U64_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U64_U64_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U64_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U64_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U64_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U64_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U32_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U32_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U32_U32_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U32_U32_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U32_U32_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U32_U32_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U32_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U32_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```




```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U32_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U32_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U16_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U16_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U16_U16_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 16, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U16_U16_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U16_U16_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U16_U16_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U16_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U16_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U16_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U16_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U8_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U8_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U8_U8_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U8_U8_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U8_U8_U8_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U8_U8_U8_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```




### GOOGL: 4 Layers, 10 time-steps, drop-out rate 0.2 og batch size 64

```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U128_U128_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U128_U128_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U128_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U128_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U64_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U64_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U64_U64_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U64_U64_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U64_U64_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U64_U64_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U64_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U64_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U64_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U64_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U32_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U32_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U32_U32_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U32_U32_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U32_U32_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U32_U32_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U32_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U32_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U32_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U32_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U16_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U16_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U16_U16_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 16, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U16_U16_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U16_U16_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U16_U16_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U16_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U16_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U16_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U16_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U8_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U8_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U8_U8_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U8_U8_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U8_U8_U8_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U8_U8_U8_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```




# LSTM GOOGL -  10  time-steps, 4 Layers og drop-out 0.3


### GOOGL: 4 Layers, 10 time-steps, drop-out rate 0.3 og batch size 16



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U128_U128_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U128_U128_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U128_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U128_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U64_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U64_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U64_U64_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U64_U64_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U64_U64_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U64_U64_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U64_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U64_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U64_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U64_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U32_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U32_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U32_U32_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U32_U32_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U32_U32_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U32_U32_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U32_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U32_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U32_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U32_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U16_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U16_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U16_U16_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 16, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U16_U16_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U16_U16_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U16_U16_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U16_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U16_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U16_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U16_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U8_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U8_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U8_U8_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U8_U8_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U8_U8_U8_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U8_U8_U8_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



### GOOGL: 4 Layers, 10 time-steps, drop-out rate 0.3 og batch size 32

```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U128_U128_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U128_U128_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U128_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U128_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U64_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U64_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U64_U64_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U64_U64_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U64_U64_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U64_U64_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U64_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U64_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U64_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U64_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U32_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U32_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U32_U32_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U32_U32_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U32_U32_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U32_U32_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U32_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U32_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U32_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U32_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U16_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U16_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U16_U16_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 16, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U16_U16_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U16_U16_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U16_U16_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U16_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U16_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U16_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U16_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U8_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U8_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U8_U8_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U8_U8_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U8_U8_U8_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U8_U8_U8_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```




### GOOGL: 4 Layers, 10 time-steps, drop-out rate 0.3 og batch size 64


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U128_U128_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U128_U128_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U128_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U128_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U128_U64_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U128_U64_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U64_U64_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U64_U64_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U128_U64_U64_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U128_U64_U64_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U64_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U64_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U64_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U64_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U64_U32_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U64_U32_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U32_U32_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U32_U32_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U64_U32_U32_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U64_U32_U32_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U32_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U32_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U32_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U32_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U32_U16_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U32_U16_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U16_U16_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 16, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U16_U16_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U32_U16_U16_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U32_U16_U16_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U16_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U16_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U16_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U16_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U16_U8_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U16_U8_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U16_U8_U8_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U16_U8_U8_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t10_L4_U8_U8_U8_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = c(timesteps, 1),
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t10_L4_U8_U8_U8_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```




# Fitting af GOOGL 2-layers og drop-out 0.2


### GOOGL: 2 Layers, 10 time-steps, drop-out rate 0.2 og batch size 16

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U128_U128_B16_D02 <- model_GOOGL_t10_L2_U128_U128_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U128_U64_B16_D02 <- model_GOOGL_t10_L2_U128_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U64_U64_B16_D02 <- model_GOOGL_t10_L2_U64_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U64_U32_B16_D02 <- model_GOOGL_t10_L2_U64_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U32_U32_B16_D02 <- model_GOOGL_t10_L2_U32_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U32_U16_B16_D02 <- model_GOOGL_t10_L2_U32_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U16_U16_B16_D02 <- model_GOOGL_t10_L2_U16_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U16_U8_B16_D02 <- model_GOOGL_t10_L2_U16_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U8_U8_B16_D02 <- model_GOOGL_t10_L2_U8_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```






### GOOGL: 2 Layers, 10 time-steps, drop-out rate 0.2 og batch size 32

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U128_U128_B32_D02 <- model_GOOGL_t10_L2_U128_U128_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U128_U64_B32_D02 <- model_GOOGL_t10_L2_U128_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U64_U64_B32_D02 <- model_GOOGL_t10_L2_U64_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U64_U32_B32_D02 <- model_GOOGL_t10_L2_U64_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U32_U32_B32_D02 <- model_GOOGL_t10_L2_U32_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U32_U16_B32_D02 <- model_GOOGL_t10_L2_U32_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U16_U16_B32_D02 <- model_GOOGL_t10_L2_U16_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U16_U8_B32_D02 <- model_GOOGL_t10_L2_U16_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U8_U8_B32_D02 <- model_GOOGL_t10_L2_U8_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```











### GOOGL: 2 Layers, 10 time-steps, drop-out rate 0.2 og batch size 64

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U128_U128_B64_D02 <- model_GOOGL_t10_L2_U128_U128_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U128_U64_B64_D02 <- model_GOOGL_t10_L2_U128_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U64_U64_B64_D02 <- model_GOOGL_t10_L2_U64_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U64_U32_B64_D02 <- model_GOOGL_t10_L2_U64_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U32_U32_B64_D02 <- model_GOOGL_t10_L2_U32_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U32_U16_B64_D02 <- model_GOOGL_t10_L2_U32_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U16_U16_B64_D02 <- model_GOOGL_t10_L2_U16_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U16_U8_B64_D02 <- model_GOOGL_t10_L2_U16_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U8_U8_B64_D02 <- model_GOOGL_t10_L2_U8_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```




# Fitting af GOOGL 2-layers og drop-out 0.3

### GOOGL: 2 Layers, 10 time-steps, drop-out rate 0.3 og batch size 16

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U128_U128_B16_D03 <- model_GOOGL_t10_L2_U128_U128_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U128_U64_B16_D03 <- model_GOOGL_t10_L2_U128_U64_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U64_U64_B16_D03 <- model_GOOGL_t10_L2_U64_U64_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U64_U32_B16_D03 <- model_GOOGL_t10_L2_U64_U32_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U32_U32_B16_D03 <- model_GOOGL_t10_L2_U32_U32_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U32_U16_B16_D03 <- model_GOOGL_t10_L2_U32_U16_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U16_U16_B16_D03 <- model_GOOGL_t10_L2_U16_U16_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U16_U8_B16_D03 <- model_GOOGL_t10_L2_U16_U8_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U8_U8_B16_D03 <- model_GOOGL_t10_L2_U8_U8_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```







### GOOGL: 2 Layers, 10 time-steps, drop-out rate 0.3 og batch size 32

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U128_U128_B32_D03 <- model_GOOGL_t10_L2_U128_U128_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U128_U64_B32_D03 <- model_GOOGL_t10_L2_U128_U64_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U64_U64_B32_D03 <- model_GOOGL_t10_L2_U64_U64_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U64_U32_B32_D03 <- model_GOOGL_t10_L2_U64_U32_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U32_U32_B32_D03 <- model_GOOGL_t10_L2_U32_U32_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U32_U16_B32_D03 <- model_GOOGL_t10_L2_U32_U16_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U16_U16_B32_D03 <- model_GOOGL_t10_L2_U16_U16_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U16_U8_B32_D03 <- model_GOOGL_t10_L2_U16_U8_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U8_U8_B32_D03 <- model_GOOGL_t10_L2_U8_U8_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```











### GOOGL: 2 Layers, 10 time-steps, drop-out rate 0.3 og batch size 64

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U128_U128_B64_D03 <- model_GOOGL_t10_L2_U128_U128_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U128_U64_B64_D03 <- model_GOOGL_t10_L2_U128_U64_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U64_U64_B64_D03 <- model_GOOGL_t10_L2_U64_U64_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U64_U32_B64_D03 <- model_GOOGL_t10_L2_U64_U32_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U32_U32_B64_D03 <- model_GOOGL_t10_L2_U32_U32_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U32_U16_B64_D03 <- model_GOOGL_t10_L2_U32_U16_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U16_U16_B64_D03 <- model_GOOGL_t10_L2_U16_U16_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U16_U8_B64_D03 <- model_GOOGL_t10_L2_U16_U8_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L2_U8_U8_B64_D03 <- model_GOOGL_t10_L2_U8_U8_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```








# Fitting af GOOGL 3-layers og drop-out 0.2


### GOOGL: 3 Layers, 10 time-steps, drop-out rate 0.2 og batch size 16

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U128_U128_B16_D02 <- model_GOOGL_t10_L3_U128_U128_U128_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U128_U64_B16_D02 <- model_GOOGL_t10_L3_U128_U128_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U64_U64_B16_D02 <- model_GOOGL_t10_L3_U128_U64_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U64_U32_B16_D02 <- model_GOOGL_t10_L3_U128_U64_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U64_U64_B16_D02 <- model_GOOGL_t10_L3_U64_U64_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U64_U32_B16_D02 <- model_GOOGL_t10_L3_U64_U64_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U32_U32_B16_D02 <- model_GOOGL_t10_L3_U64_U32_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U32_U16_B16_D02 <- model_GOOGL_t10_L3_U64_U32_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U32_U32_B16_D02 <- model_GOOGL_t10_L3_U32_U32_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U32_U16_B16_D02 <- model_GOOGL_t10_L3_U32_U32_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U16_U16_B16_D02 <- model_GOOGL_t10_L3_U32_U16_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U16_U16_B16_D02 <- model_GOOGL_t10_L3_U16_U16_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U16_U8_B16_D02 <- model_GOOGL_t10_L3_U16_U16_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U8_U8_B16_D02 <- model_GOOGL_t10_L3_U16_U8_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U8_U8_U8_B16_D02 <- model_GOOGL_t10_L3_U8_U8_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```








### GOOGL: 3 Layers, 10 time-steps, drop-out rate 0.2 og batch size 32

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U128_U128_B32_D02 <- model_GOOGL_t10_L3_U128_U128_U128_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U128_U64_B32_D02 <- model_GOOGL_t10_L3_U128_U128_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U64_U64_B32_D02 <- model_GOOGL_t10_L3_U128_U64_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U64_U32_B32_D02 <- model_GOOGL_t10_L3_U128_U64_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U64_U64_B32_D02 <- model_GOOGL_t10_L3_U64_U64_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U64_U32_B32_D02 <- model_GOOGL_t10_L3_U64_U64_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U32_U32_B32_D02 <- model_GOOGL_t10_L3_U64_U32_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U32_U16_B32_D02 <- model_GOOGL_t10_L3_U64_U32_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U32_U32_B32_D02 <- model_GOOGL_t10_L3_U32_U32_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U32_U16_B32_D02 <- model_GOOGL_t10_L3_U32_U32_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U16_U16_B32_D02 <- model_GOOGL_t10_L3_U32_U16_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U16_U16_B32_D02 <- model_GOOGL_t10_L3_U16_U16_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U16_U8_B32_D02 <- model_GOOGL_t10_L3_U16_U16_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U8_U8_B32_D02 <- model_GOOGL_t10_L3_U16_U8_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U8_U8_U8_B32_D02 <- model_GOOGL_t10_L3_U8_U8_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```







### GOOGL: 3 Layers, 10 time-steps, drop-out rate 0.2 og batch size 64

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U128_U128_B64_D02 <- model_GOOGL_t10_L3_U128_U128_U128_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U128_U64_B64_D02 <- model_GOOGL_t10_L3_U128_U128_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U64_U64_B64_D02 <- model_GOOGL_t10_L3_U128_U64_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U64_U32_B64_D02 <- model_GOOGL_t10_L3_U128_U64_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U64_U64_B64_D02 <- model_GOOGL_t10_L3_U64_U64_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U64_U32_B64_D02 <- model_GOOGL_t10_L3_U64_U64_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U32_U32_B64_D02 <- model_GOOGL_t10_L3_U64_U32_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U32_U16_B64_D02 <- model_GOOGL_t10_L3_U64_U32_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U32_U32_B64_D02 <- model_GOOGL_t10_L3_U32_U32_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U32_U16_B64_D02 <- model_GOOGL_t10_L3_U32_U32_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U16_U16_B64_D02 <- model_GOOGL_t10_L3_U32_U16_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U16_U16_B64_D02 <- model_GOOGL_t10_L3_U16_U16_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U16_U8_B64_D02 <- model_GOOGL_t10_L3_U16_U16_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U8_U8_B64_D02 <- model_GOOGL_t10_L3_U16_U8_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U8_U8_U8_B64_D02 <- model_GOOGL_t10_L3_U8_U8_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```






# Fitting af GOOGL 3-layers og drop-out 0.3


### GOOGL: 3 Layers, 10 time-steps, drop-out rate 0.3 og batch size 16

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U128_U128_B16_D02 <- model_GOOGL_t10_L3_U128_U128_U128_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U128_U64_B16_D02 <- model_GOOGL_t10_L3_U128_U128_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U64_U64_B16_D02 <- model_GOOGL_t10_L3_U128_U64_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U64_U32_B16_D02 <- model_GOOGL_t10_L3_U128_U64_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U64_U64_B16_D02 <- model_GOOGL_t10_L3_U64_U64_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U64_U32_B16_D02 <- model_GOOGL_t10_L3_U64_U64_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U32_U32_B16_D02 <- model_GOOGL_t10_L3_U64_U32_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U32_U16_B16_D02 <- model_GOOGL_t10_L3_U64_U32_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U32_U32_B16_D02 <- model_GOOGL_t10_L3_U32_U32_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U32_U16_B16_D02 <- model_GOOGL_t10_L3_U32_U32_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U16_U16_B16_D02 <- model_GOOGL_t10_L3_U32_U16_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U16_U16_B16_D02 <- model_GOOGL_t10_L3_U16_U16_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U16_U8_B16_D02 <- model_GOOGL_t10_L3_U16_U16_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U8_U8_B16_D02 <- model_GOOGL_t10_L3_U16_U8_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U8_U8_U8_B16_D02 <- model_GOOGL_t10_L3_U8_U8_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```








### GOOGL: 3 Layers, 10 time-steps, drop-out rate 0.3 og batch size 32

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U128_U128_B32_D02 <- model_GOOGL_t10_L3_U128_U128_U128_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U128_U64_B32_D02 <- model_GOOGL_t10_L3_U128_U128_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U64_U64_B32_D02 <- model_GOOGL_t10_L3_U128_U64_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U64_U32_B32_D02 <- model_GOOGL_t10_L3_U128_U64_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U64_U64_B32_D02 <- model_GOOGL_t10_L3_U64_U64_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U64_U32_B32_D02 <- model_GOOGL_t10_L3_U64_U64_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U32_U32_B32_D02 <- model_GOOGL_t10_L3_U64_U32_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U32_U16_B32_D02 <- model_GOOGL_t10_L3_U64_U32_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U32_U32_B32_D02 <- model_GOOGL_t10_L3_U32_U32_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U32_U16_B32_D02 <- model_GOOGL_t10_L3_U32_U32_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U16_U16_B32_D02 <- model_GOOGL_t10_L3_U32_U16_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U16_U16_B32_D02 <- model_GOOGL_t10_L3_U16_U16_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U16_U8_B32_D02 <- model_GOOGL_t10_L3_U16_U16_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U8_U8_B32_D02 <- model_GOOGL_t10_L3_U16_U8_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U8_U8_U8_B32_D02 <- model_GOOGL_t10_L3_U8_U8_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```







### GOOGL: 3 Layers, 10 time-steps, drop-out rate 0.3 og batch size 64

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U128_U128_B64_D02 <- model_GOOGL_t10_L3_U128_U128_U128_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U128_U64_B64_D02 <- model_GOOGL_t10_L3_U128_U128_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U64_U64_B64_D02 <- model_GOOGL_t10_L3_U128_U64_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U128_U64_U32_B64_D02 <- model_GOOGL_t10_L3_U128_U64_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U64_U64_B64_D02 <- model_GOOGL_t10_L3_U64_U64_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U64_U32_B64_D02 <- model_GOOGL_t10_L3_U64_U64_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U32_U32_B64_D02 <- model_GOOGL_t10_L3_U64_U32_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U64_U32_U16_B64_D02 <- model_GOOGL_t10_L3_U64_U32_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U32_U32_B64_D02 <- model_GOOGL_t10_L3_U32_U32_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U32_U16_B64_D02 <- model_GOOGL_t10_L3_U32_U32_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U32_U16_U16_B64_D02 <- model_GOOGL_t10_L3_U32_U16_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U16_U16_B64_D02 <- model_GOOGL_t10_L3_U16_U16_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U16_U8_B64_D02 <- model_GOOGL_t10_L3_U16_U16_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U16_U8_U8_B64_D02 <- model_GOOGL_t10_L3_U16_U8_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L3_U8_U8_U8_B64_D02 <- model_GOOGL_t10_L3_U8_U8_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```




# Fitting af GOOGL 4-layers og drop-out 0.2


### GOOGL: 4 Layers, 10 time-steps, drop-out rate 0.2 og batch size 16



```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U128_U128_U128_B16_D02 <- model_GOOGL_t10_L4_U128_U128_U128_U128_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U128_U128_U64_B16_D02 <- model_GOOGL_t10_L4_U128_U128_U128_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_model_GOOGL_t10_L4_U128_U128_U64_U64_B16_D02 <- model_GOOGL_t10_L4_U128_U128_U64_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U64_U64_U64_B16_D02 <- model_GOOGL_t10_L4_U128_U64_U64_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                  
                                      Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U64_U64_U32_B16_D02 <- model_GOOGL_t10_L4_U128_U64_U64_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U64_U64_B16_D02 <- model_GOOGL_t10_L4_U64_U64_U64_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U64_U32_B16_D02 <- model_GOOGL_t10_L4_U64_U64_U64_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U32_U32_B16_D02 <- model_GOOGL_t10_L4_U64_U64_U32_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U32_U32_U32_B16_D02 <- model_GOOGL_t10_L4_U64_U32_U32_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U32_U32_U16_B16_D02 <- model_GOOGL_t10_L4_U64_U32_U32_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U32_U32_U32_B16_D02 <- model_GOOGL_t10_L4_U32_U32_U32_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U32_U32_U16_B16_D02 <- model_GOOGL_t10_L4_U32_U32_U32_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U32_U16_U16_B16_D02 <- model_GOOGL_t10_L4_U32_U32_U16_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U16_U16_U16_B16_D02 <- model_GOOGL_t10_L4_U32_U16_U16_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U16_U16_U8_B16_D02 <- model_GOOGL_t10_L4_U32_U16_U16_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U16_U16_U16_U16_B16_D02 <- model_GOOGL_t10_L4_U16_U16_U16_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U16_U16_U16_U8_B16_D02 <- model_GOOGL_t10_L4_U16_U16_U16_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```








### GOOGL: 4 Layers, 10 time-steps, drop-out rate 0.2 og batch size 32

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U128_U128_U128_B32_D02 <- model_GOOGL_t10_L4_U128_U128_U128_U128_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U128_U128_U64_B32_D02 <- model_GOOGL_t10_L4_U128_U128_U128_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_model_GOOGL_t10_L4_U128_U128_U64_U64_B32_D02 <- model_GOOGL_t10_L4_U128_U128_U64_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U64_U64_U64_B32_D02 <- model_GOOGL_t10_L4_U128_U64_U64_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                  
                                      Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U64_U64_U32_B32_D02 <- model_GOOGL_t10_L4_U128_U64_U64_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U64_U64_B32_D02 <- model_GOOGL_t10_L4_U64_U64_U64_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U64_U32_B32_D02 <- model_GOOGL_t10_L4_U64_U64_U64_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U32_U32_B32_D02 <- model_GOOGL_t10_L4_U64_U64_U32_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U32_U32_U32_B32_D02 <- model_GOOGL_t10_L4_U64_U32_U32_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U32_U32_U16_B32_D02 <- model_GOOGL_t10_L4_U64_U32_U32_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U32_U32_U32_B32_D02 <- model_GOOGL_t10_L4_U32_U32_U32_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U32_U16_U16_B32_D02 <- model_GOOGL_t10_L4_U32_U32_U16_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U16_U16_U16_B32_D02 <- model_GOOGL_t10_L4_U32_U16_U16_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U16_U16_U8_B32_D02 <- model_GOOGL_t10_L4_U32_U16_U16_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U16_U16_U16_U16_B32_D02 <- model_GOOGL_t10_L4_U16_U16_U16_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U16_U16_U16_U8_B32_D02 <- model_GOOGL_t10_L4_U16_U16_U16_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```






### GOOGL: 4 Layers, 10 time-steps, drop-out rate 0.2 og batch size 64

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U128_U128_U128_B64_D02 <- model_GOOGL_t10_L4_U128_U128_U128_U128_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U128_U128_U64_B64_D02 <- model_GOOGL_t10_L4_U128_U128_U128_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_model_GOOGL_t10_L4_U128_U128_U64_U64_B64_D02 <- model_GOOGL_t10_L4_U128_U128_U64_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U64_U64_U64_B64_D02 <- model_GOOGL_t10_L4_U128_U64_U64_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                  
                                      Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U64_U64_U32_B64_D02 <- model_GOOGL_t10_L4_U128_U64_U64_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U64_U64_B64_D02 <- model_GOOGL_t10_L4_U64_U64_U64_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U64_U32_B64_D02 <- model_GOOGL_t10_L4_U64_U64_U64_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U32_U32_B64_D02 <- model_GOOGL_t10_L4_U64_U64_U32_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U32_U32_U32_B64_D02 <- model_GOOGL_t10_L4_U64_U32_U32_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U32_U32_U16_B64_D02 <- model_GOOGL_t10_L4_U64_U32_U32_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U32_U32_U32_B64_D02 <- model_GOOGL_t10_L4_U32_U32_U32_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U32_U16_U16_B64_D02 <- model_GOOGL_t10_L4_U32_U32_U16_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U16_U16_U16_B64_D02 <- model_GOOGL_t10_L4_U32_U16_U16_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U16_U16_U8_B64_D02 <- model_GOOGL_t10_L4_U32_U16_U16_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U16_U16_U16_U16_B64_D02 <- model_GOOGL_t10_L4_U16_U16_U16_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U16_U16_U16_U8_B64_D02 <- model_GOOGL_t10_L4_U16_U16_U16_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```







# Fitting af GOOGL 4-layers og drop-out 0.3


### GOOGL: 4 Layers, 10 time-steps, drop-out rate 0.3 og batch size 16

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U128_U128_U128_B16_D03 <- model_GOOGL_t10_L4_U128_U128_U128_U128_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U128_U128_U64_B16_D03 <- model_GOOGL_t10_L4_U128_U128_U128_U64_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_model_GOOGL_t10_L4_U128_U128_U64_U64_B16_D03 <- model_GOOGL_t10_L4_U128_U128_U64_U64_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U64_U64_U64_B16_D03 <- model_GOOGL_t10_L4_U128_U64_U64_U64_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                  
                                      Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U64_U64_U32_B16_D03 <- model_GOOGL_t10_L4_U128_U64_U64_U32_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U64_U64_B16_D03 <- model_GOOGL_t10_L4_U64_U64_U64_U64_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U64_U32_B16_D03 <- model_GOOGL_t10_L4_U64_U64_U64_U32_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U32_U32_B16_D03 <- model_GOOGL_t10_L4_U64_U64_U32_U32_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U32_U32_U32_B16_D03 <- model_GOOGL_t10_L4_U64_U32_U32_U32_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U32_U32_U16_B16_D03 <- model_GOOGL_t10_L4_U64_U32_U32_U16_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U32_U32_U32_B16_D03 <- model_GOOGL_t10_L4_U32_U32_U32_U32_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U32_U16_U16_B16_D03 <- model_GOOGL_t10_L4_U32_U32_U16_U16_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U16_U16_U16_B16_D03 <- model_GOOGL_t10_L4_U32_U16_U16_U16_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U16_U16_U8_B16_D03 <- model_GOOGL_t10_L4_U32_U16_U16_U8_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U16_U16_U16_U16_B16_D03 <- model_GOOGL_t10_L4_U16_U16_U16_U16_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U16_U16_U16_U8_B16_D03 <- model_GOOGL_t10_L4_U16_U16_U16_U8_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```







### GOOGL: 4 Layers, 10 time-steps, drop-out rate 0.3 og batch size 32

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U128_U128_U128_B32_D03 <- model_GOOGL_t10_L4_U128_U128_U128_U128_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U128_U128_U64_B32_D03 <- model_GOOGL_t10_L4_U128_U128_U128_U64_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_model_GOOGL_t10_L4_U128_U128_U64_U64_B32_D03 <- model_GOOGL_t10_L4_U128_U128_U64_U64_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U64_U64_U64_B32_D03 <- model_GOOGL_t10_L4_U128_U64_U64_U64_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                  
                                      Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U64_U64_U32_B32_D03 <- model_GOOGL_t10_L4_U128_U64_U64_U32_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U64_U64_B32_D03 <- model_GOOGL_t10_L4_U64_U64_U64_U64_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U64_U32_B32_D03 <- model_GOOGL_t10_L4_U64_U64_U64_U32_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U32_U32_B32_D03 <- model_GOOGL_t10_L4_U64_U64_U32_U32_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U32_U32_U32_B32_D03 <- model_GOOGL_t10_L4_U64_U32_U32_U32_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U32_U32_U16_B32_D03 <- model_GOOGL_t10_L4_U64_U32_U32_U16_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U32_U32_U32_B32_D03 <- model_GOOGL_t10_L4_U32_U32_U32_U32_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U32_U16_U16_B32_D03 <- model_GOOGL_t10_L4_U32_U32_U16_U16_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U16_U16_U16_B32_D03 <- model_GOOGL_t10_L4_U32_U16_U16_U16_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U16_U16_U8_B32_D03 <- model_GOOGL_t10_L4_U32_U16_U16_U8_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U16_U16_U16_U16_B32_D03 <- model_GOOGL_t10_L4_U16_U16_U16_U16_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U16_U16_U16_U8_B32_D03 <- model_GOOGL_t10_L4_U16_U16_U16_U8_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```









### GOOGL: 4 Layers, 10 time-steps, drop-out rate 0.3 og batch size 64

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U128_U128_U128_B64_D03 <- model_GOOGL_t10_L4_U128_U128_U128_U128_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U128_U128_U64_B64_D03 <- model_GOOGL_t10_L4_U128_U128_U128_U64_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_model_GOOGL_t10_L4_U128_U128_U64_U64_B64_D03 <- model_GOOGL_t10_L4_U128_U128_U64_U64_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U64_U64_U64_B64_D03 <- model_GOOGL_t10_L4_U128_U64_U64_U64_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                  
                                      Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U128_U64_U64_U32_B64_D03 <- model_GOOGL_t10_L4_U128_U64_U64_U32_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U64_U64_B64_D03 <- model_GOOGL_t10_L4_U64_U64_U64_U64_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U64_U32_B64_D03 <- model_GOOGL_t10_L4_U64_U64_U64_U32_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U64_U32_U32_B64_D03 <- model_GOOGL_t10_L4_U64_U64_U32_U32_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U32_U32_U32_B64_D03 <- model_GOOGL_t10_L4_U64_U32_U32_U32_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U64_U32_U32_U16_B64_D03 <- model_GOOGL_t10_L4_U64_U32_U32_U16_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U32_U32_U32_B64_D03 <- model_GOOGL_t10_L4_U32_U32_U32_U32_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U32_U16_U16_B64_D03 <- model_GOOGL_t10_L4_U32_U32_U16_U16_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U16_U16_U16_B64_D03 <- model_GOOGL_t10_L4_U32_U16_U16_U16_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U32_U16_U16_U8_B64_D03 <- model_GOOGL_t10_L4_U32_U16_U16_U8_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U16_U16_U16_U16_B64_D03 <- model_GOOGL_t10_L4_U16_U16_U16_U16_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t10_L4_U16_U16_U16_U8_B64_D03 <- model_GOOGL_t10_L4_U16_U16_U16_U8_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL1, 
                            y          = y_train_arr_GOOGL1, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```






# LSTM GOOGL -  1  time-steps, 2 Layers og drop-out 0.2


### GOOGL: 2 Layers, 1 time-step, drop-out rate 0.2 og batch size 16
```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U128_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U128_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U8_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U8_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```





### GOOGL: 2 Layers, 1 time-step, drop-out rate 0.2 og batch size 32 



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U128_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U128_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U8_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U8_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U128_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U128_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U8_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U8_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```




### GOOGL: 2 Layers, 1 time-step, drop-out rate 0.2 og batch size 64



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U128_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U128_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U8_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U8_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U128_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U128_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U8_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U8_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```










# LSTM GOOGL -  1  time-steps, 2 Layers og drop-out 0.3


### GOOGL: 2 Layers, 1 time-step, drop-out rate 0.3 og batch size 16
```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U128_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U128_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U8_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U8_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```





### GOOGL: 2 Layers, 1 time-step, drop-out rate 0.3 og batch size 32 GOOGL



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U128_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U128_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U8_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U8_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U128_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U128_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U8_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U8_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```




### GOOGL: 2 Layers, 1 time-step, drop-out rate 0.3 og batch size 64



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U128_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U128_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U8_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U8_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U128_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U128_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U128_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U128_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U64_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U64_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U32_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U32_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U16_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U16_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L2_U8_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L2_U8_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```





# LSTM GOOGL -  1  time-steps, 3 Layers og drop-out 0.2


### GOOGL: 3 Layers, 1 time-step, drop-out rate 0.2 og batch size 16


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U128_U128_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U128_U128_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U128_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U128_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U64_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U64_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U64_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U64_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U64_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U64_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U64_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U64_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U32_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U32_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U32_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U32_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U32_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U32_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U32_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U32_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U16_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U16_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U16_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U16_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U16_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U16_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U16_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U16_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U8_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U8_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U8_U8_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U8_U8_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



### GOOGL: 3 Layers, 1 time-step, drop-out rate 0.2 og batch size 32


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U128_U128_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U128_U128_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U128_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U128_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U64_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U64_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U64_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U64_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U64_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U64_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U64_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U64_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U32_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U32_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U32_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U32_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U32_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U32_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U32_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U32_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U16_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U16_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U16_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U16_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U16_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U16_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U16_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U16_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U8_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U8_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U8_U8_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U8_U8_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



### GOOGL: 3 Layers, 1 time-step, drop-out rate 0.2 og batch size 64


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U128_U128_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U128_U128_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U128_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U128_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U64_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U64_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U64_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U64_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U64_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U64_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U64_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U64_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U32_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U32_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U32_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U32_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U32_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U32_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U32_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U32_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U16_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U16_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U16_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U16_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U16_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U16_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U16_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U16_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U8_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U8_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U8_U8_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U8_U8_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```





# LSTM GOOGL -  1  time-steps, 3 Layers og drop-out 0.3



### GOOGL: 3 Layers, 1 time-step, drop-out rate 0.3 og batch size 16


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U128_U128_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U128_U128_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U128_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U128_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U64_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U64_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U64_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U64_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U64_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U64_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U64_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U64_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U32_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U32_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U32_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U32_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U32_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U32_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U32_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U32_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U16_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U16_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U16_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U16_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U16_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U16_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U16_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U16_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U8_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U8_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U8_U8_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U8_U8_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



### GOOGL: 3 Layers, 1 time-step, drop-out rate 0.3 og batch size 32


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U128_U128_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U128_U128_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U128_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U128_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U64_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U64_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U64_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U64_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U64_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U64_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U64_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U64_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U32_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U32_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U32_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U32_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U32_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U32_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U32_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U32_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U16_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U16_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U16_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U16_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U16_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U16_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U16_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U16_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U8_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U8_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U8_U8_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U8_U8_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



### GOOGL: 3 Layers, 1 time-step, drop-out rate 0.3 og batch size 64


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U128_U128_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U128_U128_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U128_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U128_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U64_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U64_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U128_U64_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U128_U64_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U64_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U64_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U64_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U64_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U32_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U32_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U64_U32_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U64_U32_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U32_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U32_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U32_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U32_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U16_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U16_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U32_U16_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U32_U16_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U16_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U16_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U16_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U16_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U16_U8_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U16_U8_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L3_U8_U8_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L3_U8_U8_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```












# LSTM GOOGL -  1  time-steps, 4 Layers og drop-out 0.2


### GOOGL: 4 Layers, 1 time-step, drop-out rate 0.2 og batch size 16


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U128_U128_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U128_U128_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U128_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U128_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U64_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U64_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U64_U64_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U64_U64_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U64_U64_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U64_U64_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U64_U64_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U64_U64_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U64_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U64_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U32_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U32_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U32_U32_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U32_U32_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U32_U32_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U32_U32_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U32_U32_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U32_U32_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U32_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U32_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U16_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U16_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U16_U16_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 16, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U16_U16_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U16_U16_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U16_U16_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U16_U16_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U16_U16_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U16_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U16_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U8_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U8_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U8_U8_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U8_U8_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U8_U8_U8_U8_B16_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U8_U8_U8_U8_B16_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```




### GOOGL: 4 Layers, 1 time-step, drop-out rate 0.2 og batch size 32


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U128_U128_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U128_U128_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U128_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U128_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U64_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U64_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U64_U64_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U64_U64_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U64_U64_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U64_U64_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U64_U64_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U64_U64_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U64_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U64_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U32_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U32_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U32_U32_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U32_U32_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U32_U32_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U32_U32_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U32_U32_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U32_U32_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U32_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U32_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```




```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U16_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U16_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U16_U16_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 16, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U16_U16_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U16_U16_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U16_U16_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U16_U16_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U16_U16_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U16_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U16_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U8_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U8_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U8_U8_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U8_U8_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U8_U8_U8_U8_B32_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U8_U8_U8_U8_B32_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


### GOOGL: 4 Layers, 1 time-step, drop-out rate 0.2 og batch size 64


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U128_U128_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U128_U128_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U128_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U128_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U64_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U64_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U64_U64_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U64_U64_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U64_U64_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U64_U64_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U64_U64_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U64_U64_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U64_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U64_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U32_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U32_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U32_U32_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U32_U32_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U32_U32_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U32_U32_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U32_U32_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U32_U32_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U32_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U32_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U16_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 16, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U16_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U16_U16_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 16, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U16_U16_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U16_U16_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U16_U16_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U16_U16_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U16_U16_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U16_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U16_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U8_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U8_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U8_U8_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U8_U8_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U8_U8_U8_U8_B64_D02 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.2, 
             recurrent_dropout=0.2,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U8_U8_U8_U8_B64_D02 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```










# LSTM GOOGL -  1  time-steps, 4 Layers og drop-out 0.3


### GOOGL: 4 Layers, 1 time-step, drop-out rate 0.3 og batch size 16


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U128_U128_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U128_U128_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U128_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U128_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U64_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U64_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U64_U64_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U64_U64_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U64_U64_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U64_U64_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U64_U64_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U64_U64_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U64_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U64_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U32_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U32_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U32_U32_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U32_U32_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U32_U32_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U32_U32_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U32_U32_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U32_U32_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U32_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U32_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U16_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U16_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U16_U16_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 16, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U16_U16_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U16_U16_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U16_U16_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U16_U16_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U16_U16_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U16_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U16_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U8_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U8_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U8_U8_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U8_U8_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U8_U8_U8_U8_B16_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U8_U8_U8_U8_B16_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```




### GOOGL: 4 Layers, 1 time-step, drop-out rate 0.3 og batch size 32


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U128_U128_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U128_U128_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U128_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U128_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U64_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U64_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U64_U64_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U64_U64_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U64_U64_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U64_U64_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U64_U64_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U64_U64_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U64_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U64_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U32_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U32_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U32_U32_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U32_U32_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U32_U32_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U32_U32_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U32_U32_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U32_U32_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U32_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U32_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```




```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U16_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U16_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U16_U16_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 16, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U16_U16_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U16_U16_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U16_U16_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U16_U16_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U16_U16_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U16_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U16_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U8_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U8_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U8_U8_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U8_U8_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U8_U8_U8_U8_B32_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U8_U8_U8_U8_B32_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


### GOOGL: 4 Layers, 1 time-step, drop-out rate 0.3 og batch size 64


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U128_U128_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U128_U128_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```

```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U128_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U128_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U128_U64_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U128_U64_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U64_U64_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U64_U64_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U128_U64_U64_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 128, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U128_U64_U64_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U64_U64_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U64_U64_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U64_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U64_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U64_U32_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U64_U32_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U32_U32_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U32_U32_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U64_U32_U32_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 64, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U64_U32_U32_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U32_U32_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U32_U32_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U32_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U32_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U32_U16_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 16, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U32_U16_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U16_U16_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 16, activation = 'relu') %>%
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U16_U16_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U32_U16_U16_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 32, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U32_U16_U16_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U16_U16_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U16_U16_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U16_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U16_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U16_U8_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U16_U8_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U16_U8_U8_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 16, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U16_U8_U8_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```


```{r, warning=FALSE, results='hide'}
model_GOOGL_t1_L4_U8_U8_U8_U8_B64_D03 <- keras_model_sequential() %>%
  # LSTM layer
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             input_shape = dim(x_test_arr_GOOGL)[-1],
             return_sequences = TRUE) %>%
    # A Dense layer inbetweeen
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = TRUE) %>%
    layer_dense(units = 32, activation = 'relu') %>%
  layer_lstm(units = 8, 
             dropout=0.3, 
             recurrent_dropout=0.3,
             return_sequences = FALSE) %>%
  layer_dense(units = 32, activation = 'relu') %>%
  #Final prediction layer
  layer_dense(units = 1, activation = 'linear')

model_GOOGL_t1_L4_U8_U8_U8_U8_B64_D03 %>% compile(loss = 'mse', optimizer = optimizer_adam(), metrics = 'mse')
```



















# Fitting af GOOGL 2-layers og drop-out 0.2


### GOOGL: 2 Layers, 1 time-step, drop-out rate 0.2 og batch size 16

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U128_U128_B16_D02 <- model_GOOGL_t1_L2_U128_U128_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U128_U64_B16_D02 <- model_GOOGL_t1_L2_U128_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U64_U64_B16_D02 <- model_GOOGL_t1_L2_U64_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U64_U32_B16_D02 <- model_GOOGL_t1_L2_U64_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U32_U32_B16_D02 <- model_GOOGL_t1_L2_U32_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U32_U16_B16_D02 <- model_GOOGL_t1_L2_U32_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U16_U16_B16_D02 <- model_GOOGL_t1_L2_U16_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U16_U8_B16_D02 <- model_GOOGL_t1_L2_U16_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U8_U8_B16_D02 <- model_GOOGL_t1_L2_U8_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```






### GOOGL: 2 Layers, 1 time-step, drop-out rate 0.2 og batch size 32

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U128_U128_B32_D02 <- model_GOOGL_t1_L2_U128_U128_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U128_U64_B32_D02 <- model_GOOGL_t1_L2_U128_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U64_U64_B32_D02 <- model_GOOGL_t1_L2_U64_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U64_U32_B32_D02 <- model_GOOGL_t1_L2_U64_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U32_U32_B32_D02 <- model_GOOGL_t1_L2_U32_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 1,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 1)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U32_U16_B32_D02 <- model_GOOGL_t1_L2_U32_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U16_U16_B32_D02 <- model_GOOGL_t1_L2_U16_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U16_U8_B32_D02 <- model_GOOGL_t1_L2_U16_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U8_U8_B32_D02 <- model_GOOGL_t1_L2_U8_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```











### GOOGL: 2 Layers, 1 time-step, drop-out rate 0.2 og batch size 64

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U128_U128_B64_D02 <- model_GOOGL_t1_L2_U128_U128_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U128_U64_B64_D02 <- model_GOOGL_t1_L2_U128_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U64_U64_B64_D02 <- model_GOOGL_t1_L2_U64_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U64_U32_B64_D02 <- model_GOOGL_t1_L2_U64_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U32_U32_B64_D02 <- model_GOOGL_t1_L2_U32_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U32_U16_B64_D02 <- model_GOOGL_t1_L2_U32_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U16_U16_B64_D02 <- model_GOOGL_t1_L2_U16_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U16_U8_B64_D02 <- model_GOOGL_t1_L2_U16_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U8_U8_B64_D02 <- model_GOOGL_t1_L2_U8_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```




# Fitting af GOOGL 2-layers og drop-out 0.3

### GOOGL: 2 Layers, 1 time-step, drop-out rate 0.3 og batch size 16

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U128_U128_B16_D03 <- model_GOOGL_t1_L2_U128_U128_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U128_U64_B16_D03 <- model_GOOGL_t1_L2_U128_U64_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U64_U64_B16_D03 <- model_GOOGL_t1_L2_U64_U64_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U64_U32_B16_D03 <- model_GOOGL_t1_L2_U64_U32_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U32_U32_B16_D03 <- model_GOOGL_t1_L2_U32_U32_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U32_U16_B16_D03 <- model_GOOGL_t1_L2_U32_U16_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U16_U16_B16_D03 <- model_GOOGL_t1_L2_U16_U16_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U16_U8_B16_D03 <- model_GOOGL_t1_L2_U16_U8_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U8_U8_B16_D03 <- model_GOOGL_t1_L2_U8_U8_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```







### GOOGL: 2 Layers, 1 time-step, drop-out rate 0.3 og batch size 32

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U128_U128_B32_D03 <- model_GOOGL_t1_L2_U128_U128_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U128_U64_B32_D03 <- model_GOOGL_t1_L2_U128_U64_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U64_U64_B32_D03 <- model_GOOGL_t1_L2_U64_U64_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U64_U32_B32_D03 <- model_GOOGL_t1_L2_U64_U32_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U32_U32_B32_D03 <- model_GOOGL_t1_L2_U32_U32_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U32_U16_B32_D03 <- model_GOOGL_t1_L2_U32_U16_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U16_U16_B32_D03 <- model_GOOGL_t1_L2_U16_U16_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U16_U8_B32_D03 <- model_GOOGL_t1_L2_U16_U8_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U8_U8_B32_D03 <- model_GOOGL_t1_L2_U8_U8_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```











### GOOGL: 2 Layers, 1 time-step, drop-out rate 0.3 og batch size 64

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U128_U128_B64_D03 <- model_GOOGL_t1_L2_U128_U128_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U128_U64_B64_D03 <- model_GOOGL_t1_L2_U128_U64_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U64_U64_B64_D03 <- model_GOOGL_t1_L2_U64_U64_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U64_U32_B64_D03 <- model_GOOGL_t1_L2_U64_U32_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U32_U32_B64_D03 <- model_GOOGL_t1_L2_U32_U32_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U32_U16_B64_D03 <- model_GOOGL_t1_L2_U32_U16_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U16_U16_B64_D03 <- model_GOOGL_t1_L2_U16_U16_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U16_U8_B64_D03 <- model_GOOGL_t1_L2_U16_U8_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L2_U8_U8_B64_D03 <- model_GOOGL_t1_L2_U8_U8_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```








# Fitting af GOOGL 3-layers og drop-out 0.2


### GOOGL: 3 Layers, 1 time-step, drop-out rate 0.2 og batch size 16

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U128_U128_B16_D02 <- model_GOOGL_t1_L3_U128_U128_U128_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U128_U64_B16_D02 <- model_GOOGL_t1_L3_U128_U128_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U64_U64_B16_D02 <- model_GOOGL_t1_L3_U128_U64_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U64_U32_B16_D02 <- model_GOOGL_t1_L3_U128_U64_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U64_U64_B16_D02 <- model_GOOGL_t1_L3_U64_U64_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U64_U32_B16_D02 <- model_GOOGL_t1_L3_U64_U64_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U32_U32_B16_D02 <- model_GOOGL_t1_L3_U64_U32_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U32_U16_B16_D02 <- model_GOOGL_t1_L3_U64_U32_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U32_U32_B16_D02 <- model_GOOGL_t1_L3_U32_U32_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U32_U16_B16_D02 <- model_GOOGL_t1_L3_U32_U32_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U16_U16_B16_D02 <- model_GOOGL_t1_L3_U32_U16_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U16_U16_B16_D02 <- model_GOOGL_t1_L3_U16_U16_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U16_U8_B16_D02 <- model_GOOGL_t1_L3_U16_U16_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U8_U8_B16_D02 <- model_GOOGL_t1_L3_U16_U8_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U8_U8_U8_B16_D02 <- model_GOOGL_t1_L3_U8_U8_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```








### GOOGL: 3 Layers, 1 time-step, drop-out rate 0.2 og batch size 32

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U128_U128_B32_D02 <- model_GOOGL_t1_L3_U128_U128_U128_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U128_U64_B32_D02 <- model_GOOGL_t1_L3_U128_U128_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U64_U64_B32_D02 <- model_GOOGL_t1_L3_U128_U64_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U64_U32_B32_D02 <- model_GOOGL_t1_L3_U128_U64_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U64_U64_B32_D02 <- model_GOOGL_t1_L3_U64_U64_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U64_U32_B32_D02 <- model_GOOGL_t1_L3_U64_U64_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U32_U32_B32_D02 <- model_GOOGL_t1_L3_U64_U32_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U32_U16_B32_D02 <- model_GOOGL_t1_L3_U64_U32_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U32_U32_B32_D02 <- model_GOOGL_t1_L3_U32_U32_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U32_U16_B32_D02 <- model_GOOGL_t1_L3_U32_U32_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U16_U16_B32_D02 <- model_GOOGL_t1_L3_U32_U16_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U16_U16_B32_D02 <- model_GOOGL_t1_L3_U16_U16_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U16_U8_B32_D02 <- model_GOOGL_t1_L3_U16_U16_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U8_U8_B32_D02 <- model_GOOGL_t1_L3_U16_U8_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U8_U8_U8_B32_D02 <- model_GOOGL_t1_L3_U8_U8_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```







### GOOGL: 3 Layers, 1 time-step, drop-out rate 0.2 og batch size 64

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U128_U128_B64_D02 <- model_GOOGL_t1_L3_U128_U128_U128_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U128_U64_B64_D02 <- model_GOOGL_t1_L3_U128_U128_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U64_U64_B64_D02 <- model_GOOGL_t1_L3_U128_U64_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U64_U32_B64_D02 <- model_GOOGL_t1_L3_U128_U64_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U64_U64_B64_D02 <- model_GOOGL_t1_L3_U64_U64_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U64_U32_B64_D02 <- model_GOOGL_t1_L3_U64_U64_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U32_U32_B64_D02 <- model_GOOGL_t1_L3_U64_U32_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U32_U16_B64_D02 <- model_GOOGL_t1_L3_U64_U32_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U32_U32_B64_D02 <- model_GOOGL_t1_L3_U32_U32_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U32_U16_B64_D02 <- model_GOOGL_t1_L3_U32_U32_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U16_U16_B64_D02 <- model_GOOGL_t1_L3_U32_U16_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U16_U16_B64_D02 <- model_GOOGL_t1_L3_U16_U16_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U16_U8_B64_D02 <- model_GOOGL_t1_L3_U16_U16_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U8_U8_B64_D02 <- model_GOOGL_t1_L3_U16_U8_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U8_U8_U8_B64_D02 <- model_GOOGL_t1_L3_U8_U8_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```






# Fitting af GOOGL 3-layers og drop-out 0.3


### GOOGL: 3 Layers, 1 time-step, drop-out rate 0.3 og batch size 16


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U128_U128_B16_D03 <- model_GOOGL_t1_L3_U128_U128_U128_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U128_U64_B16_D03 <- model_GOOGL_t1_L3_U128_U128_U64_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 1)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U64_U64_B16_D03 <- model_GOOGL_t1_L3_U128_U64_U64_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U64_U32_B16_D03 <- model_GOOGL_t1_L3_U128_U64_U32_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U64_U64_B16_D03 <- model_GOOGL_t1_L3_U64_U64_U64_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U64_U32_B16_D03 <- model_GOOGL_t1_L3_U64_U64_U32_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U32_U32_B16_D03 <- model_GOOGL_t1_L3_U64_U32_U32_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U32_U16_B16_D03 <- model_GOOGL_t1_L3_U64_U32_U16_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U32_U32_B16_D03 <- model_GOOGL_t1_L3_U32_U32_U32_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U32_U16_B16_D03 <- model_GOOGL_t1_L3_U32_U32_U16_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U16_U16_B16_D03 <- model_GOOGL_t1_L3_U32_U16_U16_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U16_U16_B16_D03 <- model_GOOGL_t1_L3_U16_U16_U16_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U16_U8_B16_D03 <- model_GOOGL_t1_L3_U16_U16_U8_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U8_U8_B16_D03 <- model_GOOGL_t1_L3_U16_U8_U8_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U8_U8_U8_B16_D03 <- model_GOOGL_t1_L3_U8_U8_U8_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```








### GOOGL: 3 Layers, 1 time-step, drop-out rate 0.3 og batch size 32

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U128_U128_B32_D03 <- model_GOOGL_t1_L3_U128_U128_U128_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U128_U64_B32_D03 <- model_GOOGL_t1_L3_U128_U128_U64_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U64_U64_B32_D03 <- model_GOOGL_t1_L3_U128_U64_U64_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U64_U32_B32_D03 <- model_GOOGL_t1_L3_U128_U64_U32_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U64_U64_B32_D03 <- model_GOOGL_t1_L3_U64_U64_U64_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U64_U32_B32_D03 <- model_GOOGL_t1_L3_U64_U64_U32_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U32_U32_B32_D03 <- model_GOOGL_t1_L3_U64_U32_U32_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U32_U16_B32_D03 <- model_GOOGL_t1_L3_U64_U32_U16_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U32_U32_B32_D03 <- model_GOOGL_t1_L3_U32_U32_U32_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U32_U16_B32_D03 <- model_GOOGL_t1_L3_U32_U32_U16_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U16_U16_B32_D03 <- model_GOOGL_t1_L3_U32_U16_U16_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U16_U16_B32_D03 <- model_GOOGL_t1_L3_U16_U16_U16_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U16_U8_B32_D03 <- model_GOOGL_t1_L3_U16_U16_U8_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U8_U8_B32_D03 <- model_GOOGL_t1_L3_U16_U8_U8_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U8_U8_U8_B32_D03 <- model_GOOGL_t1_L3_U8_U8_U8_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```







### GOOGL: 3 Layers, 1 time-step, drop-out rate 0.3 og batch size 64

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U128_U128_B64_D03 <- model_GOOGL_t1_L3_U128_U128_U128_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U128_U64_B64_D03 <- model_GOOGL_t1_L3_U128_U128_U64_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U64_U64_B64_D03 <- model_GOOGL_t1_L3_U128_U64_U64_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U128_U64_U32_B64_D03 <- model_GOOGL_t1_L3_U128_U64_U32_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U64_U64_B64_D03 <- model_GOOGL_t1_L3_U64_U64_U64_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U64_U32_B64_D03 <- model_GOOGL_t1_L3_U64_U64_U32_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U32_U32_B64_D03 <- model_GOOGL_t1_L3_U64_U32_U32_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U64_U32_U16_B64_D03 <- model_GOOGL_t1_L3_U64_U32_U16_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U32_U32_B64_D03 <- model_GOOGL_t1_L3_U32_U32_U32_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U32_U16_B64_D03 <- model_GOOGL_t1_L3_U32_U32_U16_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U32_U16_U16_B64_D03 <- model_GOOGL_t1_L3_U32_U16_U16_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U16_U16_B64_D03 <- model_GOOGL_t1_L3_U16_U16_U16_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U16_U8_B64_D03 <- model_GOOGL_t1_L3_U16_U16_U8_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U16_U8_U8_B64_D03 <- model_GOOGL_t1_L3_U16_U8_U8_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L3_U8_U8_U8_B64_D03 <- model_GOOGL_t1_L3_U8_U8_U8_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```





# Fitting af GOOGL 4-layers og drop-out 0.2


### GOOGL: 4 Layers, 1 time-steps, drop-out rate 0.2 og batch size 16

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U128_U128_B16_D02 <- model_GOOGL_t1_L4_U128_U128_U128_U128_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U128_U64_B16_D02 <- model_GOOGL_t1_L4_U128_U128_U128_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U64_U64_B16_D02 <- model_GOOGL_t1_L4_U128_U128_U64_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U64_U64_U32_B16_D02 <- model_GOOGL_t1_L4_U128_U64_U64_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U64_U64_B16_D02 <- model_GOOGL_t1_L4_U64_U64_U64_U64_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U64_U32_B16_D02 <- model_GOOGL_t1_L4_U64_U64_U64_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U32_U32_B16_D02 <- model_GOOGL_t1_L4_U64_U64_U32_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U32_U32_U16_B16_D02 <- model_GOOGL_t1_L4_U64_U32_U32_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U32_U32_B16_D02 <- model_GOOGL_t1_L4_U32_U32_U32_U32_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U32_U16_B16_D02 <- model_GOOGL_t1_L4_U32_U32_U32_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U16_U16_B16_D02 <- model_GOOGL_t1_L4_U32_U32_U16_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U16_U16_B16_D02 <- model_GOOGL_t1_L4_U16_U16_U16_U16_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U16_U8_B16_D02 <- model_GOOGL_t1_L4_U16_U16_U16_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U8_U8_B16_D02 <- model_GOOGL_t1_L4_U16_U16_U8_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U8_U8_U8_U8_B16_D02 <- model_GOOGL_t1_L4_U8_U8_U8_U8_B16_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```








### GOOGL: 4 Layers, 1 time-steps, drop-out rate 0.2 og batch size 32

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U128_U128_B32_D02 <- model_GOOGL_t1_L4_U128_U128_U128_U128_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U128_U64_B32_D02 <- model_GOOGL_t1_L4_U128_U128_U128_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U64_U64_B32_D02 <- model_GOOGL_t1_L4_U128_U128_U64_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U64_U64_U32_B32_D02 <- model_GOOGL_t1_L4_U128_U64_U64_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U64_U64_B32_D02 <- model_GOOGL_t1_L4_U64_U64_U64_U64_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U64_U32_B32_D02 <- model_GOOGL_t1_L4_U64_U64_U64_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U32_U32_B32_D02 <- model_GOOGL_t1_L4_U64_U64_U32_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U32_U32_U16_B32_D02 <- model_GOOGL_t1_L4_U64_U32_U32_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U32_U32_B32_D02 <- model_GOOGL_t1_L4_U32_U32_U32_U32_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U32_U16_B32_D02 <- model_GOOGL_t1_L4_U32_U32_U32_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U16_U16_B32_D02 <- model_GOOGL_t1_L4_U32_U32_U16_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U16_U16_B32_D02 <- model_GOOGL_t1_L4_U16_U16_U16_U16_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U16_U8_B32_D02 <- model_GOOGL_t1_L4_U16_U16_U16_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U8_U8_B32_D02 <- model_GOOGL_t1_L4_U16_U16_U8_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U8_U8_U8_U8_B32_D02 <- model_GOOGL_t1_L4_U8_U8_U8_U8_B32_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```







### GOOGL: 4 Layers, 1 time-steps, drop-out rate 0.2 og batch size 64

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U128_U128_B64_D02 <- model_GOOGL_t1_L4_U128_U128_U128_U128_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U128_U64_B64_D02 <- model_GOOGL_t1_L4_U128_U128_U128_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U64_U64_B64_D02 <- model_GOOGL_t1_L4_U128_U128_U64_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U64_U64_U32_B64_D02 <- model_GOOGL_t1_L4_U128_U64_U64_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U64_U64_B64_D02 <- model_GOOGL_t1_L4_U64_U64_U64_U64_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U64_U32_B64_D02 <- model_GOOGL_t1_L4_U64_U64_U64_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U32_U32_B64_D02 <- model_GOOGL_t1_L4_U64_U64_U32_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U32_U32_U16_B64_D02 <- model_GOOGL_t1_L4_U64_U32_U32_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U32_U32_B64_D02 <- model_GOOGL_t1_L4_U32_U32_U32_U32_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U32_U16_B64_D02 <- model_GOOGL_t1_L4_U32_U32_U32_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U16_U16_B64_D02 <- model_GOOGL_t1_L4_U32_U32_U16_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U16_U16_B64_D02 <- model_GOOGL_t1_L4_U16_U16_U16_U16_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U16_U8_B64_D02 <- model_GOOGL_t1_L4_U16_U16_U16_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U8_U8_B64_D02 <- model_GOOGL_t1_L4_U16_U16_U8_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U8_U8_U8_U8_B64_D02 <- model_GOOGL_t1_L4_U8_U8_U8_U8_B64_D02 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.2, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```







# Fitting af GOOGL 4-layers og drop-out 0.3


### GOOGL: 4 Layers, 1 time-steps, drop-out rate 0.3 og batch size 16

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U128_U128_B16_D03 <- model_GOOGL_t1_L4_U128_U128_U128_U128_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U128_U64_B16_D03 <- model_GOOGL_t1_L4_U128_U128_U128_U64_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U64_U64_B16_D03 <- model_GOOGL_t1_L4_U128_U128_U64_U64_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U64_U64_U32_B16_D03 <- model_GOOGL_t1_L4_U128_U64_U64_U32_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U64_U64_B16_D03 <- model_GOOGL_t1_L4_U64_U64_U64_U64_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U64_U32_B16_D03 <- model_GOOGL_t1_L4_U64_U64_U64_U32_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U32_U32_B16_D03 <- model_GOOGL_t1_L4_U64_U64_U32_U32_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U32_U32_U16_B16_D03 <- model_GOOGL_t1_L4_U64_U32_U32_U16_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U32_U32_B16_D03 <- model_GOOGL_t1_L4_U32_U32_U32_U32_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U32_U16_B16_D03 <- model_GOOGL_t1_L4_U32_U32_U32_U16_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U16_U16_B16_D03 <- model_GOOGL_t1_L4_U32_U32_U16_U16_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U16_U16_B16_D03 <- model_GOOGL_t1_L4_U16_U16_U16_U16_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U16_U8_B16_D03 <- model_GOOGL_t1_L4_U16_U16_U16_U8_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U8_U8_B16_D03 <- model_GOOGL_t1_L4_U16_U16_U8_U8_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U8_U8_U8_U8_B16_D03 <- model_GOOGL_t1_L4_U8_U8_U8_U8_B16_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size16,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```








### GOOGL: 4 Layers, 1 time-steps, drop-out rate 0.3 og batch size 32

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U128_U128_B32_D03 <- model_GOOGL_t1_L4_U128_U128_U128_U128_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U128_U64_B32_D03 <- model_GOOGL_t1_L4_U128_U128_U128_U64_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U64_U64_B32_D03 <- model_GOOGL_t1_L4_U128_U128_U64_U64_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U64_U64_U32_B32_D03 <- model_GOOGL_t1_L4_U128_U64_U64_U32_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U64_U64_B32_D03 <- model_GOOGL_t1_L4_U64_U64_U64_U64_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U64_U32_B32_D03 <- model_GOOGL_t1_L4_U64_U64_U64_U32_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U32_U32_B32_D03 <- model_GOOGL_t1_L4_U64_U64_U32_U32_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U32_U32_U16_B32_D03 <- model_GOOGL_t1_L4_U64_U32_U32_U16_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U32_U32_B32_D03 <- model_GOOGL_t1_L4_U32_U32_U32_U32_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U32_U16_B32_D03 <- model_GOOGL_t1_L4_U32_U32_U32_U16_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U16_U16_B32_D03 <- model_GOOGL_t1_L4_U32_U32_U16_U16_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U16_U16_B32_D03 <- model_GOOGL_t1_L4_U16_U16_U16_U16_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U16_U8_B32_D03 <- model_GOOGL_t1_L4_U16_U16_U16_U8_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U8_U8_B32_D03 <- model_GOOGL_t1_L4_U16_U16_U8_U8_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U8_U8_U8_U8_B32_D03 <- model_GOOGL_t1_L4_U8_U8_U8_U8_B32_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size32,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```







### GOOGL: 4 Layers, 1 time-steps, drop-out rate 0.3 og batch size 64

```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U128_U128_B64_D03 <- model_GOOGL_t1_L4_U128_U128_U128_U128_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U128_U64_B64_D03 <- model_GOOGL_t1_L4_U128_U128_U128_U64_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U128_U64_U64_B64_D03 <- model_GOOGL_t1_L4_U128_U128_U64_U64_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U128_U64_U64_U32_B64_D03 <- model_GOOGL_t1_L4_U128_U64_U64_U32_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U64_U64_B64_D03 <- model_GOOGL_t1_L4_U64_U64_U64_U64_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U64_U32_B64_D03 <- model_GOOGL_t1_L4_U64_U64_U64_U32_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U64_U32_U32_B64_D03 <- model_GOOGL_t1_L4_U64_U64_U32_U32_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U64_U32_U32_U16_B64_D03 <- model_GOOGL_t1_L4_U64_U32_U32_U16_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U32_U32_B64_D03 <- model_GOOGL_t1_L4_U32_U32_U32_U32_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U32_U16_B64_D03 <- model_GOOGL_t1_L4_U32_U32_U32_U16_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U32_U32_U16_U16_B64_D03 <- model_GOOGL_t1_L4_U32_U32_U16_U16_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U16_U16_B64_D03 <- model_GOOGL_t1_L4_U16_U16_U16_U16_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U16_U8_B64_D03 <- model_GOOGL_t1_L4_U16_U16_U16_U8_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U16_U16_U8_U8_B64_D03 <- model_GOOGL_t1_L4_U16_U16_U8_U8_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```


```{r, warning=FALSE, results='hide'}
hist_model_GOOGL_t1_L4_U8_U8_U8_U8_B64_D03 <- model_GOOGL_t1_L4_U8_U8_U8_U8_B64_D03 %>% 
                        fit(x          = x_train_arr_GOOGL, 
                            y          = y_train_arr_GOOGL, 
                            epochs     = 100,
                            verbose    = TRUE, 
                            batch_size = batch_size64,
                            validation_split = 0.3, 
                            shuffle    = FALSE,
                            Verbose = 0, 
                            callbacks  = callback_early_stopping(monitor = "mse", patience = 10)
                            )
```





# Evaluering af modeller 10 time-steps


### Evaluering 2 Layers og 10  time-steps

```{r, include = FALSE}
# 2 Layers, 10 time-steps, drop-out rate 0.2 og batch size 16
eval_GOOGL_10t_L2_U128_U128_B16_D02 <- model_GOOGL_t10_L2_U128_U128_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U128_U64_B16_D02 <- model_GOOGL_t10_L2_U128_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U64_U64_B16_D02 <- model_GOOGL_t10_L2_U64_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U64_U32_B16_D02 <- model_GOOGL_t10_L2_U64_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U32_U32_B16_D02 <- model_GOOGL_t10_L2_U32_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U32_U16_B16_D02 <- model_GOOGL_t10_L2_U32_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U16_U16_B16_D02 <- model_GOOGL_t10_L2_U16_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U16_U8_B16_D02 <- model_GOOGL_t10_L2_U16_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U8_U8_B16_D02 <- model_GOOGL_t10_L2_U8_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)


# 2 Layers, 10 time-steps, drop-out rate 0.2 og batch size 32
eval_GOOGL_10t_L2_U128_U128_B32_D02 <- model_GOOGL_t10_L2_U128_U128_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U128_U64_B32_D02 <- model_GOOGL_t10_L2_U128_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U64_U64_B32_D02 <- model_GOOGL_t10_L2_U64_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U64_U32_B32_D02 <- model_GOOGL_t10_L2_U64_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U32_U32_B32_D02 <- model_GOOGL_t10_L2_U32_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U32_U16_B32_D02 <- model_GOOGL_t10_L2_U32_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U16_U16_B32_D02 <- model_GOOGL_t10_L2_U16_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U16_U8_B32_D02 <- model_GOOGL_t10_L2_U16_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U8_U8_B32_D02 <- model_GOOGL_t10_L2_U8_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)


# 2 Layers, 10 time-steps, drop-out rate 0.2 og batch size 64
eval_GOOGL_10t_L2_U128_U128_B64_D02 <- model_GOOGL_t10_L2_U128_U128_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U128_U64_B64_D02 <- model_GOOGL_t10_L2_U128_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U64_U64_B64_D02 <- model_GOOGL_t10_L2_U64_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U64_U32_B64_D02 <- model_GOOGL_t10_L2_U64_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U32_U32_B64_D02 <- model_GOOGL_t10_L2_U32_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U32_U16_B64_D02 <- model_GOOGL_t10_L2_U32_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U16_U16_B64_D02 <- model_GOOGL_t10_L2_U16_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U16_U8_B64_D02 <- model_GOOGL_t10_L2_U16_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U8_U8_B64_D02 <- model_GOOGL_t10_L2_U8_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)



# 2 Layers, 10 time-steps, drop-out rate 0.3 og batch size 16
eval_GOOGL_10t_L2_U128_U128_B16_D03 <- model_GOOGL_t10_L2_U128_U128_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U128_U64_B16_D03 <- model_GOOGL_t10_L2_U128_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U64_U64_B16_D03 <- model_GOOGL_t10_L2_U64_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U64_U32_B16_D03 <- model_GOOGL_t10_L2_U64_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U32_U32_B16_D03 <- model_GOOGL_t10_L2_U32_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U32_U16_B16_D03 <- model_GOOGL_t10_L2_U32_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U16_U16_B16_D03 <- model_GOOGL_t10_L2_U16_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U16_U8_B16_D03 <- model_GOOGL_t10_L2_U16_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U8_U8_B16_D03 <- model_GOOGL_t10_L2_U8_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)


# 2 Layers, 10 time-steps, drop-out rate 0.3 og batch size 32
eval_GOOGL_10t_L2_U128_U128_B32_D03 <- model_GOOGL_t10_L2_U128_U128_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U128_U64_B32_D03 <- model_GOOGL_t10_L2_U128_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U64_U64_B32_D03 <- model_GOOGL_t10_L2_U64_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U64_U32_B32_D03 <- model_GOOGL_t10_L2_U64_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U32_U32_B32_D03 <- model_GOOGL_t10_L2_U32_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U32_U16_B32_D03 <- model_GOOGL_t10_L2_U32_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U16_U16_B32_D03 <- model_GOOGL_t10_L2_U16_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U16_U8_B32_D03 <- model_GOOGL_t10_L2_U16_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U8_U8_B32_D03 <- model_GOOGL_t10_L2_U8_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)


# 2 Layers, 10 time-steps, drop-out rate 0.3 og batch size 64
eval_GOOGL_10t_L2_U128_U128_B64_D03 <- model_GOOGL_t10_L2_U128_U128_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U128_U64_B64_D03 <- model_GOOGL_t10_L2_U128_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U64_U64_B64_D03 <- model_GOOGL_t10_L2_U64_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U64_U32_B64_D03 <- model_GOOGL_t10_L2_U64_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U32_U32_B64_D03 <- model_GOOGL_t10_L2_U32_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U32_U16_B64_D03 <- model_GOOGL_t10_L2_U32_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U16_U16_B64_D03 <- model_GOOGL_t10_L2_U16_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U16_U8_B64_D03 <- model_GOOGL_t10_L2_U16_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L2_U8_U8_B64_D03 <- model_GOOGL_t10_L2_U8_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
```




### Evaluering 3 Layers og 10  time-steps


```{r, include = FALSE}
# 3 Layers, 10 time-steps, drop-out rate 0.2 og batch size 16
eval_GOOGL_10t_L3_U128_U128_U128_B16_D02 <- model_GOOGL_t10_L3_U128_U128_U128_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U128_U64_B16_D02 <- model_GOOGL_t10_L3_U128_U128_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U64_U64_B16_D02 <- model_GOOGL_t10_L3_U128_U64_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U64_U32_B16_D02 <- model_GOOGL_t10_L3_U128_U64_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U64_U64_B16_D02 <- model_GOOGL_t10_L3_U64_U64_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U64_U32_B16_D02 <- model_GOOGL_t10_L3_U64_U64_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U32_U32_B16_D02 <- model_GOOGL_t10_L3_U64_U32_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U32_U16_B16_D02 <- model_GOOGL_t10_L3_U64_U32_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U32_U32_B16_D02 <- model_GOOGL_t10_L3_U32_U32_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U32_U16_B16_D02 <- model_GOOGL_t10_L3_U32_U32_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U16_U16_B16_D02 <- model_GOOGL_t10_L3_U32_U16_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U16_U8_B16_D02 <- model_GOOGL_t10_L3_U32_U16_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U16_U16_B16_D02 <- model_GOOGL_t10_L3_U16_U16_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U16_U8_B16_D02 <- model_GOOGL_t10_L3_U16_U16_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U8_U8_B16_D02 <- model_GOOGL_t10_L3_U16_U8_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U8_U8_U8_B16_D02 <- model_GOOGL_t10_L3_U8_U8_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)


# 3 Layers, 10 time-steps, drop-out rate 0.2 og batch size 32
eval_GOOGL_10t_L3_U128_U128_U128_B32_D02 <- model_GOOGL_t10_L3_U128_U128_U128_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U128_U64_B32_D02 <- model_GOOGL_t10_L3_U128_U128_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U64_U64_B32_D02 <- model_GOOGL_t10_L3_U128_U64_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U64_U32_B32_D02 <- model_GOOGL_t10_L3_U128_U64_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U64_U64_B32_D02 <- model_GOOGL_t10_L3_U64_U64_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U64_U32_B32_D02 <- model_GOOGL_t10_L3_U64_U64_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U32_U32_B32_D02 <- model_GOOGL_t10_L3_U64_U32_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U32_U16_B32_D02 <- model_GOOGL_t10_L3_U64_U32_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U32_U32_B32_D02 <- model_GOOGL_t10_L3_U32_U32_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U32_U16_B32_D02 <- model_GOOGL_t10_L3_U32_U32_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U16_U16_B32_D02 <- model_GOOGL_t10_L3_U32_U16_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U16_U8_B32_D02 <- model_GOOGL_t10_L3_U32_U16_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U16_U16_B32_D02 <- model_GOOGL_t10_L3_U16_U16_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U16_U8_B32_D02 <- model_GOOGL_t10_L3_U16_U16_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U8_U8_B32_D02 <- model_GOOGL_t10_L3_U16_U8_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U8_U8_U8_B32_D02 <- model_GOOGL_t10_L3_U8_U8_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)



# 3 Layers, 10 time-steps, drop-out rate 0.2 og batch size 64
eval_GOOGL_10t_L3_U128_U128_U128_B64_D02 <- model_GOOGL_t10_L3_U128_U128_U128_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U128_U64_B64_D02 <- model_GOOGL_t10_L3_U128_U128_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U64_U64_B64_D02 <- model_GOOGL_t10_L3_U128_U64_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U64_U32_B64_D02 <- model_GOOGL_t10_L3_U128_U64_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U64_U64_B64_D02 <- model_GOOGL_t10_L3_U64_U64_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U64_U32_B64_D02 <- model_GOOGL_t10_L3_U64_U64_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U32_U32_B64_D02 <- model_GOOGL_t10_L3_U64_U32_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U32_U16_B64_D02 <- model_GOOGL_t10_L3_U64_U32_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U32_U32_B64_D02 <- model_GOOGL_t10_L3_U32_U32_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U32_U16_B64_D02 <- model_GOOGL_t10_L3_U32_U32_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U16_U16_B64_D02 <- model_GOOGL_t10_L3_U32_U16_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U16_U8_B64_D02 <- model_GOOGL_t10_L3_U32_U16_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U16_U16_B64_D02 <- model_GOOGL_t10_L3_U16_U16_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U16_U8_B64_D02 <- model_GOOGL_t10_L3_U16_U16_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U8_U8_B64_D02 <- model_GOOGL_t10_L3_U16_U8_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U8_U8_U8_B64_D02 <- model_GOOGL_t10_L3_U8_U8_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)



# 3 Layers, 10 time-steps, drop-out rate 0.3 og batch size 16
eval_GOOGL_10t_L3_U128_U128_U128_B16_D03 <- model_GOOGL_t10_L3_U128_U128_U128_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U128_U64_B16_D03 <- model_GOOGL_t10_L3_U128_U128_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U64_U64_B16_D03 <- model_GOOGL_t10_L3_U128_U64_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U64_U32_B16_D03 <- model_GOOGL_t10_L3_U128_U64_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U64_U64_B16_D03 <- model_GOOGL_t10_L3_U64_U64_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U64_U32_B16_D03 <- model_GOOGL_t10_L3_U64_U64_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U32_U32_B16_D03 <- model_GOOGL_t10_L3_U64_U32_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U32_U16_B16_D03 <- model_GOOGL_t10_L3_U64_U32_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U32_U32_B16_D03 <- model_GOOGL_t10_L3_U32_U32_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U32_U16_B16_D03 <- model_GOOGL_t10_L3_U32_U32_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U16_U16_B16_D03 <- model_GOOGL_t10_L3_U32_U16_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U16_U8_B16_D03 <- model_GOOGL_t10_L3_U32_U16_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U16_U16_B16_D03 <- model_GOOGL_t10_L3_U16_U16_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U16_U8_B16_D03 <- model_GOOGL_t10_L3_U16_U16_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U8_U8_B16_D03 <- model_GOOGL_t10_L3_U16_U8_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U8_U8_U8_B16_D03 <- model_GOOGL_t10_L3_U8_U8_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)



# 3 Layers, 10 time-steps, drop-out rate 0.3 og batch size 32
eval_GOOGL_10t_L3_U128_U128_U128_B32_D03 <- model_GOOGL_t10_L3_U128_U128_U128_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U128_U64_B32_D03 <- model_GOOGL_t10_L3_U128_U128_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U64_U64_B32_D03 <- model_GOOGL_t10_L3_U128_U64_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U64_U32_B32_D03 <- model_GOOGL_t10_L3_U128_U64_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U64_U64_B32_D03 <- model_GOOGL_t10_L3_U64_U64_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U64_U32_B32_D03 <- model_GOOGL_t10_L3_U64_U64_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U32_U32_B32_D03 <- model_GOOGL_t10_L3_U64_U32_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U32_U16_B32_D03 <- model_GOOGL_t10_L3_U64_U32_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U32_U32_B32_D03 <- model_GOOGL_t10_L3_U32_U32_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U32_U16_B32_D03 <- model_GOOGL_t10_L3_U32_U32_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U16_U16_B32_D03 <- model_GOOGL_t10_L3_U32_U16_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U16_U8_B32_D03 <- model_GOOGL_t10_L3_U32_U16_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U16_U16_B32_D03 <- model_GOOGL_t10_L3_U16_U16_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U16_U8_B32_D03 <- model_GOOGL_t10_L3_U16_U16_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U8_U8_B32_D03 <- model_GOOGL_t10_L3_U16_U8_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U8_U8_U8_B32_D03 <- model_GOOGL_t10_L3_U8_U8_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)


# 3 Layers, 10 time-steps, drop-out rate 0.3 og batch size 64
eval_GOOGL_10t_L3_U128_U128_U128_B64_D03 <- model_GOOGL_t10_L3_U128_U128_U128_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U128_U64_B64_D03 <- model_GOOGL_t10_L3_U128_U128_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U64_U64_B64_D03 <- model_GOOGL_t10_L3_U128_U64_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U128_U64_U32_B64_D03 <- model_GOOGL_t10_L3_U128_U64_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U64_U64_B64_D03 <- model_GOOGL_t10_L3_U64_U64_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U64_U32_B64_D03 <- model_GOOGL_t10_L3_U64_U64_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U32_U32_B64_D03 <- model_GOOGL_t10_L3_U64_U32_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U64_U32_U16_B64_D03 <- model_GOOGL_t10_L3_U64_U32_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U32_U32_B64_D03 <- model_GOOGL_t10_L3_U32_U32_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U32_U16_B64_D03 <- model_GOOGL_t10_L3_U32_U32_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U16_U16_B64_D03 <- model_GOOGL_t10_L3_U32_U16_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U32_U16_U8_B64_D03 <- model_GOOGL_t10_L3_U32_U16_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U16_U16_B64_D03 <- model_GOOGL_t10_L3_U16_U16_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U16_U8_B64_D03 <- model_GOOGL_t10_L3_U16_U16_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U16_U8_U8_B64_D03 <- model_GOOGL_t10_L3_U16_U8_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L3_U8_U8_U8_B64_D03 <- model_GOOGL_t10_L3_U8_U8_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

```








### Evaluering 4 Layers og 10 time-steps


```{r, include = FALSE}
# 4 Layers, 10 time-steps, drop-out rate 0.2 og batch size 16
eval_GOOGL_10t_L4_U128_U128_U128_U128_B16_D02 <- model_GOOGL_t10_L4_U128_U128_U128_U128_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U128_U128_U64_B16_D02 <- model_GOOGL_t10_L4_U128_U128_U128_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U128_U64_U64_B16_D02 <- model_GOOGL_t10_L4_U128_U128_U64_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U64_U64_U64_B16_D02 <- model_GOOGL_t10_L4_U128_U64_U64_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U64_U64_U32_B16_D02 <- model_GOOGL_t10_L4_U128_U64_U64_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U64_U64_U64_U64_B16_D02 <- model_GOOGL_t10_L4_U64_U64_U64_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U64_U64_U32_B16_D02 <- model_GOOGL_t10_L4_U64_U64_U64_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U64_U32_U32_B16_D02 <- model_GOOGL_t10_L4_U64_U64_U32_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U32_U32_U32_B16_D02 <- model_GOOGL_t10_L4_U64_U32_U32_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U32_U32_U16_B16_D02 <- model_GOOGL_t10_L4_U64_U32_U32_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U32_U32_U32_U32_B16_D02 <- model_GOOGL_t10_L4_U32_U32_U32_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U32_U32_U16_B16_D02 <- model_GOOGL_t10_L4_U32_U32_U32_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U32_U16_U16_B16_D02 <- model_GOOGL_t10_L4_U32_U32_U16_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U16_U16_U16_B16_D02 <- model_GOOGL_t10_L4_U32_U16_U16_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U16_U16_U8_B16_D02 <- model_GOOGL_t10_L4_U32_U16_U16_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U16_U16_U16_U16_B16_D02 <- model_GOOGL_t10_L4_U16_U16_U16_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U16_U16_U8_B16_D02 <- model_GOOGL_t10_L4_U16_U16_U16_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U16_U8_U8_B16_D02 <- model_GOOGL_t10_L4_U16_U16_U8_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U8_U8_U8_B16_D02 <- model_GOOGL_t10_L4_U16_U8_U8_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)



# 4 Layers, 10 time-steps, drop-out rate 0.2 og batch size 42
eval_GOOGL_10t_L4_U128_U128_U128_U128_B32_D02 <- model_GOOGL_t10_L4_U128_U128_U128_U128_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U128_U128_U64_B32_D02 <- model_GOOGL_t10_L4_U128_U128_U128_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U128_U64_U64_B32_D02 <- model_GOOGL_t10_L4_U128_U128_U64_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U64_U64_U64_B32_D02 <- model_GOOGL_t10_L4_U128_U64_U64_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U64_U64_U32_B32_D02 <- model_GOOGL_t10_L4_U128_U64_U64_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U64_U64_U64_U64_B32_D02 <- model_GOOGL_t10_L4_U64_U64_U64_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U64_U64_U32_B32_D02 <- model_GOOGL_t10_L4_U64_U64_U64_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U64_U32_U32_B32_D02 <- model_GOOGL_t10_L4_U64_U64_U32_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U32_U32_U32_B32_D02 <- model_GOOGL_t10_L4_U64_U32_U32_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U32_U32_U16_B32_D02 <- model_GOOGL_t10_L4_U64_U32_U32_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U32_U32_U32_U32_B32_D02 <- model_GOOGL_t10_L4_U32_U32_U32_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U32_U32_U16_B32_D02 <- model_GOOGL_t10_L4_U32_U32_U32_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U32_U16_U16_B32_D02 <- model_GOOGL_t10_L4_U32_U32_U16_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U16_U16_U16_B32_D02 <- model_GOOGL_t10_L4_U32_U16_U16_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U16_U16_U8_B32_D02 <- model_GOOGL_t10_L4_U32_U16_U16_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U16_U16_U16_U16_B32_D02 <- model_GOOGL_t10_L4_U16_U16_U16_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U16_U16_U8_B32_D02 <- model_GOOGL_t10_L4_U16_U16_U16_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U16_U8_U8_B32_D02 <- model_GOOGL_t10_L4_U16_U16_U8_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U8_U8_U8_B32_D02 <- model_GOOGL_t10_L4_U16_U8_U8_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)


# 4 Layers, 10 time-steps, drop-out rate 0.2 og batch size 64
eval_GOOGL_10t_L4_U128_U128_U128_U128_B64_D02 <- model_GOOGL_t10_L4_U128_U128_U128_U128_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U128_U128_U64_B64_D02 <- model_GOOGL_t10_L4_U128_U128_U128_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U128_U64_U64_B64_D02 <- model_GOOGL_t10_L4_U128_U128_U64_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U64_U64_U64_B64_D02 <- model_GOOGL_t10_L4_U128_U64_U64_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U64_U64_U32_B64_D02 <- model_GOOGL_t10_L4_U128_U64_U64_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U64_U64_U64_U64_B64_D02 <- model_GOOGL_t10_L4_U64_U64_U64_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U64_U64_U32_B64_D02 <- model_GOOGL_t10_L4_U64_U64_U64_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U64_U32_U32_B64_D02 <- model_GOOGL_t10_L4_U64_U64_U32_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U32_U32_U32_B64_D02 <- model_GOOGL_t10_L4_U64_U32_U32_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U32_U32_U16_B64_D02 <- model_GOOGL_t10_L4_U64_U32_U32_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U32_U32_U32_U32_B64_D02 <- model_GOOGL_t10_L4_U32_U32_U32_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U32_U32_U16_B64_D02 <- model_GOOGL_t10_L4_U32_U32_U32_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U32_U16_U16_B64_D02 <- model_GOOGL_t10_L4_U32_U32_U16_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U16_U16_U16_B64_D02 <- model_GOOGL_t10_L4_U32_U16_U16_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U16_U16_U8_B64_D02 <- model_GOOGL_t10_L4_U32_U16_U16_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U16_U16_U16_U16_B64_D02 <- model_GOOGL_t10_L4_U16_U16_U16_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U16_U16_U8_B64_D02 <- model_GOOGL_t10_L4_U16_U16_U16_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U16_U8_U8_B64_D02 <- model_GOOGL_t10_L4_U16_U16_U8_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U8_U8_U8_B64_D02 <- model_GOOGL_t10_L4_U16_U8_U8_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)




# 4 Layers, 10 time-steps, drop-out rate 0.3 og batch size 16
eval_GOOGL_10t_L4_U128_U128_U128_U128_B16_D03 <- model_GOOGL_t10_L4_U128_U128_U128_U128_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U128_U128_U64_B16_D03 <- model_GOOGL_t10_L4_U128_U128_U128_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U128_U64_U64_B16_D03 <- model_GOOGL_t10_L4_U128_U128_U64_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U64_U64_U64_B16_D03 <- model_GOOGL_t10_L4_U128_U64_U64_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U64_U64_U32_B16_D03 <- model_GOOGL_t10_L4_U128_U64_U64_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U64_U64_U64_U64_B16_D03 <- model_GOOGL_t10_L4_U64_U64_U64_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U64_U64_U32_B16_D03 <- model_GOOGL_t10_L4_U64_U64_U64_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U64_U32_U32_B16_D03 <- model_GOOGL_t10_L4_U64_U64_U32_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U32_U32_U32_B16_D03 <- model_GOOGL_t10_L4_U64_U32_U32_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U32_U32_U16_B16_D03 <- model_GOOGL_t10_L4_U64_U32_U32_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U32_U32_U32_U32_B16_D03 <- model_GOOGL_t10_L4_U32_U32_U32_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U32_U32_U16_B16_D03 <- model_GOOGL_t10_L4_U32_U32_U32_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U32_U16_U16_B16_D03 <- model_GOOGL_t10_L4_U32_U32_U16_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U16_U16_U16_B16_D03 <- model_GOOGL_t10_L4_U32_U16_U16_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U16_U16_U8_B16_D03 <- model_GOOGL_t10_L4_U32_U16_U16_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U16_U16_U16_U16_B16_D03 <- model_GOOGL_t10_L4_U16_U16_U16_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U16_U16_U8_B16_D03 <- model_GOOGL_t10_L4_U16_U16_U16_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U16_U8_U8_B16_D03 <- model_GOOGL_t10_L4_U16_U16_U8_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U8_U8_U8_B16_D03 <- model_GOOGL_t10_L4_U16_U8_U8_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)



# 4 Layers, 10 time-steps, drop-out rate 0.3 og batch size 42
eval_GOOGL_10t_L4_U128_U128_U128_U128_B32_D03 <- model_GOOGL_t10_L4_U128_U128_U128_U128_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U128_U128_U64_B32_D03 <- model_GOOGL_t10_L4_U128_U128_U128_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U128_U64_U64_B32_D03 <- model_GOOGL_t10_L4_U128_U128_U64_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U64_U64_U64_B32_D03 <- model_GOOGL_t10_L4_U128_U64_U64_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U64_U64_U32_B32_D03 <- model_GOOGL_t10_L4_U128_U64_U64_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U64_U64_U64_U64_B32_D03 <- model_GOOGL_t10_L4_U64_U64_U64_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U64_U64_U32_B32_D03 <- model_GOOGL_t10_L4_U64_U64_U64_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U64_U32_U32_B32_D03 <- model_GOOGL_t10_L4_U64_U64_U32_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U32_U32_U32_B32_D03 <- model_GOOGL_t10_L4_U64_U32_U32_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U32_U32_U16_B32_D03 <- model_GOOGL_t10_L4_U64_U32_U32_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U32_U32_U32_U32_B32_D03 <- model_GOOGL_t10_L4_U32_U32_U32_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U32_U32_U16_B32_D03 <- model_GOOGL_t10_L4_U32_U32_U32_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U32_U16_U16_B32_D03 <- model_GOOGL_t10_L4_U32_U32_U16_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U16_U16_U16_B32_D03 <- model_GOOGL_t10_L4_U32_U16_U16_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U16_U16_U8_B32_D03 <- model_GOOGL_t10_L4_U32_U16_U16_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U16_U16_U16_U16_B32_D03 <- model_GOOGL_t10_L4_U16_U16_U16_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U16_U16_U8_B32_D03 <- model_GOOGL_t10_L4_U16_U16_U16_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U16_U8_U8_B32_D03 <- model_GOOGL_t10_L4_U16_U16_U8_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U8_U8_U8_B32_D03 <- model_GOOGL_t10_L4_U16_U8_U8_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)


# 4 Layers, 10 time-steps, drop-out rate 0.3 og batch size 64
eval_GOOGL_10t_L4_U128_U128_U128_U128_B64_D03 <- model_GOOGL_t10_L4_U128_U128_U128_U128_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U128_U128_U64_B64_D03 <- model_GOOGL_t10_L4_U128_U128_U128_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U128_U64_U64_B64_D03 <- model_GOOGL_t10_L4_U128_U128_U64_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U64_U64_U64_B64_D03 <- model_GOOGL_t10_L4_U128_U64_U64_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U128_U64_U64_U32_B64_D03 <- model_GOOGL_t10_L4_U128_U64_U64_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U64_U64_U64_U64_B64_D03 <- model_GOOGL_t10_L4_U64_U64_U64_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U64_U64_U32_B64_D03 <- model_GOOGL_t10_L4_U64_U64_U64_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U64_U32_U32_B64_D03 <- model_GOOGL_t10_L4_U64_U64_U32_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U32_U32_U32_B64_D03 <- model_GOOGL_t10_L4_U64_U32_U32_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U64_U32_U32_U16_B64_D03 <- model_GOOGL_t10_L4_U64_U32_U32_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U32_U32_U32_U32_B64_D03 <- model_GOOGL_t10_L4_U32_U32_U32_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U32_U32_U16_B64_D03 <- model_GOOGL_t10_L4_U32_U32_U32_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U32_U16_U16_B64_D03 <- model_GOOGL_t10_L4_U32_U32_U16_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U16_U16_U16_B64_D03 <- model_GOOGL_t10_L4_U32_U16_U16_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U32_U16_U16_U8_B64_D03 <- model_GOOGL_t10_L4_U32_U16_U16_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)

eval_GOOGL_10t_L4_U16_U16_U16_U16_B64_D03 <- model_GOOGL_t10_L4_U16_U16_U16_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U16_U16_U8_B64_D03 <- model_GOOGL_t10_L4_U16_U16_U16_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U16_U8_U8_B64_D03 <- model_GOOGL_t10_L4_U16_U16_U8_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)
eval_GOOGL_10t_L4_U16_U8_U8_U8_B64_D03 <- model_GOOGL_t10_L4_U16_U8_U8_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL1, y_train_arr_GOOGL1)



```





# Evaluering af modeller 1 time-step


### Evaluering 2 Layers og 1  time-steps

```{r, include = FALSE}
# 2 Layers, 1 time-steps, drop-out rate 0.2 og batch size 16
eval_GOOGL_1t_L2_U128_U128_B16_D02 <- model_GOOGL_t1_L2_U128_U128_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U128_U64_B16_D02 <- model_GOOGL_t1_L2_U128_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U64_U64_B16_D02 <- model_GOOGL_t1_L2_U64_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U64_U32_B16_D02 <- model_GOOGL_t1_L2_U64_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U32_U32_B16_D02 <- model_GOOGL_t1_L2_U32_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U32_U16_B16_D02 <- model_GOOGL_t1_L2_U32_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U16_U16_B16_D02 <- model_GOOGL_t1_L2_U16_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U16_U8_B16_D02 <- model_GOOGL_t1_L2_U16_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U8_U8_B16_D02 <- model_GOOGL_t1_L2_U8_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)


# 2 Layers, 1 time-steps, drop-out rate 0.2 og batch size 32
eval_GOOGL_1t_L2_U128_U128_B32_D02 <- model_GOOGL_t1_L2_U128_U128_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U128_U64_B32_D02 <- model_GOOGL_t1_L2_U128_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U64_U64_B32_D02 <- model_GOOGL_t1_L2_U64_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U64_U32_B32_D02 <- model_GOOGL_t1_L2_U64_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U32_U32_B32_D02 <- model_GOOGL_t1_L2_U32_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U32_U16_B32_D02 <- model_GOOGL_t1_L2_U32_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U16_U16_B32_D02 <- model_GOOGL_t1_L2_U16_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U16_U8_B32_D02 <- model_GOOGL_t1_L2_U16_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U8_U8_B32_D02 <- model_GOOGL_t1_L2_U8_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)


# 2 Layers, 1 time-steps, drop-out rate 0.2 og batch size 64
eval_GOOGL_1t_L2_U128_U128_B64_D02 <- model_GOOGL_t1_L2_U128_U128_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U128_U64_B64_D02 <- model_GOOGL_t1_L2_U128_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U64_U64_B64_D02 <- model_GOOGL_t1_L2_U64_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U64_U32_B64_D02 <- model_GOOGL_t1_L2_U64_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U32_U32_B64_D02 <- model_GOOGL_t1_L2_U32_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U32_U16_B64_D02 <- model_GOOGL_t1_L2_U32_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U16_U16_B64_D02 <- model_GOOGL_t1_L2_U16_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U16_U8_B64_D02 <- model_GOOGL_t1_L2_U16_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U8_U8_B64_D02 <- model_GOOGL_t1_L2_U8_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)



# 2 Layers, 1 time-steps, drop-out rate 0.3 og batch size 16
eval_GOOGL_1t_L2_U128_U128_B16_D03 <- model_GOOGL_t1_L2_U128_U128_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U128_U64_B16_D03 <- model_GOOGL_t1_L2_U128_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U64_U64_B16_D03 <- model_GOOGL_t1_L2_U64_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U64_U32_B16_D03 <- model_GOOGL_t1_L2_U64_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U32_U32_B16_D03 <- model_GOOGL_t1_L2_U32_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U32_U16_B16_D03 <- model_GOOGL_t1_L2_U32_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U16_U16_B16_D03 <- model_GOOGL_t1_L2_U16_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U16_U8_B16_D03 <- model_GOOGL_t1_L2_U16_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U8_U8_B16_D03 <- model_GOOGL_t1_L2_U8_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)


# 2 Layers, 1 time-steps, drop-out rate 0.3 og batch size 32
eval_GOOGL_1t_L2_U128_U128_B32_D03 <- model_GOOGL_t1_L2_U128_U128_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U128_U64_B32_D03 <- model_GOOGL_t1_L2_U128_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U64_U64_B32_D03 <- model_GOOGL_t1_L2_U64_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U64_U32_B32_D03 <- model_GOOGL_t1_L2_U64_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U32_U32_B32_D03 <- model_GOOGL_t1_L2_U32_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U32_U16_B32_D03 <- model_GOOGL_t1_L2_U32_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U16_U16_B32_D03 <- model_GOOGL_t1_L2_U16_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U16_U8_B32_D03 <- model_GOOGL_t1_L2_U16_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U8_U8_B32_D03 <- model_GOOGL_t1_L2_U8_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)


# 2 Layers, 1 time-steps, drop-out rate 0.3 og batch size 64
eval_GOOGL_1t_L2_U128_U128_B64_D03 <- model_GOOGL_t1_L2_U128_U128_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U128_U64_B64_D03 <- model_GOOGL_t1_L2_U128_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U64_U64_B64_D03 <- model_GOOGL_t1_L2_U64_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U64_U32_B64_D03 <- model_GOOGL_t1_L2_U64_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U32_U32_B64_D03 <- model_GOOGL_t1_L2_U32_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U32_U16_B64_D03 <- model_GOOGL_t1_L2_U32_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U16_U16_B64_D03 <- model_GOOGL_t1_L2_U16_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U16_U8_B64_D03 <- model_GOOGL_t1_L2_U16_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L2_U8_U8_B64_D03 <- model_GOOGL_t1_L2_U8_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
```




### Evaluering 3 Layers og 1  time-steps


```{r, include = FALSE}
# 3 Layers, 1 time-steps, drop-out rate 0.2 og batch size 16
eval_GOOGL_1t_L3_U128_U128_U128_B16_D02 <- model_GOOGL_t1_L3_U128_U128_U128_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U128_U64_B16_D02 <- model_GOOGL_t1_L3_U128_U128_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U64_U64_B16_D02 <- model_GOOGL_t1_L3_U128_U64_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U64_U32_B16_D02 <- model_GOOGL_t1_L3_U128_U64_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U64_U64_B16_D02 <- model_GOOGL_t1_L3_U64_U64_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U64_U32_B16_D02 <- model_GOOGL_t1_L3_U64_U64_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U32_U32_B16_D02 <- model_GOOGL_t1_L3_U64_U32_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U32_U16_B16_D02 <- model_GOOGL_t1_L3_U64_U32_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U32_U32_B16_D02 <- model_GOOGL_t1_L3_U32_U32_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U32_U16_B16_D02 <- model_GOOGL_t1_L3_U32_U32_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U16_U16_B16_D02 <- model_GOOGL_t1_L3_U32_U16_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U16_U8_B16_D02 <- model_GOOGL_t1_L3_U32_U16_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U16_U16_B16_D02 <- model_GOOGL_t1_L3_U16_U16_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U16_U8_B16_D02 <- model_GOOGL_t1_L3_U16_U16_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U8_U8_B16_D02 <- model_GOOGL_t1_L3_U16_U8_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U8_U8_U8_B16_D02 <- model_GOOGL_t1_L3_U8_U8_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)


# 3 Layers, 1 time-steps, drop-out rate 0.2 og batch size 32
eval_GOOGL_1t_L3_U128_U128_U128_B32_D02 <- model_GOOGL_t1_L3_U128_U128_U128_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U128_U64_B32_D02 <- model_GOOGL_t1_L3_U128_U128_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U64_U64_B32_D02 <- model_GOOGL_t1_L3_U128_U64_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U64_U32_B32_D02 <- model_GOOGL_t1_L3_U128_U64_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U64_U64_B32_D02 <- model_GOOGL_t1_L3_U64_U64_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U64_U32_B32_D02 <- model_GOOGL_t1_L3_U64_U64_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U32_U32_B32_D02 <- model_GOOGL_t1_L3_U64_U32_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U32_U16_B32_D02 <- model_GOOGL_t1_L3_U64_U32_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U32_U32_B32_D02 <- model_GOOGL_t1_L3_U32_U32_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U32_U16_B32_D02 <- model_GOOGL_t1_L3_U32_U32_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U16_U16_B32_D02 <- model_GOOGL_t1_L3_U32_U16_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U16_U8_B32_D02 <- model_GOOGL_t1_L3_U32_U16_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U16_U16_B32_D02 <- model_GOOGL_t1_L3_U16_U16_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U16_U8_B32_D02 <- model_GOOGL_t1_L3_U16_U16_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U8_U8_B32_D02 <- model_GOOGL_t1_L3_U16_U8_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U8_U8_U8_B32_D02 <- model_GOOGL_t1_L3_U8_U8_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)



# 3 Layers, 1 time-steps, drop-out rate 0.2 og batch size 64
eval_GOOGL_1t_L3_U128_U128_U128_B64_D02 <- model_GOOGL_t1_L3_U128_U128_U128_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U128_U64_B64_D02 <- model_GOOGL_t1_L3_U128_U128_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U64_U64_B64_D02 <- model_GOOGL_t1_L3_U128_U64_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U64_U32_B64_D02 <- model_GOOGL_t1_L3_U128_U64_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U64_U64_B64_D02 <- model_GOOGL_t1_L3_U64_U64_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U64_U32_B64_D02 <- model_GOOGL_t1_L3_U64_U64_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U32_U32_B64_D02 <- model_GOOGL_t1_L3_U64_U32_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U32_U16_B64_D02 <- model_GOOGL_t1_L3_U64_U32_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U32_U32_B64_D02 <- model_GOOGL_t1_L3_U32_U32_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U32_U16_B64_D02 <- model_GOOGL_t1_L3_U32_U32_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U16_U16_B64_D02 <- model_GOOGL_t1_L3_U32_U16_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U16_U8_B64_D02 <- model_GOOGL_t1_L3_U32_U16_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U16_U16_B64_D02 <- model_GOOGL_t1_L3_U16_U16_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U16_U8_B64_D02 <- model_GOOGL_t1_L3_U16_U16_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U8_U8_B64_D02 <- model_GOOGL_t1_L3_U16_U8_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U8_U8_U8_B64_D02 <- model_GOOGL_t1_L3_U8_U8_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)



# 3 Layers, 1 time-steps, drop-out rate 0.3 og batch size 16
eval_GOOGL_1t_L3_U128_U128_U128_B16_D03 <- model_GOOGL_t1_L3_U128_U128_U128_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U128_U64_B16_D03 <- model_GOOGL_t1_L3_U128_U128_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U64_U64_B16_D03 <- model_GOOGL_t1_L3_U128_U64_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U64_U32_B16_D03 <- model_GOOGL_t1_L3_U128_U64_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U64_U64_B16_D03 <- model_GOOGL_t1_L3_U64_U64_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U64_U32_B16_D03 <- model_GOOGL_t1_L3_U64_U64_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U32_U32_B16_D03 <- model_GOOGL_t1_L3_U64_U32_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U32_U16_B16_D03 <- model_GOOGL_t1_L3_U64_U32_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U32_U32_B16_D03 <- model_GOOGL_t1_L3_U32_U32_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U32_U16_B16_D03 <- model_GOOGL_t1_L3_U32_U32_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U16_U16_B16_D03 <- model_GOOGL_t1_L3_U32_U16_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U16_U8_B16_D03 <- model_GOOGL_t1_L3_U32_U16_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U16_U16_B16_D03 <- model_GOOGL_t1_L3_U16_U16_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U16_U8_B16_D03 <- model_GOOGL_t1_L3_U16_U16_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U8_U8_B16_D03 <- model_GOOGL_t1_L3_U16_U8_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U8_U8_U8_B16_D03 <- model_GOOGL_t1_L3_U8_U8_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)



# 3 Layers, 1 time-steps, drop-out rate 0.3 og batch size 32
eval_GOOGL_1t_L3_U128_U128_U128_B32_D03 <- model_GOOGL_t1_L3_U128_U128_U128_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U128_U64_B32_D03 <- model_GOOGL_t1_L3_U128_U128_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U64_U64_B32_D03 <- model_GOOGL_t1_L3_U128_U64_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U64_U32_B32_D03 <- model_GOOGL_t1_L3_U128_U64_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U64_U64_B32_D03 <- model_GOOGL_t1_L3_U64_U64_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U64_U32_B32_D03 <- model_GOOGL_t1_L3_U64_U64_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U32_U32_B32_D03 <- model_GOOGL_t1_L3_U64_U32_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U32_U16_B32_D03 <- model_GOOGL_t1_L3_U64_U32_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U32_U32_B32_D03 <- model_GOOGL_t1_L3_U32_U32_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U32_U16_B32_D03 <- model_GOOGL_t1_L3_U32_U32_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U16_U16_B32_D03 <- model_GOOGL_t1_L3_U32_U16_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U16_U8_B32_D03 <- model_GOOGL_t1_L3_U32_U16_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U16_U16_B32_D03 <- model_GOOGL_t1_L3_U16_U16_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U16_U8_B32_D03 <- model_GOOGL_t1_L3_U16_U16_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U8_U8_B32_D03 <- model_GOOGL_t1_L3_U16_U8_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U8_U8_U8_B32_D03 <- model_GOOGL_t1_L3_U8_U8_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)


# 3 Layers, 1 time-steps, drop-out rate 0.3 og batch size 64
eval_GOOGL_1t_L3_U128_U128_U128_B64_D03 <- model_GOOGL_t1_L3_U128_U128_U128_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U128_U64_B64_D03 <- model_GOOGL_t1_L3_U128_U128_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U64_U64_B64_D03 <- model_GOOGL_t1_L3_U128_U64_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U128_U64_U32_B64_D03 <- model_GOOGL_t1_L3_U128_U64_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U64_U64_B64_D03 <- model_GOOGL_t1_L3_U64_U64_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U64_U32_B64_D03 <- model_GOOGL_t1_L3_U64_U64_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U32_U32_B64_D03 <- model_GOOGL_t1_L3_U64_U32_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U64_U32_U16_B64_D03 <- model_GOOGL_t1_L3_U64_U32_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U32_U32_B64_D03 <- model_GOOGL_t1_L3_U32_U32_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U32_U16_B64_D03 <- model_GOOGL_t1_L3_U32_U32_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U16_U16_B64_D03 <- model_GOOGL_t1_L3_U32_U16_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U32_U16_U8_B64_D03 <- model_GOOGL_t1_L3_U32_U16_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U16_U16_B64_D03 <- model_GOOGL_t1_L3_U16_U16_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U16_U8_B64_D03 <- model_GOOGL_t1_L3_U16_U16_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U16_U8_U8_B64_D03 <- model_GOOGL_t1_L3_U16_U8_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L3_U8_U8_U8_B64_D03 <- model_GOOGL_t1_L3_U8_U8_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

```








### Evaluering 4 Layers og 1  time-steps


```{r, include = FALSE}
# 4 Layers, 1 time-steps, drop-out rate 0.2 og batch size 16
eval_GOOGL_1t_L4_U128_U128_U128_U128_B16_D02 <- model_GOOGL_t1_L4_U128_U128_U128_U128_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U128_U128_U64_B16_D02 <- model_GOOGL_t1_L4_U128_U128_U128_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U128_U64_U64_B16_D02 <- model_GOOGL_t1_L4_U128_U128_U64_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U64_U64_U64_B16_D02 <- model_GOOGL_t1_L4_U128_U64_U64_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U64_U64_U32_B16_D02 <- model_GOOGL_t1_L4_U128_U64_U64_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U64_U64_U64_U64_B16_D02 <- model_GOOGL_t1_L4_U64_U64_U64_U64_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U64_U64_U32_B16_D02 <- model_GOOGL_t1_L4_U64_U64_U64_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U64_U32_U32_B16_D02 <- model_GOOGL_t1_L4_U64_U64_U32_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U32_U32_U32_B16_D02 <- model_GOOGL_t1_L4_U64_U32_U32_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U32_U32_U16_B16_D02 <- model_GOOGL_t1_L4_U64_U32_U32_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U32_U32_U32_U32_B16_D02 <- model_GOOGL_t1_L4_U32_U32_U32_U32_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U32_U32_U16_B16_D02 <- model_GOOGL_t1_L4_U32_U32_U32_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U32_U16_U16_B16_D02 <- model_GOOGL_t1_L4_U32_U32_U16_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U16_U16_U16_B16_D02 <- model_GOOGL_t1_L4_U32_U16_U16_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U16_U16_U8_B16_D02 <- model_GOOGL_t1_L4_U32_U16_U16_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U16_U16_U16_U16_B16_D02 <- model_GOOGL_t1_L4_U16_U16_U16_U16_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U16_U16_U8_B16_D02 <- model_GOOGL_t1_L4_U16_U16_U16_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U16_U8_U8_B16_D02 <- model_GOOGL_t1_L4_U16_U16_U8_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U8_U8_U8_B16_D02 <- model_GOOGL_t1_L4_U16_U8_U8_U8_B16_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)



# 4 Layers, 1 time-steps, drop-out rate 0.2 og batch size 32
eval_GOOGL_1t_L4_U128_U128_U128_U128_B32_D02 <- model_GOOGL_t1_L4_U128_U128_U128_U128_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U128_U128_U64_B32_D02 <- model_GOOGL_t1_L4_U128_U128_U128_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U128_U64_U64_B32_D02 <- model_GOOGL_t1_L4_U128_U128_U64_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U64_U64_U64_B32_D02 <- model_GOOGL_t1_L4_U128_U64_U64_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U64_U64_U32_B32_D02 <- model_GOOGL_t1_L4_U128_U64_U64_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U64_U64_U64_U64_B32_D02 <- model_GOOGL_t1_L4_U64_U64_U64_U64_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U64_U64_U32_B32_D02 <- model_GOOGL_t1_L4_U64_U64_U64_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U64_U32_U32_B32_D02 <- model_GOOGL_t1_L4_U64_U64_U32_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U32_U32_U32_B32_D02 <- model_GOOGL_t1_L4_U64_U32_U32_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U32_U32_U16_B32_D02 <- model_GOOGL_t1_L4_U64_U32_U32_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U32_U32_U32_U32_B32_D02 <- model_GOOGL_t1_L4_U32_U32_U32_U32_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U32_U32_U16_B32_D02 <- model_GOOGL_t1_L4_U32_U32_U32_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U32_U16_U16_B32_D02 <- model_GOOGL_t1_L4_U32_U32_U16_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U16_U16_U16_B32_D02 <- model_GOOGL_t1_L4_U32_U16_U16_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U16_U16_U8_B32_D02 <- model_GOOGL_t1_L4_U32_U16_U16_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U16_U16_U16_U16_B32_D02 <- model_GOOGL_t1_L4_U16_U16_U16_U16_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U16_U16_U8_B32_D02 <- model_GOOGL_t1_L4_U16_U16_U16_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U16_U8_U8_B32_D02 <- model_GOOGL_t1_L4_U16_U16_U8_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U8_U8_U8_B32_D02 <- model_GOOGL_t1_L4_U16_U8_U8_U8_B32_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)


# 4 Layers, 1 time-steps, drop-out rate 0.2 og batch size 64
eval_GOOGL_1t_L4_U128_U128_U128_U128_B64_D02 <- model_GOOGL_t1_L4_U128_U128_U128_U128_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U128_U128_U64_B64_D02 <- model_GOOGL_t1_L4_U128_U128_U128_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U128_U64_U64_B64_D02 <- model_GOOGL_t1_L4_U128_U128_U64_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U64_U64_U64_B64_D02 <- model_GOOGL_t1_L4_U128_U64_U64_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U64_U64_U32_B64_D02 <- model_GOOGL_t1_L4_U128_U64_U64_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U64_U64_U64_U64_B64_D02 <- model_GOOGL_t1_L4_U64_U64_U64_U64_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U64_U64_U32_B64_D02 <- model_GOOGL_t1_L4_U64_U64_U64_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U64_U32_U32_B64_D02 <- model_GOOGL_t1_L4_U64_U64_U32_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U32_U32_U32_B64_D02 <- model_GOOGL_t1_L4_U64_U32_U32_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U32_U32_U16_B64_D02 <- model_GOOGL_t1_L4_U64_U32_U32_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U32_U32_U32_U32_B64_D02 <- model_GOOGL_t1_L4_U32_U32_U32_U32_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U32_U32_U16_B64_D02 <- model_GOOGL_t1_L4_U32_U32_U32_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U32_U16_U16_B64_D02 <- model_GOOGL_t1_L4_U32_U32_U16_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U16_U16_U16_B64_D02 <- model_GOOGL_t1_L4_U32_U16_U16_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U16_U16_U8_B64_D02 <- model_GOOGL_t1_L4_U32_U16_U16_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U16_U16_U16_U16_B64_D02 <- model_GOOGL_t1_L4_U16_U16_U16_U16_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U16_U16_U8_B64_D02 <- model_GOOGL_t1_L4_U16_U16_U16_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U16_U8_U8_B64_D02 <- model_GOOGL_t1_L4_U16_U16_U8_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U8_U8_U8_B64_D02 <- model_GOOGL_t1_L4_U16_U8_U8_U8_B64_D02 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)




```








```{r, warning=FALSE, results='hide'}


# 4 Layers, 1 time-steps, drop-out rate 0.3 og batch size 16
eval_GOOGL_1t_L4_U128_U128_U128_U128_B16_D03 <- model_GOOGL_t1_L4_U128_U128_U128_U128_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U128_U128_U64_B16_D03 <- model_GOOGL_t1_L4_U128_U128_U128_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U128_U64_U64_B16_D03 <- model_GOOGL_t1_L4_U128_U128_U64_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U64_U64_U64_B16_D03 <- model_GOOGL_t1_L4_U128_U64_U64_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U64_U64_U32_B16_D03 <- model_GOOGL_t1_L4_U128_U64_U64_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U64_U64_U64_U64_B16_D03 <- model_GOOGL_t1_L4_U64_U64_U64_U64_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U64_U64_U32_B16_D03 <- model_GOOGL_t1_L4_U64_U64_U64_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U64_U32_U32_B16_D03 <- model_GOOGL_t1_L4_U64_U64_U32_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U32_U32_U32_B16_D03 <- model_GOOGL_t1_L4_U64_U32_U32_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U32_U32_U16_B16_D03 <- model_GOOGL_t1_L4_U64_U32_U32_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U32_U32_U32_U32_B16_D03 <- model_GOOGL_t1_L4_U32_U32_U32_U32_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U32_U32_U16_B16_D03 <- model_GOOGL_t1_L4_U32_U32_U32_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U32_U16_U16_B16_D03 <- model_GOOGL_t1_L4_U32_U32_U16_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U16_U16_U16_B16_D03 <- model_GOOGL_t1_L4_U32_U16_U16_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U16_U16_U8_B16_D03 <- model_GOOGL_t1_L4_U32_U16_U16_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U16_U16_U16_U16_B16_D03 <- model_GOOGL_t1_L4_U16_U16_U16_U16_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U16_U16_U8_B16_D03 <- model_GOOGL_t1_L4_U16_U16_U16_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U16_U8_U8_B16_D03 <- model_GOOGL_t1_L4_U16_U16_U8_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U8_U8_U8_B16_D03 <- model_GOOGL_t1_L4_U16_U8_U8_U8_B16_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)



# 4 Layers, 1 time-steps, drop-out rate 0.3 og batch size 32
eval_GOOGL_1t_L4_U128_U128_U128_U128_B32_D03 <- model_GOOGL_t1_L4_U128_U128_U128_U128_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U128_U128_U64_B32_D03 <- model_GOOGL_t1_L4_U128_U128_U128_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U128_U64_U64_B32_D03 <- model_GOOGL_t1_L4_U128_U128_U64_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U64_U64_U64_B32_D03 <- model_GOOGL_t1_L4_U128_U64_U64_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U64_U64_U32_B32_D03 <- model_GOOGL_t1_L4_U128_U64_U64_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U64_U64_U64_U64_B32_D03 <- model_GOOGL_t1_L4_U64_U64_U64_U64_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U64_U64_U32_B32_D03 <- model_GOOGL_t1_L4_U64_U64_U64_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U64_U32_U32_B32_D03 <- model_GOOGL_t1_L4_U64_U64_U32_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U32_U32_U32_B32_D03 <- model_GOOGL_t1_L4_U64_U32_U32_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U32_U32_U16_B32_D03 <- model_GOOGL_t1_L4_U64_U32_U32_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U32_U32_U32_U32_B32_D03 <- model_GOOGL_t1_L4_U32_U32_U32_U32_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U32_U32_U16_B32_D03 <- model_GOOGL_t1_L4_U32_U32_U32_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U32_U16_U16_B32_D03 <- model_GOOGL_t1_L4_U32_U32_U16_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U16_U16_U16_B32_D03 <- model_GOOGL_t1_L4_U32_U16_U16_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U16_U16_U8_B32_D03 <- model_GOOGL_t1_L4_U32_U16_U16_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U16_U16_U16_U16_B32_D03 <- model_GOOGL_t1_L4_U16_U16_U16_U16_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U16_U16_U8_B32_D03 <- model_GOOGL_t1_L4_U16_U16_U16_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U16_U8_U8_B32_D03 <- model_GOOGL_t1_L4_U16_U16_U8_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U8_U8_U8_B32_D03 <- model_GOOGL_t1_L4_U16_U8_U8_U8_B32_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)


# 4 Layers, 1 time-steps, drop-out rate 0.3 og batch size 64
eval_GOOGL_1t_L4_U128_U128_U128_U128_B64_D03 <- model_GOOGL_t1_L4_U128_U128_U128_U128_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U128_U128_U64_B64_D03 <- model_GOOGL_t1_L4_U128_U128_U128_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U128_U64_U64_B64_D03 <- model_GOOGL_t1_L4_U128_U128_U64_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U64_U64_U64_B64_D03 <- model_GOOGL_t1_L4_U128_U64_U64_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U128_U64_U64_U32_B64_D03 <- model_GOOGL_t1_L4_U128_U64_U64_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U64_U64_U64_U64_B64_D03 <- model_GOOGL_t1_L4_U64_U64_U64_U64_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U64_U64_U32_B64_D03 <- model_GOOGL_t1_L4_U64_U64_U64_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U64_U32_U32_B64_D03 <- model_GOOGL_t1_L4_U64_U64_U32_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U32_U32_U32_B64_D03 <- model_GOOGL_t1_L4_U64_U32_U32_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U64_U32_U32_U16_B64_D03 <- model_GOOGL_t1_L4_U64_U32_U32_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U32_U32_U32_U32_B64_D03 <- model_GOOGL_t1_L4_U32_U32_U32_U32_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U32_U32_U16_B64_D03 <- model_GOOGL_t1_L4_U32_U32_U32_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U32_U16_U16_B64_D03 <- model_GOOGL_t1_L4_U32_U32_U16_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U16_U16_U16_B64_D03 <- model_GOOGL_t1_L4_U32_U16_U16_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U32_U16_U16_U8_B64_D03 <- model_GOOGL_t1_L4_U32_U16_U16_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)

eval_GOOGL_1t_L4_U16_U16_U16_U16_B64_D03 <- model_GOOGL_t1_L4_U16_U16_U16_U16_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U16_U16_U8_B64_D03 <- model_GOOGL_t1_L4_U16_U16_U16_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U16_U8_U8_B64_D03 <- model_GOOGL_t1_L4_U16_U16_U8_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
eval_GOOGL_1t_L4_U16_U8_U8_U8_B64_D03 <- model_GOOGL_t1_L4_U16_U8_U8_U8_B64_D03 %>% evaluate(x_train_arr_GOOGL, y_train_arr_GOOGL)
```







# Sammenfatning af evaluering





### Sammenfatning opdelt 1 time-steps


```{r, warning=FALSE, results='hide'}
MSE_GOOGL_t1_L2_D02 <- data.frame(Model = c("GOOGL_t1_L2_U128_U128_B16_D02", "GOOGL_t1_L2_U128_U64_B16_D02", "GOOGL_t1_L2_U64_U64_B16_D02", "GOOGL_t1_L2_U64_U32_B16_D02", "GOOGL_t1_L2_U32_U32_B16_D02", "GOOGL_t1_L2_U32_U16_B16_D02", "GOOGL_t1_L2_U16_U16_B16_D02", "GOOGL_t1_L2_U16_U8_B16_D02", "GOOGL_t1_L2_U8_U8_B16_D02", "GOOGL_t1_L2_U128_U128_B32_D02", "GOOGL_t1_L2_U128_U64_B32_D02", "GOOGL_t1_L2_U64_U64_B32_D02", "GOOGL_t1_L2_U64_U32_B32_D02", "GOOGL_t1_L2_U32_U32_B32_D02", "GOOGL_t1_L2_U32_U16_B32_D02", "GOOGL_t1_L2_U16_U16_B32_D02", "GOOGL_t1_L2_U16_U8_B32_D02", "GOOGL_t1_L2_U8_U8_B32_D02", "GOOGL_t1_L2_U128_U128_B64_D02", "GOOGL_t1_L2_U128_U64_B64_D02", "GOOGL_t1_L2_U64_U64_B64_D02", "GOOGL_t1_L2_U64_U32_B64_D02", "GOOGL_t1_L2_U32_U32_B64_D02", "GOOGL_t1_L2_U32_U16_B64_D02", "GOOGL_t1_L2_U16_U16_B64_D02", "GOOGL_t1_L2_U16_U8_B64_D02", "GOOGL_t1_L2_U8_U8_B64_D02"), 
              MSE = c(eval_GOOGL_1t_L2_U128_U128_B16_D02[['mse']], eval_GOOGL_1t_L2_U128_U64_B16_D02[['mse']], eval_GOOGL_1t_L2_U64_U64_B16_D02[['mse']], eval_GOOGL_1t_L2_U64_U32_B16_D02[['mse']], eval_GOOGL_1t_L2_U32_U32_B16_D02[['mse']], eval_GOOGL_1t_L2_U32_U16_B16_D02[['mse']], eval_GOOGL_1t_L2_U16_U16_B16_D02[['mse']], eval_GOOGL_1t_L2_U16_U8_B16_D02[['mse']], eval_GOOGL_1t_L2_U8_U8_B16_D02[['mse']], eval_GOOGL_1t_L2_U128_U128_B32_D02[['mse']], eval_GOOGL_1t_L2_U128_U64_B32_D02[['mse']], eval_GOOGL_1t_L2_U64_U64_B32_D02[['mse']], eval_GOOGL_1t_L2_U64_U32_B32_D02[['mse']], eval_GOOGL_1t_L2_U32_U32_B32_D02[['mse']], eval_GOOGL_1t_L2_U32_U16_B32_D02[['mse']], eval_GOOGL_1t_L2_U16_U16_B32_D02[['mse']], eval_GOOGL_1t_L2_U16_U8_B32_D02[['mse']], eval_GOOGL_1t_L2_U8_U8_B32_D02[['mse']], eval_GOOGL_1t_L2_U128_U128_B64_D02[['mse']], eval_GOOGL_1t_L2_U128_U64_B64_D02[['mse']], eval_GOOGL_1t_L2_U64_U64_B64_D02[['mse']], eval_GOOGL_1t_L2_U64_U32_B64_D02[['mse']], eval_GOOGL_1t_L2_U32_U32_B64_D02[['mse']], eval_GOOGL_1t_L2_U32_U16_B64_D02[['mse']], eval_GOOGL_1t_L2_U16_U16_B64_D02[['mse']], eval_GOOGL_1t_L2_U16_U8_B64_D02[['mse']], eval_GOOGL_1t_L2_U8_U8_B64_D02[['mse']]
))
```



```{r, warning=FALSE, results='hide'}
MSE_GOOGL_t1_L2_D03 <- data.frame(Model = c("GOOGL_t1_L2_U128_U128_B16_D03", "GOOGL_t1_L2_U128_U64_B16_D03", "GOOGL_t1_L2_U64_U64_B16_D03", "GOOGL_t1_L2_U64_U32_B16_D03", "GOOGL_t1_L2_U32_U32_B16_D03", "GOOGL_t1_L2_U32_U16_B16_D03", "GOOGL_t1_L2_U16_U16_B16_D03", "GOOGL_t1_L2_U16_U8_B16_D03", "GOOGL_t1_L2_U8_U8_B16_D03", "GOOGL_t1_L2_U128_U128_B32_D03", "GOOGL_t1_L2_U128_U64_B32_D03", "GOOGL_t1_L2_U64_U64_B32_D03", "GOOGL_t1_L2_U64_U32_B32_D03", "GOOGL_t1_L2_U32_U32_B32_D03", "GOOGL_t1_L2_U32_U16_B32_D03", "GOOGL_t1_L2_U16_U16_B32_D03", "GOOGL_t1_L2_U16_U8_B32_D03", "GOOGL_t1_L2_U8_U8_B32_D03", "GOOGL_t1_L2_U128_U128_B64_D03", "GOOGL_t1_L2_U128_U64_B64_D03", "GOOGL_t1_L2_U64_U64_B64_D03", "GOOGL_t1_L2_U64_U32_B64_D03", "GOOGL_t1_L2_U32_U32_B64_D03", "GOOGL_t1_L2_U32_U16_B64_D03", "GOOGL_t1_L2_U16_U16_B64_D03", "GOOGL_t1_L2_U16_U8_B64_D03", "GOOGL_t1_L2_U8_U8_B64_D03"), 
              MSE = c(eval_GOOGL_1t_L2_U128_U128_B16_D03[['mse']], eval_GOOGL_1t_L2_U128_U64_B16_D03[['mse']], eval_GOOGL_1t_L2_U64_U64_B16_D03[['mse']], eval_GOOGL_1t_L2_U64_U32_B16_D03[['mse']], eval_GOOGL_1t_L2_U32_U32_B16_D03[['mse']], eval_GOOGL_1t_L2_U32_U16_B16_D03[['mse']], eval_GOOGL_1t_L2_U16_U16_B16_D03[['mse']], eval_GOOGL_1t_L2_U16_U8_B16_D03[['mse']], eval_GOOGL_1t_L2_U8_U8_B16_D03[['mse']], eval_GOOGL_1t_L2_U128_U128_B32_D03[['mse']], eval_GOOGL_1t_L2_U128_U64_B32_D03[['mse']], eval_GOOGL_1t_L2_U64_U64_B32_D03[['mse']], eval_GOOGL_1t_L2_U64_U32_B32_D03[['mse']], eval_GOOGL_1t_L2_U32_U32_B32_D03[['mse']], eval_GOOGL_1t_L2_U32_U16_B32_D03[['mse']], eval_GOOGL_1t_L2_U16_U16_B32_D03[['mse']], eval_GOOGL_1t_L2_U16_U8_B32_D03[['mse']], eval_GOOGL_1t_L2_U8_U8_B32_D03[['mse']], eval_GOOGL_1t_L2_U128_U128_B64_D03[['mse']], eval_GOOGL_1t_L2_U128_U64_B64_D03[['mse']], eval_GOOGL_1t_L2_U64_U64_B64_D03[['mse']], eval_GOOGL_1t_L2_U64_U32_B64_D03[['mse']], eval_GOOGL_1t_L2_U32_U32_B64_D03[['mse']], eval_GOOGL_1t_L2_U32_U16_B64_D03[['mse']], eval_GOOGL_1t_L2_U16_U16_B64_D03[['mse']], eval_GOOGL_1t_L2_U16_U8_B64_D03[['mse']], eval_GOOGL_1t_L2_U8_U8_B64_D03[['mse']]
))
```



```{r, warning=FALSE, results='hide'}
MSE_GOOGL_t1_L3_D02 <- data.frame(Model = c("GOOGL_t1_L3_U128_U128_U128_B16_D02", "GOOGL_t1_L3_U128_U128_U64_B16_D02", "GOOGL_t1_L3_U128_U64_U64_B16_D02", "GOOGL_t1_L3_U64_U64_U64_B16_D02", "GOOGL_t1_L3_U64_U64_U32_B16_D02", "GOOGL_t1_L3_U64_U32_U32_B16_D02", "GOOGL_t1_L3_U64_U32_U16_B16_D02", "GOOGL_t1_L3_U32_U32_U32_B16_D02", "GOOGL_t1_L3_U32_U32_U16_B16_D02", "GOOGL_t1_L3_U32_U16_U16_B16_D02", "GOOGL_t1_L3_U32_U16_U8_B16_D02", "GOOGL_t1_L3_U16_U16_U16_B16_D02", "GOOGL_t1_L3_U16_U16_U8_B16_D02", "GOOGL_t1_L3_U16_U8_U8_B16_D02", "GOOGL_t1_L3_U8_U8_U8_B16_D02",
                                        
                                        "GOOGL_t1_L3_U128_U128_U128_B32_D02", "GOOGL_t1_L3_U128_U128_U64_B32_D02", "GOOGL_t1_L3_U128_U64_U64_B32_D02", "GOOGL_t1_L3_U64_U64_U64_B32_D02", "GOOGL_t1_L3_U64_U64_U32_B32_D02", "GOOGL_t1_L3_U64_U32_U32_B32_D02", "GOOGL_t1_L3_U64_U32_U16_B32_D02", "GOOGL_t1_L3_U32_U32_U32_B32_D02", "GOOGL_t1_L3_U32_U32_U16_B32_D02", "GOOGL_t1_L3_U32_U16_U16_B32_D02", "GOOGL_t1_L3_U32_U16_U8_B32_D02", "GOOGL_t1_L3_U16_U16_U16_B32_D02", "GOOGL_t1_L3_U16_U16_U8_B32_D02", "GOOGL_t1_L3_U16_U8_U8_B32_D02", "GOOGL_t1_L3_U8_U8_U8_B32_D02",
                                        "GOOGL_t1_L3_U128_U128_U128_B64_D02", "GOOGL_t1_L3_U128_U128_U64_B64_D02", "GOOGL_t1_L3_U128_U64_U64_B64_D02", "GOOGL_t1_L3_U64_U64_U64_B64_D02", "GOOGL_t1_L3_U64_U64_U32_B64_D02", "GOOGL_t1_L3_U64_U32_U32_B64_D02", "GOOGL_t1_L3_U64_U32_U16_B64_D02", "GOOGL_t1_L3_U32_U32_U32_B64_D02", "GOOGL_t1_L3_U32_U32_U16_B64_D02", "GOOGL_t1_L3_U32_U16_U16_B64_D02", "GOOGL_t1_L3_U32_U16_U8_B64_D02", "GOOGL_t1_L3_U16_U16_U16_B64_D02", "GOOGL_t1_L3_U16_U16_U8_B64_D02", "GOOGL_t1_L3_U16_U8_U8_B64_D02", "GOOGL_t1_L3_U8_U8_U8_B64_D02"), 
              MSE = c(eval_GOOGL_1t_L3_U128_U128_U128_B16_D02[['mse']], eval_GOOGL_1t_L3_U128_U128_U64_B16_D02[['mse']], eval_GOOGL_1t_L3_U128_U64_U64_B16_D02[['mse']], eval_GOOGL_1t_L3_U64_U64_U64_B16_D02[['mse']], eval_GOOGL_1t_L3_U64_U64_U32_B16_D02[['mse']], eval_GOOGL_1t_L3_U64_U32_U32_B16_D02[['mse']], eval_GOOGL_1t_L3_U64_U32_U16_B16_D02[['mse']], eval_GOOGL_1t_L3_U32_U32_U32_B16_D02[['mse']], eval_GOOGL_1t_L3_U32_U32_U16_B16_D02[['mse']], eval_GOOGL_1t_L3_U32_U16_U16_B16_D02[['mse']], eval_GOOGL_1t_L3_U32_U16_U8_B16_D02[['mse']], eval_GOOGL_1t_L3_U16_U16_U16_B16_D02[['mse']], eval_GOOGL_1t_L3_U16_U16_U8_B16_D02[['mse']], eval_GOOGL_1t_L3_U16_U8_U8_B16_D02[['mse']], eval_GOOGL_1t_L3_U8_U8_U8_B16_D02[['mse']] ,
                      eval_GOOGL_1t_L3_U128_U128_U128_B32_D02[['mse']], eval_GOOGL_1t_L3_U128_U128_U64_B32_D02[['mse']], eval_GOOGL_1t_L3_U128_U64_U64_B32_D02[['mse']], eval_GOOGL_1t_L3_U64_U64_U64_B32_D02[['mse']], eval_GOOGL_1t_L3_U64_U64_U32_B32_D02[['mse']], eval_GOOGL_1t_L3_U64_U32_U32_B32_D02[['mse']], eval_GOOGL_1t_L3_U64_U32_U16_B32_D02[['mse']], eval_GOOGL_1t_L3_U32_U32_U32_B32_D02[['mse']], eval_GOOGL_1t_L3_U32_U32_U16_B32_D02[['mse']], eval_GOOGL_1t_L3_U32_U16_U16_B32_D02[['mse']], eval_GOOGL_1t_L3_U32_U16_U8_B32_D02[['mse']], eval_GOOGL_1t_L3_U16_U16_U16_B32_D02[['mse']], eval_GOOGL_1t_L3_U16_U16_U8_B32_D02[['mse']], eval_GOOGL_1t_L3_U16_U8_U8_B32_D02[['mse']], eval_GOOGL_1t_L3_U8_U8_U8_B32_D02[['mse']] ,
                      eval_GOOGL_1t_L3_U128_U128_U128_B64_D02[['mse']], eval_GOOGL_1t_L3_U128_U128_U64_B64_D02[['mse']], eval_GOOGL_1t_L3_U128_U64_U64_B64_D02[['mse']], eval_GOOGL_1t_L3_U64_U64_U64_B64_D02[['mse']], eval_GOOGL_1t_L3_U64_U64_U32_B64_D02[['mse']], eval_GOOGL_1t_L3_U64_U32_U32_B64_D02[['mse']], eval_GOOGL_1t_L3_U64_U32_U16_B64_D02[['mse']], eval_GOOGL_1t_L3_U32_U32_U32_B64_D02[['mse']], eval_GOOGL_1t_L3_U32_U32_U16_B64_D02[['mse']], eval_GOOGL_1t_L3_U32_U16_U16_B64_D02[['mse']], eval_GOOGL_1t_L3_U32_U16_U8_B64_D02[['mse']], eval_GOOGL_1t_L3_U16_U16_U16_B64_D02[['mse']], eval_GOOGL_1t_L3_U16_U16_U8_B64_D02[['mse']], eval_GOOGL_1t_L3_U16_U8_U8_B64_D02[['mse']], eval_GOOGL_1t_L3_U8_U8_U8_B64_D02[['mse']] 
))
```




```{r, warning=FALSE, results='hide'}
MSE_GOOGL_t1_L3_D03 <- data.frame(Model = c("GOOGL_t1_L3_U128_U128_U128_B16_D03", "GOOGL_t1_L3_U128_U128_U64_B16_D03", "GOOGL_t1_L3_U128_U64_U64_B16_D03", "GOOGL_t1_L3_U64_U64_U64_B16_D03", "GOOGL_t1_L3_U64_U64_U32_B16_D03", "GOOGL_t1_L3_U64_U32_U32_B16_D03", "GOOGL_t1_L3_U64_U32_U16_B16_D03", "GOOGL_t1_L3_U32_U32_U32_B16_D03", "GOOGL_t1_L3_U32_U32_U16_B16_D03", "GOOGL_t1_L3_U32_U16_U16_B16_D03", "GOOGL_t1_L3_U32_U16_U8_B16_D03", "GOOGL_t1_L3_U16_U16_U16_B16_D03", "GOOGL_t1_L3_U16_U16_U8_B16_D03", "GOOGL_t1_L3_U16_U8_U8_B16_D03", "GOOGL_t1_L3_U8_U8_U8_B16_D03",
                                        
                                        "GOOGL_t1_L3_U128_U128_U128_B32_D03", "GOOGL_t1_L3_U128_U128_U64_B32_D03", "GOOGL_t1_L3_U128_U64_U64_B32_D03", "GOOGL_t1_L3_U64_U64_U64_B32_D03", "GOOGL_t1_L3_U64_U64_U32_B32_D03", "GOOGL_t1_L3_U64_U32_U32_B32_D03", "GOOGL_t1_L3_U64_U32_U16_B32_D03", "GOOGL_t1_L3_U32_U32_U32_B32_D03", "GOOGL_t1_L3_U32_U32_U16_B32_D03", "GOOGL_t1_L3_U32_U16_U16_B32_D03", "GOOGL_t1_L3_U32_U16_U8_B32_D03", "GOOGL_t1_L3_U16_U16_U16_B32_D03", "GOOGL_t1_L3_U16_U16_U8_B32_D03", "GOOGL_t1_L3_U16_U8_U8_B32_D03", "GOOGL_t1_L3_U8_U8_U8_B32_D03",
                                        "GOOGL_t1_L3_U128_U128_U128_B64_D03", "GOOGL_t1_L3_U128_U128_U64_B64_D03", "GOOGL_t1_L3_U128_U64_U64_B64_D03", "GOOGL_t1_L3_U64_U64_U64_B64_D03", "GOOGL_t1_L3_U64_U64_U32_B64_D03", "GOOGL_t1_L3_U64_U32_U32_B64_D03", "GOOGL_t1_L3_U64_U32_U16_B64_D03", "GOOGL_t1_L3_U32_U32_U32_B64_D03", "GOOGL_t1_L3_U32_U32_U16_B64_D03", "GOOGL_t1_L3_U32_U16_U16_B64_D03", "GOOGL_t1_L3_U32_U16_U8_B64_D03", "GOOGL_t1_L3_U16_U16_U16_B64_D03", "GOOGL_t1_L3_U16_U16_U8_B64_D03", "GOOGL_t1_L3_U16_U8_U8_B64_D03", "GOOGL_t1_L3_U8_U8_U8_B64_D03"), 
              MSE = c(eval_GOOGL_1t_L3_U128_U128_U128_B16_D03[['mse']], eval_GOOGL_1t_L3_U128_U128_U64_B16_D03[['mse']], eval_GOOGL_1t_L3_U128_U64_U64_B16_D03[['mse']], eval_GOOGL_1t_L3_U64_U64_U64_B16_D03[['mse']], eval_GOOGL_1t_L3_U64_U64_U32_B16_D03[['mse']], eval_GOOGL_1t_L3_U64_U32_U32_B16_D03[['mse']], eval_GOOGL_1t_L3_U64_U32_U16_B16_D03[['mse']], eval_GOOGL_1t_L3_U32_U32_U32_B16_D03[['mse']], eval_GOOGL_1t_L3_U32_U32_U16_B16_D03[['mse']], eval_GOOGL_1t_L3_U32_U16_U16_B16_D03[['mse']], eval_GOOGL_1t_L3_U32_U16_U8_B16_D03[['mse']], eval_GOOGL_1t_L3_U16_U16_U16_B16_D03[['mse']], eval_GOOGL_1t_L3_U16_U16_U8_B16_D03[['mse']], eval_GOOGL_1t_L3_U16_U8_U8_B16_D03[['mse']], eval_GOOGL_1t_L3_U8_U8_U8_B16_D03[['mse']] ,
                      eval_GOOGL_1t_L3_U128_U128_U128_B32_D03[['mse']], eval_GOOGL_1t_L3_U128_U128_U64_B32_D03[['mse']], eval_GOOGL_1t_L3_U128_U64_U64_B32_D03[['mse']], eval_GOOGL_1t_L3_U64_U64_U64_B32_D03[['mse']], eval_GOOGL_1t_L3_U64_U64_U32_B32_D03[['mse']], eval_GOOGL_1t_L3_U64_U32_U32_B32_D03[['mse']], eval_GOOGL_1t_L3_U64_U32_U16_B32_D03[['mse']], eval_GOOGL_1t_L3_U32_U32_U32_B32_D03[['mse']], eval_GOOGL_1t_L3_U32_U32_U16_B32_D03[['mse']], eval_GOOGL_1t_L3_U32_U16_U16_B32_D03[['mse']], eval_GOOGL_1t_L3_U32_U16_U8_B32_D03[['mse']], eval_GOOGL_1t_L3_U16_U16_U16_B32_D03[['mse']], eval_GOOGL_1t_L3_U16_U16_U8_B32_D03[['mse']], eval_GOOGL_1t_L3_U16_U8_U8_B32_D03[['mse']], eval_GOOGL_1t_L3_U8_U8_U8_B32_D03[['mse']] ,
                      eval_GOOGL_1t_L3_U128_U128_U128_B64_D03[['mse']], eval_GOOGL_1t_L3_U128_U128_U64_B64_D03[['mse']], eval_GOOGL_1t_L3_U128_U64_U64_B64_D03[['mse']], eval_GOOGL_1t_L3_U64_U64_U64_B64_D03[['mse']], eval_GOOGL_1t_L3_U64_U64_U32_B64_D03[['mse']], eval_GOOGL_1t_L3_U64_U32_U32_B64_D03[['mse']], eval_GOOGL_1t_L3_U64_U32_U16_B64_D03[['mse']], eval_GOOGL_1t_L3_U32_U32_U32_B64_D03[['mse']], eval_GOOGL_1t_L3_U32_U32_U16_B64_D03[['mse']], eval_GOOGL_1t_L3_U32_U16_U16_B64_D03[['mse']], eval_GOOGL_1t_L3_U32_U16_U8_B64_D03[['mse']], eval_GOOGL_1t_L3_U16_U16_U16_B64_D03[['mse']], eval_GOOGL_1t_L3_U16_U16_U8_B64_D03[['mse']], eval_GOOGL_1t_L3_U16_U8_U8_B64_D03[['mse']], eval_GOOGL_1t_L3_U8_U8_U8_B64_D03[['mse']] 
))
```





```{r, warning=FALSE, results='hide'}
MSE_GOOGL_t1_L4_D02 <- data.frame(Model = c("GOOGL_1t_L4_U128_U128_U128_U128_B16_D02", "GOOGL_1t_L4_U128_U128_U128_U64_B16_D02",  "GOOGL_1t_L4_U128_U128_U64_U64_B16_D02",  "GOOGL_1t_L4_U128_U64_U64_U64_B16_D02", "GOOGL_1t_L4_U128_U64_U64_U32_B16_D02","GOOGL_1t_L4_U64_U64_U64_U64_B16_D02",  "GOOGL_1t_L4_U64_U64_U64_U32_B16_D02",  "GOOGL_1t_L4_U64_U64_U32_U32_B16_D02", "GOOGL_1t_L4_U64_U32_U32_U32_B16_D02", "GOOGL_1t_L4_U64_U32_U32_U16_B16_D02", "GOOGL_1t_L4_U32_U32_U32_U32_B16_D02", "GOOGL_1t_L4_U32_U32_U32_U16_B16_D02",  "GOOGL_1t_L4_U32_U32_U16_U16_B16_D02", "GOOGL_1t_L4_U32_U16_U16_U16_B16_D02", "GOOGL_1t_L4_U32_U16_U16_U8_B16_D02", "GOOGL_1t_L4_U16_U16_U16_U16_B16_D02", "GOOGL_1t_L4_U16_U16_U16_U8_B16_D02",  "GOOGL_1t_L4_U16_U16_U8_U8_B16_D02", "GOOGL_1t_L4_U16_U8_U8_U8_B16_D02", 
                                        "GOOGL_1t_L4_U128_U128_U128_U128_B32_D02", "GOOGL_1t_L4_U128_U128_U128_U64_B32_D02",  "GOOGL_1t_L4_U128_U128_U64_U64_B32_D02",  "GOOGL_1t_L4_U128_U64_U64_U64_B32_D02", "GOOGL_1t_L4_U128_U64_U64_U32_B32_D02","GOOGL_1t_L4_U64_U64_U64_U64_B32_D02",  "GOOGL_1t_L4_U64_U64_U64_U32_B32_D02",  "GOOGL_1t_L4_U64_U64_U32_U32_B32_D02", "GOOGL_1t_L4_U64_U32_U32_U32_B32_D02", "GOOGL_1t_L4_U64_U32_U32_U16_B32_D02", "GOOGL_1t_L4_U32_U32_U32_U32_B32_D02", "GOOGL_1t_L4_U32_U32_U32_U16_B32_D02",  "GOOGL_1t_L4_U32_U32_U16_U16_B32_D02", "GOOGL_1t_L4_U32_U16_U16_U16_B32_D02", "GOOGL_1t_L4_U32_U16_U16_U8_B32_D02", "GOOGL_1t_L4_U16_U16_U16_U16_B32_D02", "GOOGL_1t_L4_U16_U16_U16_U8_B32_D02",  "GOOGL_1t_L4_U16_U16_U8_U8_B32_D02", "GOOGL_1t_L4_U16_U8_U8_U8_B32_D02",
                                        "GOOGL_1t_L4_U128_U128_U128_U128_B64_D02", "GOOGL_1t_L4_U128_U128_U128_U64_B64_D02",  "GOOGL_1t_L4_U128_U128_U64_U64_B64_D02",  "GOOGL_1t_L4_U128_U64_U64_U64_B64_D02", "GOOGL_1t_L4_U128_U64_U64_U32_B64_D02","GOOGL_1t_L4_U64_U64_U64_U64_B64_D02",  "GOOGL_1t_L4_U64_U64_U64_U32_B64_D02",  "GOOGL_1t_L4_U64_U64_U32_U32_B64_D02", "GOOGL_1t_L4_U64_U32_U32_U32_B64_D02", "GOOGL_1t_L4_U64_U32_U32_U16_B64_D02", "GOOGL_1t_L4_U32_U32_U32_U32_B64_D02", "GOOGL_1t_L4_U32_U32_U32_U16_B64_D02",  "GOOGL_1t_L4_U32_U32_U16_U16_B64_D02", "GOOGL_1t_L4_U32_U16_U16_U16_B64_D02", "GOOGL_1t_L4_U32_U16_U16_U8_B64_D02", "GOOGL_1t_L4_U16_U16_U16_U16_B64_D02", "GOOGL_1t_L4_U16_U16_U16_U8_B64_D02",  "GOOGL_1t_L4_U16_U16_U8_U8_B64_D02", "GOOGL_1t_L4_U16_U8_U8_U8_B64_D02"), 
              MSE = c(eval_GOOGL_1t_L4_U128_U128_U128_U128_B16_D02[['mse']], eval_GOOGL_1t_L4_U128_U128_U128_U64_B16_D02[['mse']],  eval_GOOGL_1t_L4_U128_U128_U64_U64_B16_D02[['mse']],  eval_GOOGL_1t_L4_U128_U64_U64_U64_B16_D02[['mse']], eval_GOOGL_1t_L4_U128_U64_U64_U32_B16_D02[['mse']],eval_GOOGL_1t_L4_U64_U64_U64_U64_B16_D02[['mse']],  eval_GOOGL_1t_L4_U64_U64_U64_U32_B16_D02[['mse']],  eval_GOOGL_1t_L4_U64_U64_U32_U32_B16_D02[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U32_B16_D02[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U16_B16_D02[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U32_B16_D02[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U16_B16_D02[['mse']],  eval_GOOGL_1t_L4_U32_U32_U16_U16_B16_D02[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U16_B16_D02[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U8_B16_D02[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U16_B16_D02[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U8_B16_D02[['mse']],  eval_GOOGL_1t_L4_U16_U16_U8_U8_B16_D02[['mse']], eval_GOOGL_1t_L4_U16_U8_U8_U8_B16_D02[['mse']],
                      eval_GOOGL_1t_L4_U128_U128_U128_U128_B32_D02[['mse']], eval_GOOGL_1t_L4_U128_U128_U128_U64_B32_D02[['mse']],  eval_GOOGL_1t_L4_U128_U128_U64_U64_B32_D02[['mse']],  eval_GOOGL_1t_L4_U128_U64_U64_U64_B32_D02[['mse']], eval_GOOGL_1t_L4_U128_U64_U64_U32_B32_D02[['mse']],eval_GOOGL_1t_L4_U64_U64_U64_U64_B32_D02[['mse']],  eval_GOOGL_1t_L4_U64_U64_U64_U32_B32_D02[['mse']],  eval_GOOGL_1t_L4_U64_U64_U32_U32_B32_D02[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U32_B32_D02[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U16_B32_D02[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U32_B32_D02[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U16_B32_D02[['mse']],  eval_GOOGL_1t_L4_U32_U32_U16_U16_B32_D02[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U16_B32_D02[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U8_B32_D02[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U16_B32_D02[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U8_B32_D02[['mse']],  eval_GOOGL_1t_L4_U16_U16_U8_U8_B32_D02[['mse']], eval_GOOGL_1t_L4_U16_U8_U8_U8_B32_D02[['mse']],
                      eval_GOOGL_1t_L4_U128_U128_U128_U128_B64_D02[['mse']], eval_GOOGL_1t_L4_U128_U128_U128_U64_B64_D02[['mse']],  eval_GOOGL_1t_L4_U128_U128_U64_U64_B64_D02[['mse']],  eval_GOOGL_1t_L4_U128_U64_U64_U64_B64_D02[['mse']], eval_GOOGL_1t_L4_U128_U64_U64_U32_B64_D02[['mse']],eval_GOOGL_1t_L4_U64_U64_U64_U64_B64_D02[['mse']],  eval_GOOGL_1t_L4_U64_U64_U64_U32_B64_D02[['mse']],  eval_GOOGL_1t_L4_U64_U64_U32_U32_B64_D02[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U32_B64_D02[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U16_B64_D02[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U32_B64_D02[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U16_B64_D02[['mse']],  eval_GOOGL_1t_L4_U32_U32_U16_U16_B64_D02[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U16_B64_D02[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U8_B64_D02[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U16_B64_D02[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U8_B64_D02[['mse']],  eval_GOOGL_1t_L4_U16_U16_U8_U8_B64_D02[['mse']], eval_GOOGL_1t_L4_U16_U8_U8_U8_B64_D02[['mse']]
                                       
))
```


```{r, warning=FALSE, results='hide'}
MSE_GOOGL_t1_L4_D032 <- data.frame(Model = c("GOOGL_1t_L4_U128_U128_U128_U128_B16_D03", "GOOGL_1t_L4_U128_U128_U128_U64_B16_D03",  "GOOGL_1t_L4_U128_U128_U64_U64_B16_D03",  "GOOGL_1t_L4_U128_U64_U64_U64_B16_D03", "GOOGL_1t_L4_U128_U64_U64_U32_B16_D03","GOOGL_1t_L4_U64_U64_U64_U64_B16_D03",  "GOOGL_1t_L4_U64_U64_U64_U32_B16_D03",  "GOOGL_1t_L4_U64_U64_U32_U32_B16_D03", "GOOGL_1t_L4_U64_U32_U32_U32_B16_D03", "GOOGL_1t_L4_U64_U32_U32_U16_B16_D03", "GOOGL_1t_L4_U32_U32_U32_U32_B16_D03", "GOOGL_1t_L4_U32_U32_U32_U16_B16_D03",  "GOOGL_1t_L4_U32_U32_U16_U16_B16_D03", "GOOGL_1t_L4_U32_U16_U16_U16_B16_D03", "GOOGL_1t_L4_U32_U16_U16_U8_B16_D03", "GOOGL_1t_L4_U16_U16_U16_U16_B16_D03", "GOOGL_1t_L4_U16_U16_U16_U8_B16_D03",  "GOOGL_1t_L4_U16_U16_U8_U8_B16_D03", "GOOGL_1t_L4_U16_U8_U8_U8_B16_D03", 
                                        "GOOGL_1t_L4_U128_U128_U128_U128_B32_D03", "GOOGL_1t_L4_U128_U128_U128_U64_B32_D03",  "GOOGL_1t_L4_U128_U128_U64_U64_B32_D03",  "GOOGL_1t_L4_U128_U64_U64_U64_B32_D03", "GOOGL_1t_L4_U128_U64_U64_U32_B32_D03","GOOGL_1t_L4_U64_U64_U64_U64_B32_D03",  "GOOGL_1t_L4_U64_U64_U64_U32_B32_D03",  "GOOGL_1t_L4_U64_U64_U32_U32_B32_D03", "GOOGL_1t_L4_U64_U32_U32_U32_B32_D03", "GOOGL_1t_L4_U64_U32_U32_U16_B32_D03", "GOOGL_1t_L4_U32_U32_U32_U32_B32_D03", "GOOGL_1t_L4_U32_U32_U32_U16_B32_D03",  "GOOGL_1t_L4_U32_U32_U16_U16_B32_D03", "GOOGL_1t_L4_U32_U16_U16_U16_B32_D03", "GOOGL_1t_L4_U32_U16_U16_U8_B32_D03", "GOOGL_1t_L4_U16_U16_U16_U16_B32_D03", "GOOGL_1t_L4_U16_U16_U16_U8_B32_D03",  "GOOGL_1t_L4_U16_U16_U8_U8_B32_D03", "GOOGL_1t_L4_U16_U8_U8_U8_B32_D03",
                                        "GOOGL_1t_L4_U128_U128_U128_U128_B64_D03", "GOOGL_1t_L4_U128_U128_U128_U64_B64_D03",  "GOOGL_1t_L4_U128_U128_U64_U64_B64_D03",  "GOOGL_1t_L4_U128_U64_U64_U64_B64_D03", "GOOGL_1t_L4_U128_U64_U64_U32_B64_D03","GOOGL_1t_L4_U64_U64_U64_U64_B64_D03",  "GOOGL_1t_L4_U64_U64_U64_U32_B64_D03",  "GOOGL_1t_L4_U64_U64_U32_U32_B64_D03", "GOOGL_1t_L4_U64_U32_U32_U32_B64_D03", "GOOGL_1t_L4_U64_U32_U32_U16_B64_D03", "GOOGL_1t_L4_U32_U32_U32_U32_B64_D03", "GOOGL_1t_L4_U32_U32_U32_U16_B64_D03",  "GOOGL_1t_L4_U32_U32_U16_U16_B64_D03", "GOOGL_1t_L4_U32_U16_U16_U16_B64_D03", "GOOGL_1t_L4_U32_U16_U16_U8_B64_D03", "GOOGL_1t_L4_U16_U16_U16_U16_B64_D03", "GOOGL_1t_L4_U16_U16_U16_U8_B64_D03",  "GOOGL_1t_L4_U16_U16_U8_U8_B64_D03", "GOOGL_1t_L4_U16_U8_U8_U8_B64_D03"), 
              MSE = c(eval_GOOGL_1t_L4_U128_U128_U128_U128_B16_D03[['mse']], eval_GOOGL_1t_L4_U128_U128_U128_U64_B16_D03[['mse']],  eval_GOOGL_1t_L4_U128_U128_U64_U64_B16_D03[['mse']],  eval_GOOGL_1t_L4_U128_U64_U64_U64_B16_D03[['mse']], eval_GOOGL_1t_L4_U128_U64_U64_U32_B16_D03[['mse']],eval_GOOGL_1t_L4_U64_U64_U64_U64_B16_D03[['mse']],  eval_GOOGL_1t_L4_U64_U64_U64_U32_B16_D03[['mse']],  eval_GOOGL_1t_L4_U64_U64_U32_U32_B16_D03[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U32_B16_D03[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U16_B16_D03[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U32_B16_D03[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U16_B16_D03[['mse']],  eval_GOOGL_1t_L4_U32_U32_U16_U16_B16_D03[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U16_B16_D03[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U8_B16_D03[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U16_B16_D03[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U8_B16_D03[['mse']],  eval_GOOGL_1t_L4_U16_U16_U8_U8_B16_D03[['mse']], eval_GOOGL_1t_L4_U16_U8_U8_U8_B16_D03[['mse']],
                      eval_GOOGL_1t_L4_U128_U128_U128_U128_B32_D03[['mse']], eval_GOOGL_1t_L4_U128_U128_U128_U64_B32_D03[['mse']],  eval_GOOGL_1t_L4_U128_U128_U64_U64_B32_D03[['mse']],  eval_GOOGL_1t_L4_U128_U64_U64_U64_B32_D03[['mse']], eval_GOOGL_1t_L4_U128_U64_U64_U32_B32_D03[['mse']],eval_GOOGL_1t_L4_U64_U64_U64_U64_B32_D03[['mse']],  eval_GOOGL_1t_L4_U64_U64_U64_U32_B32_D03[['mse']],  eval_GOOGL_1t_L4_U64_U64_U32_U32_B32_D03[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U32_B32_D03[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U16_B32_D03[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U32_B32_D03[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U16_B32_D03[['mse']],  eval_GOOGL_1t_L4_U32_U32_U16_U16_B32_D03[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U16_B32_D03[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U8_B32_D03[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U16_B32_D03[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U8_B32_D03[['mse']],  eval_GOOGL_1t_L4_U16_U16_U8_U8_B32_D03[['mse']], eval_GOOGL_1t_L4_U16_U8_U8_U8_B32_D03[['mse']],
                      eval_GOOGL_1t_L4_U128_U128_U128_U128_B64_D03[['mse']], eval_GOOGL_1t_L4_U128_U128_U128_U64_B64_D03[['mse']],  eval_GOOGL_1t_L4_U128_U128_U64_U64_B64_D03[['mse']],  eval_GOOGL_1t_L4_U128_U64_U64_U64_B64_D03[['mse']], eval_GOOGL_1t_L4_U128_U64_U64_U32_B64_D03[['mse']],eval_GOOGL_1t_L4_U64_U64_U64_U64_B64_D03[['mse']],  eval_GOOGL_1t_L4_U64_U64_U64_U32_B64_D03[['mse']],  eval_GOOGL_1t_L4_U64_U64_U32_U32_B64_D03[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U32_B64_D03[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U16_B64_D03[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U32_B64_D03[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U16_B64_D03[['mse']],  eval_GOOGL_1t_L4_U32_U32_U16_U16_B64_D03[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U16_B64_D03[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U8_B64_D03[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U16_B64_D03[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U8_B64_D03[['mse']],  eval_GOOGL_1t_L4_U16_U16_U8_U8_B64_D03[['mse']], eval_GOOGL_1t_L4_U16_U8_U8_U8_B64_D03[['mse']]
))
```

```{r, warning=FALSE, results='hide'}
MSE_GOOGL_t1_L4_D03 <- data.frame(Model = c("GOOGL_1t_L4_U128_U128_U128_U128_B16_D03", "GOOGL_1t_L4_U128_U128_U128_U64_B16_D03",  "GOOGL_1t_L4_U128_U128_U64_U64_B16_D03",  "GOOGL_1t_L4_U128_U64_U64_U64_B16_D03", "GOOGL_1t_L4_U128_U64_U64_U32_B16_D03","GOOGL_1t_L4_U64_U64_U64_U64_B16_D03",  "GOOGL_1t_L4_U64_U64_U64_U32_B16_D03",  "GOOGL_1t_L4_U64_U64_U32_U32_B16_D03", "GOOGL_1t_L4_U64_U32_U32_U32_B16_D03", "GOOGL_1t_L4_U64_U32_U32_U16_B16_D03", "GOOGL_1t_L4_U32_U32_U32_U32_B16_D03", "GOOGL_1t_L4_U32_U32_U32_U16_B16_D03",  "GOOGL_1t_L4_U32_U32_U16_U16_B16_D03", "GOOGL_1t_L4_U32_U16_U16_U16_B16_D03", "GOOGL_1t_L4_U32_U16_U16_U8_B16_D03", "GOOGL_1t_L4_U16_U16_U16_U16_B16_D03", "GOOGL_1t_L4_U16_U16_U16_U8_B16_D03",  "GOOGL_1t_L4_U16_U16_U8_U8_B16_D03", "GOOGL_1t_L4_U16_U8_U8_U8_B16_D03", 
                                        "GOOGL_1t_L4_U128_U128_U128_U128_B32_D03", "GOOGL_1t_L4_U128_U128_U128_U64_B32_D03",  "GOOGL_1t_L4_U128_U128_U64_U64_B32_D03",  "GOOGL_1t_L4_U128_U64_U64_U64_B32_D03", "GOOGL_1t_L4_U128_U64_U64_U32_B32_D03","GOOGL_1t_L4_U64_U64_U64_U64_B32_D03",  "GOOGL_1t_L4_U64_U64_U64_U32_B32_D03",  "GOOGL_1t_L4_U64_U64_U32_U32_B32_D03", "GOOGL_1t_L4_U64_U32_U32_U32_B32_D03", "GOOGL_1t_L4_U64_U32_U32_U16_B32_D03", "GOOGL_1t_L4_U32_U32_U32_U32_B32_D03", "GOOGL_1t_L4_U32_U32_U32_U16_B32_D03",  "GOOGL_1t_L4_U32_U32_U16_U16_B32_D03", "GOOGL_1t_L4_U32_U16_U16_U16_B32_D03", "GOOGL_1t_L4_U32_U16_U16_U8_B32_D03", "GOOGL_1t_L4_U16_U16_U16_U16_B32_D03", "GOOGL_1t_L4_U16_U16_U16_U8_B32_D03",  "GOOGL_1t_L4_U16_U16_U8_U8_B32_D03", "GOOGL_1t_L4_U16_U8_U8_U8_B32_D03",
                                        "GOOGL_1t_L4_U128_U128_U128_U128_B64_D03", "GOOGL_1t_L4_U128_U128_U128_U64_B64_D03",  "GOOGL_1t_L4_U128_U128_U64_U64_B64_D03",  "GOOGL_1t_L4_U128_U64_U64_U64_B64_D03", "GOOGL_1t_L4_U128_U64_U64_U32_B64_D03","GOOGL_1t_L4_U64_U64_U64_U64_B64_D03",  "GOOGL_1t_L4_U64_U64_U64_U32_B64_D03",  "GOOGL_1t_L4_U64_U64_U32_U32_B64_D03", "GOOGL_1t_L4_U64_U32_U32_U32_B64_D03", "GOOGL_1t_L4_U64_U32_U32_U16_B64_D03", "GOOGL_1t_L4_U32_U32_U32_U32_B64_D03", "GOOGL_1t_L4_U32_U32_U32_U16_B64_D03",  "GOOGL_1t_L4_U32_U32_U16_U16_B64_D03", "GOOGL_1t_L4_U32_U16_U16_U16_B64_D03", "GOOGL_1t_L4_U32_U16_U16_U8_B64_D03", "GOOGL_1t_L4_U16_U16_U16_U16_B64_D03", "GOOGL_1t_L4_U16_U16_U16_U8_B64_D03",  "GOOGL_1t_L4_U16_U16_U8_U8_B64_D03", "GOOGL_1t_L4_U16_U8_U8_U8_B64_D03"), 
              MSE = c(eval_GOOGL_1t_L4_U128_U128_U128_U128_B16_D03[['mse']], eval_GOOGL_1t_L4_U128_U128_U128_U64_B16_D03[['mse']],  eval_GOOGL_1t_L4_U128_U128_U64_U64_B16_D03[['mse']],  eval_GOOGL_1t_L4_U128_U64_U64_U64_B16_D03[['mse']], eval_GOOGL_1t_L4_U128_U64_U64_U32_B16_D03[['mse']],eval_GOOGL_1t_L4_U64_U64_U64_U64_B16_D03[['mse']],  eval_GOOGL_1t_L4_U64_U64_U64_U32_B16_D03[['mse']],  eval_GOOGL_1t_L4_U64_U64_U32_U32_B16_D03[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U32_B16_D03[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U16_B16_D03[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U32_B16_D03[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U16_B16_D03[['mse']],  eval_GOOGL_1t_L4_U32_U32_U16_U16_B16_D03[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U16_B16_D03[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U8_B16_D03[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U16_B16_D03[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U8_B16_D03[['mse']],  eval_GOOGL_1t_L4_U16_U16_U8_U8_B16_D03[['mse']], eval_GOOGL_1t_L4_U16_U8_U8_U8_B16_D03[['mse']],
                      eval_GOOGL_1t_L4_U128_U128_U128_U128_B32_D03[['mse']], eval_GOOGL_1t_L4_U128_U128_U128_U64_B32_D03[['mse']],  eval_GOOGL_1t_L4_U128_U128_U64_U64_B32_D03[['mse']],  eval_GOOGL_1t_L4_U128_U64_U64_U64_B32_D03[['mse']], eval_GOOGL_1t_L4_U128_U64_U64_U32_B32_D03[['mse']],eval_GOOGL_1t_L4_U64_U64_U64_U64_B32_D03[['mse']],  eval_GOOGL_1t_L4_U64_U64_U64_U32_B32_D03[['mse']],  eval_GOOGL_1t_L4_U64_U64_U32_U32_B32_D03[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U32_B32_D03[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U16_B32_D03[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U32_B32_D03[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U16_B32_D03[['mse']],  eval_GOOGL_1t_L4_U32_U32_U16_U16_B32_D03[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U16_B32_D03[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U8_B32_D03[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U16_B32_D03[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U8_B32_D03[['mse']],  eval_GOOGL_1t_L4_U16_U16_U8_U8_B32_D03[['mse']], eval_GOOGL_1t_L4_U16_U8_U8_U8_B32_D03[['mse']],
                      eval_GOOGL_1t_L4_U128_U128_U128_U128_B64_D03[['mse']], eval_GOOGL_1t_L4_U128_U128_U128_U64_B64_D03[['mse']],  eval_GOOGL_1t_L4_U128_U128_U64_U64_B64_D03[['mse']],  eval_GOOGL_1t_L4_U128_U64_U64_U64_B64_D03[['mse']], eval_GOOGL_1t_L4_U128_U64_U64_U32_B64_D03[['mse']],eval_GOOGL_1t_L4_U64_U64_U64_U64_B64_D03[['mse']],  eval_GOOGL_1t_L4_U64_U64_U64_U32_B64_D03[['mse']],  eval_GOOGL_1t_L4_U64_U64_U32_U32_B64_D03[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U32_B64_D03[['mse']], eval_GOOGL_1t_L4_U64_U32_U32_U16_B64_D03[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U32_B64_D03[['mse']], eval_GOOGL_1t_L4_U32_U32_U32_U16_B64_D03[['mse']],  eval_GOOGL_1t_L4_U32_U32_U16_U16_B64_D03[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U16_B64_D03[['mse']], eval_GOOGL_1t_L4_U32_U16_U16_U8_B64_D03[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U16_B64_D03[['mse']], eval_GOOGL_1t_L4_U16_U16_U16_U8_B64_D03[['mse']],  eval_GOOGL_1t_L4_U16_U16_U8_U8_B64_D03[['mse']], eval_GOOGL_1t_L4_U16_U8_U8_U8_B64_D03[['mse']]
))
```



## Sammenfatning opdelt 10 time-steps

```{r, warning=FALSE, results='hide'}
MSE_GOOGL_t10_L2_D02 <- data.frame(Model = c("GOOGL_t10_L2_U128_U128_B16_D02", "GOOGL_t10_L2_U128_U64_B16_D02", "GOOGL_t10_L2_U64_U64_B16_D02", "GOOGL_t10_L2_U64_U32_B16_D02", "GOOGL_t10_L2_U32_U32_B16_D02", "GOOGL_t10_L2_U32_U16_B16_D02", "GOOGL_t10_L2_U16_U16_B16_D02", "GOOGL_t10_L2_U16_U8_B16_D02", "GOOGL_t10_L2_U8_U8_B16_D02", "GOOGL_t10_L2_U128_U128_B32_D02", "GOOGL_t10_L2_U128_U64_B32_D02", "GOOGL_t10_L2_U64_U64_B32_D02", "GOOGL_t10_L2_U64_U32_B32_D02", "GOOGL_t10_L2_U32_U32_B32_D02", "GOOGL_t10_L2_U32_U16_B32_D02", "GOOGL_t10_L2_U16_U16_B32_D02", "GOOGL_t10_L2_U16_U8_B32_D02", "GOOGL_t10_L2_U8_U8_B32_D02", "GOOGL_t10_L2_U128_U128_B64_D02", "GOOGL_t10_L2_U128_U64_B64_D02", "GOOGL_t10_L2_U64_U64_B64_D02", "GOOGL_t10_L2_U64_U32_B64_D02", "GOOGL_t10_L2_U32_U32_B64_D02", "GOOGL_t10_L2_U32_U16_B64_D02", "GOOGL_t10_L2_U16_U16_B64_D02", "GOOGL_t10_L2_U16_U8_B64_D02", "GOOGL_t10_L2_U8_U8_B64_D02"), 
              MSE = c(eval_GOOGL_10t_L2_U128_U128_B16_D02[['mse']], eval_GOOGL_10t_L2_U128_U64_B16_D02[['mse']], eval_GOOGL_10t_L2_U64_U64_B16_D02[['mse']], eval_GOOGL_10t_L2_U64_U32_B16_D02[['mse']], eval_GOOGL_10t_L2_U32_U32_B16_D02[['mse']], eval_GOOGL_10t_L2_U32_U16_B16_D02[['mse']], eval_GOOGL_10t_L2_U16_U16_B16_D02[['mse']], eval_GOOGL_10t_L2_U16_U8_B16_D02[['mse']], eval_GOOGL_10t_L2_U8_U8_B16_D02[['mse']], eval_GOOGL_10t_L2_U128_U128_B32_D02[['mse']], eval_GOOGL_10t_L2_U128_U64_B32_D02[['mse']], eval_GOOGL_10t_L2_U64_U64_B32_D02[['mse']], eval_GOOGL_10t_L2_U64_U32_B32_D02[['mse']], eval_GOOGL_10t_L2_U32_U32_B32_D02[['mse']], eval_GOOGL_10t_L2_U32_U16_B32_D02[['mse']], eval_GOOGL_10t_L2_U16_U16_B32_D02[['mse']], eval_GOOGL_10t_L2_U16_U8_B32_D02[['mse']], eval_GOOGL_10t_L2_U8_U8_B32_D02[['mse']], eval_GOOGL_10t_L2_U128_U128_B64_D02[['mse']], eval_GOOGL_10t_L2_U128_U64_B64_D02[['mse']], eval_GOOGL_10t_L2_U64_U64_B64_D02[['mse']], eval_GOOGL_10t_L2_U64_U32_B64_D02[['mse']], eval_GOOGL_10t_L2_U32_U32_B64_D02[['mse']], eval_GOOGL_10t_L2_U32_U16_B64_D02[['mse']], eval_GOOGL_10t_L2_U16_U16_B64_D02[['mse']], eval_GOOGL_10t_L2_U16_U8_B64_D02[['mse']], eval_GOOGL_10t_L2_U8_U8_B64_D02[['mse']]
))
```



```{r, warning=FALSE, results='hide'}
MSE_GOOGL_t10_L2_D03 <- data.frame(Model = c("GOOGL_t10_L2_U128_U128_B16_D03", "GOOGL_t10_L2_U128_U64_B16_D03", "GOOGL_t10_L2_U64_U64_B16_D03", "GOOGL_t10_L2_U64_U32_B16_D03", "GOOGL_t10_L2_U32_U32_B16_D03", "GOOGL_t10_L2_U32_U16_B16_D03", "GOOGL_t10_L2_U16_U16_B16_D03", "GOOGL_t10_L2_U16_U8_B16_D03", "GOOGL_t10_L2_U8_U8_B16_D03", "GOOGL_t10_L2_U128_U128_B32_D03", "GOOGL_t10_L2_U128_U64_B32_D03", "GOOGL_t10_L2_U64_U64_B32_D03", "GOOGL_t10_L2_U64_U32_B32_D03", "GOOGL_t10_L2_U32_U32_B32_D03", "GOOGL_t10_L2_U32_U16_B32_D03", "GOOGL_t10_L2_U16_U16_B32_D03", "GOOGL_t10_L2_U16_U8_B32_D03", "GOOGL_t10_L2_U8_U8_B32_D03", "GOOGL_t10_L2_U128_U128_B64_D03", "GOOGL_t10_L2_U128_U64_B64_D03", "GOOGL_t10_L2_U64_U64_B64_D03", "GOOGL_t10_L2_U64_U32_B64_D03", "GOOGL_t10_L2_U32_U32_B64_D03", "GOOGL_t10_L2_U32_U16_B64_D03", "GOOGL_t10_L2_U16_U16_B64_D03", "GOOGL_t10_L2_U16_U8_B64_D03", "GOOGL_t10_L2_U8_U8_B64_D03"), 
              MSE = c(eval_GOOGL_10t_L2_U128_U128_B16_D03[['mse']], eval_GOOGL_10t_L2_U128_U64_B16_D03[['mse']], eval_GOOGL_10t_L2_U64_U64_B16_D03[['mse']], eval_GOOGL_10t_L2_U64_U32_B16_D03[['mse']], eval_GOOGL_10t_L2_U32_U32_B16_D03[['mse']], eval_GOOGL_10t_L2_U32_U16_B16_D03[['mse']], eval_GOOGL_10t_L2_U16_U16_B16_D03[['mse']], eval_GOOGL_10t_L2_U16_U8_B16_D03[['mse']], eval_GOOGL_10t_L2_U8_U8_B16_D03[['mse']], eval_GOOGL_10t_L2_U128_U128_B32_D03[['mse']], eval_GOOGL_10t_L2_U128_U64_B32_D03[['mse']], eval_GOOGL_10t_L2_U64_U64_B32_D03[['mse']], eval_GOOGL_10t_L2_U64_U32_B32_D03[['mse']], eval_GOOGL_10t_L2_U32_U32_B32_D03[['mse']], eval_GOOGL_10t_L2_U32_U16_B32_D03[['mse']], eval_GOOGL_10t_L2_U16_U16_B32_D03[['mse']], eval_GOOGL_10t_L2_U16_U8_B32_D03[['mse']], eval_GOOGL_10t_L2_U8_U8_B32_D03[['mse']], eval_GOOGL_10t_L2_U128_U128_B64_D03[['mse']], eval_GOOGL_10t_L2_U128_U64_B64_D03[['mse']], eval_GOOGL_10t_L2_U64_U64_B64_D03[['mse']], eval_GOOGL_10t_L2_U64_U32_B64_D03[['mse']], eval_GOOGL_10t_L2_U32_U32_B64_D03[['mse']], eval_GOOGL_10t_L2_U32_U16_B64_D03[['mse']], eval_GOOGL_10t_L2_U16_U16_B64_D03[['mse']], eval_GOOGL_10t_L2_U16_U8_B64_D03[['mse']], eval_GOOGL_10t_L2_U8_U8_B64_D03[['mse']]
))
```



```{r, warning=FALSE, results='hide'}
MSE_GOOGL_t10_L3_D02 <- data.frame(Model = c("GOOGL_t10_L3_U128_U128_U128_B16_D02", "GOOGL_t10_L3_U128_U128_U64_B16_D02", "GOOGL_t10_L3_U128_U64_U64_B16_D02", "GOOGL_t10_L3_U64_U64_U64_B16_D02", "GOOGL_t10_L3_U64_U64_U32_B16_D02", "GOOGL_t10_L3_U64_U32_U32_B16_D02", "GOOGL_t10_L3_U64_U32_U16_B16_D02", "GOOGL_t10_L3_U32_U32_U32_B16_D02", "GOOGL_t10_L3_U32_U32_U16_B16_D02", "GOOGL_t10_L3_U32_U16_U16_B16_D02", "GOOGL_t10_L3_U32_U16_U8_B16_D02", "GOOGL_t10_L3_U16_U16_U16_B16_D02", "GOOGL_t10_L3_U16_U16_U8_B16_D02", "GOOGL_t10_L3_U16_U8_U8_B16_D02", "GOOGL_t10_L3_U8_U8_U8_B16_D02",
                                        
                                        "GOOGL_t10_L3_U128_U128_U128_B32_D02", "GOOGL_t10_L3_U128_U128_U64_B32_D02", "GOOGL_t10_L3_U128_U64_U64_B32_D02", "GOOGL_t10_L3_U64_U64_U64_B32_D02", "GOOGL_t10_L3_U64_U64_U32_B32_D02", "GOOGL_t10_L3_U64_U32_U32_B32_D02", "GOOGL_t10_L3_U64_U32_U16_B32_D02", "GOOGL_t10_L3_U32_U32_U32_B32_D02", "GOOGL_t10_L3_U32_U32_U16_B32_D02", "GOOGL_t10_L3_U32_U16_U16_B32_D02", "GOOGL_t10_L3_U32_U16_U8_B32_D02", "GOOGL_t10_L3_U16_U16_U16_B32_D02", "GOOGL_t10_L3_U16_U16_U8_B32_D02", "GOOGL_t10_L3_U16_U8_U8_B32_D02", "GOOGL_t10_L3_U8_U8_U8_B32_D02",
                                        "GOOGL_t10_L3_U128_U128_U128_B64_D02", "GOOGL_t10_L3_U128_U128_U64_B64_D02", "GOOGL_t10_L3_U128_U64_U64_B64_D02", "GOOGL_t10_L3_U64_U64_U64_B64_D02", "GOOGL_t10_L3_U64_U64_U32_B64_D02", "GOOGL_t10_L3_U64_U32_U32_B64_D02", "GOOGL_t10_L3_U64_U32_U16_B64_D02", "GOOGL_t10_L3_U32_U32_U32_B64_D02", "GOOGL_t10_L3_U32_U32_U16_B64_D02", "GOOGL_t10_L3_U32_U16_U16_B64_D02", "GOOGL_t10_L3_U32_U16_U8_B64_D02", "GOOGL_t10_L3_U16_U16_U16_B64_D02", "GOOGL_t10_L3_U16_U16_U8_B64_D02", "GOOGL_t10_L3_U16_U8_U8_B64_D02", "GOOGL_t10_L3_U8_U8_U8_B64_D02"), 
              MSE = c(eval_GOOGL_10t_L3_U128_U128_U128_B16_D02[['mse']], eval_GOOGL_10t_L3_U128_U128_U64_B16_D02[['mse']], eval_GOOGL_10t_L3_U128_U64_U64_B16_D02[['mse']], eval_GOOGL_10t_L3_U64_U64_U64_B16_D02[['mse']], eval_GOOGL_10t_L3_U64_U64_U32_B16_D02[['mse']], eval_GOOGL_10t_L3_U64_U32_U32_B16_D02[['mse']], eval_GOOGL_10t_L3_U64_U32_U16_B16_D02[['mse']], eval_GOOGL_10t_L3_U32_U32_U32_B16_D02[['mse']], eval_GOOGL_10t_L3_U32_U32_U16_B16_D02[['mse']], eval_GOOGL_10t_L3_U32_U16_U16_B16_D02[['mse']], eval_GOOGL_10t_L3_U32_U16_U8_B16_D02[['mse']], eval_GOOGL_10t_L3_U16_U16_U16_B16_D02[['mse']], eval_GOOGL_10t_L3_U16_U16_U8_B16_D02[['mse']], eval_GOOGL_10t_L3_U16_U8_U8_B16_D02[['mse']], eval_GOOGL_10t_L3_U8_U8_U8_B16_D02[['mse']] ,
                      eval_GOOGL_10t_L3_U128_U128_U128_B32_D02[['mse']], eval_GOOGL_10t_L3_U128_U128_U64_B32_D02[['mse']], eval_GOOGL_10t_L3_U128_U64_U64_B32_D02[['mse']], eval_GOOGL_10t_L3_U64_U64_U64_B32_D02[['mse']], eval_GOOGL_10t_L3_U64_U64_U32_B32_D02[['mse']], eval_GOOGL_10t_L3_U64_U32_U32_B32_D02[['mse']], eval_GOOGL_10t_L3_U64_U32_U16_B32_D02[['mse']], eval_GOOGL_10t_L3_U32_U32_U32_B32_D02[['mse']], eval_GOOGL_10t_L3_U32_U32_U16_B32_D02[['mse']], eval_GOOGL_10t_L3_U32_U16_U16_B32_D02[['mse']], eval_GOOGL_10t_L3_U32_U16_U8_B32_D02[['mse']], eval_GOOGL_10t_L3_U16_U16_U16_B32_D02[['mse']], eval_GOOGL_10t_L3_U16_U16_U8_B32_D02[['mse']], eval_GOOGL_10t_L3_U16_U8_U8_B32_D02[['mse']], eval_GOOGL_10t_L3_U8_U8_U8_B32_D02[['mse']] ,
                      eval_GOOGL_10t_L3_U128_U128_U128_B64_D02[['mse']], eval_GOOGL_10t_L3_U128_U128_U64_B64_D02[['mse']], eval_GOOGL_10t_L3_U128_U64_U64_B64_D02[['mse']], eval_GOOGL_10t_L3_U64_U64_U64_B64_D02[['mse']], eval_GOOGL_10t_L3_U64_U64_U32_B64_D02[['mse']], eval_GOOGL_10t_L3_U64_U32_U32_B64_D02[['mse']], eval_GOOGL_10t_L3_U64_U32_U16_B64_D02[['mse']], eval_GOOGL_10t_L3_U32_U32_U32_B64_D02[['mse']], eval_GOOGL_10t_L3_U32_U32_U16_B64_D02[['mse']], eval_GOOGL_10t_L3_U32_U16_U16_B64_D02[['mse']], eval_GOOGL_10t_L3_U32_U16_U8_B64_D02[['mse']], eval_GOOGL_10t_L3_U16_U16_U16_B64_D02[['mse']], eval_GOOGL_10t_L3_U16_U16_U8_B64_D02[['mse']], eval_GOOGL_10t_L3_U16_U8_U8_B64_D02[['mse']], eval_GOOGL_10t_L3_U8_U8_U8_B64_D02[['mse']] 
))
```




```{r, warning=FALSE, results='hide'}
MSE_GOOGL_t10_L3_D03 <- data.frame(Model = c("GOOGL_t10_L3_U128_U128_U128_B16_D03", "GOOGL_t10_L3_U128_U128_U64_B16_D03", "GOOGL_t10_L3_U128_U64_U64_B16_D03", "GOOGL_t10_L3_U64_U64_U64_B16_D03", "GOOGL_t10_L3_U64_U64_U32_B16_D03", "GOOGL_t10_L3_U64_U32_U32_B16_D03", "GOOGL_t10_L3_U64_U32_U16_B16_D03", "GOOGL_t10_L3_U32_U32_U32_B16_D03", "GOOGL_t10_L3_U32_U32_U16_B16_D03", "GOOGL_t10_L3_U32_U16_U16_B16_D03", "GOOGL_t10_L3_U32_U16_U8_B16_D03", "GOOGL_t10_L3_U16_U16_U16_B16_D03", "GOOGL_t10_L3_U16_U16_U8_B16_D03", "GOOGL_t10_L3_U16_U8_U8_B16_D03", "GOOGL_t10_L3_U8_U8_U8_B16_D03",
                                        
                                        "GOOGL_t10_L3_U128_U128_U128_B32_D03", "GOOGL_t10_L3_U128_U128_U64_B32_D03", "GOOGL_t10_L3_U128_U64_U64_B32_D03", "GOOGL_t10_L3_U64_U64_U64_B32_D03", "GOOGL_t10_L3_U64_U64_U32_B32_D03", "GOOGL_t10_L3_U64_U32_U32_B32_D03", "GOOGL_t10_L3_U64_U32_U16_B32_D03", "GOOGL_t10_L3_U32_U32_U32_B32_D03", "GOOGL_t10_L3_U32_U32_U16_B32_D03", "GOOGL_t10_L3_U32_U16_U16_B32_D03", "GOOGL_t10_L3_U32_U16_U8_B32_D03", "GOOGL_t10_L3_U16_U16_U16_B32_D03", "GOOGL_t10_L3_U16_U16_U8_B32_D03", "GOOGL_t10_L3_U16_U8_U8_B32_D03", "GOOGL_t10_L3_U8_U8_U8_B32_D03",
                                        "GOOGL_t10_L3_U128_U128_U128_B64_D03", "GOOGL_t10_L3_U128_U128_U64_B64_D03", "GOOGL_t10_L3_U128_U64_U64_B64_D03", "GOOGL_t10_L3_U64_U64_U64_B64_D03", "GOOGL_t10_L3_U64_U64_U32_B64_D03", "GOOGL_t10_L3_U64_U32_U32_B64_D03", "GOOGL_t10_L3_U64_U32_U16_B64_D03", "GOOGL_t10_L3_U32_U32_U32_B64_D03", "GOOGL_t10_L3_U32_U32_U16_B64_D03", "GOOGL_t10_L3_U32_U16_U16_B64_D03", "GOOGL_t10_L3_U32_U16_U8_B64_D03", "GOOGL_t10_L3_U16_U16_U16_B64_D03", "GOOGL_t10_L3_U16_U16_U8_B64_D03", "GOOGL_t10_L3_U16_U8_U8_B64_D03", "GOOGL_t10_L3_U8_U8_U8_B64_D03"), 
              MSE = c(eval_GOOGL_10t_L3_U128_U128_U128_B16_D03[['mse']], eval_GOOGL_10t_L3_U128_U128_U64_B16_D03[['mse']], eval_GOOGL_10t_L3_U128_U64_U64_B16_D03[['mse']], eval_GOOGL_10t_L3_U64_U64_U64_B16_D03[['mse']], eval_GOOGL_10t_L3_U64_U64_U32_B16_D03[['mse']], eval_GOOGL_10t_L3_U64_U32_U32_B16_D03[['mse']], eval_GOOGL_10t_L3_U64_U32_U16_B16_D03[['mse']], eval_GOOGL_10t_L3_U32_U32_U32_B16_D03[['mse']], eval_GOOGL_10t_L3_U32_U32_U16_B16_D03[['mse']], eval_GOOGL_10t_L3_U32_U16_U16_B16_D03[['mse']], eval_GOOGL_10t_L3_U32_U16_U8_B16_D03[['mse']], eval_GOOGL_10t_L3_U16_U16_U16_B16_D03[['mse']], eval_GOOGL_10t_L3_U16_U16_U8_B16_D03[['mse']], eval_GOOGL_10t_L3_U16_U8_U8_B16_D03[['mse']], eval_GOOGL_10t_L3_U8_U8_U8_B16_D03[['mse']] ,
                      eval_GOOGL_10t_L3_U128_U128_U128_B32_D03[['mse']], eval_GOOGL_10t_L3_U128_U128_U64_B32_D03[['mse']], eval_GOOGL_10t_L3_U128_U64_U64_B32_D03[['mse']], eval_GOOGL_10t_L3_U64_U64_U64_B32_D03[['mse']], eval_GOOGL_10t_L3_U64_U64_U32_B32_D03[['mse']], eval_GOOGL_10t_L3_U64_U32_U32_B32_D03[['mse']], eval_GOOGL_10t_L3_U64_U32_U16_B32_D03[['mse']], eval_GOOGL_10t_L3_U32_U32_U32_B32_D03[['mse']], eval_GOOGL_10t_L3_U32_U32_U16_B32_D03[['mse']], eval_GOOGL_10t_L3_U32_U16_U16_B32_D03[['mse']], eval_GOOGL_10t_L3_U32_U16_U8_B32_D03[['mse']], eval_GOOGL_10t_L3_U16_U16_U16_B32_D03[['mse']], eval_GOOGL_10t_L3_U16_U16_U8_B32_D03[['mse']], eval_GOOGL_10t_L3_U16_U8_U8_B32_D03[['mse']], eval_GOOGL_10t_L3_U8_U8_U8_B32_D03[['mse']] ,
                      eval_GOOGL_10t_L3_U128_U128_U128_B64_D03[['mse']], eval_GOOGL_10t_L3_U128_U128_U64_B64_D03[['mse']], eval_GOOGL_10t_L3_U128_U64_U64_B64_D03[['mse']], eval_GOOGL_10t_L3_U64_U64_U64_B64_D03[['mse']], eval_GOOGL_10t_L3_U64_U64_U32_B64_D03[['mse']], eval_GOOGL_10t_L3_U64_U32_U32_B64_D03[['mse']], eval_GOOGL_10t_L3_U64_U32_U16_B64_D03[['mse']], eval_GOOGL_10t_L3_U32_U32_U32_B64_D03[['mse']], eval_GOOGL_10t_L3_U32_U32_U16_B64_D03[['mse']], eval_GOOGL_10t_L3_U32_U16_U16_B64_D03[['mse']], eval_GOOGL_10t_L3_U32_U16_U8_B64_D03[['mse']], eval_GOOGL_10t_L3_U16_U16_U16_B64_D03[['mse']], eval_GOOGL_10t_L3_U16_U16_U8_B64_D03[['mse']], eval_GOOGL_10t_L3_U16_U8_U8_B64_D03[['mse']], eval_GOOGL_10t_L3_U8_U8_U8_B64_D03[['mse']] 
))
```





```{r, warning=FALSE, results='hide'}
MSE_GOOGL_t10_L4_D02 <- data.frame(Model = c("GOOGL_10t_L4_U128_U128_U128_U128_B16_D02", "GOOGL_10t_L4_U128_U128_U128_U64_B16_D02",  "GOOGL_10t_L4_U128_U128_U64_U64_B16_D02",  "GOOGL_10t_L4_U128_U64_U64_U64_B16_D02", "GOOGL_10t_L4_U128_U64_U64_U32_B16_D02","GOOGL_10t_L4_U64_U64_U64_U64_B16_D02",  "GOOGL_10t_L4_U64_U64_U64_U32_B16_D02",  "GOOGL_10t_L4_U64_U64_U32_U32_B16_D02", "GOOGL_10t_L4_U64_U32_U32_U32_B16_D02", "GOOGL_10t_L4_U64_U32_U32_U16_B16_D02", "GOOGL_10t_L4_U32_U32_U32_U32_B16_D02", "GOOGL_10t_L4_U32_U32_U32_U16_B16_D02",  "GOOGL_10t_L4_U32_U32_U16_U16_B16_D02", "GOOGL_10t_L4_U32_U16_U16_U16_B16_D02", "GOOGL_10t_L4_U32_U16_U16_U8_B16_D02", "GOOGL_10t_L4_U16_U16_U16_U16_B16_D02", "GOOGL_10t_L4_U16_U16_U16_U8_B16_D02",  "GOOGL_10t_L4_U16_U16_U8_U8_B16_D02", "GOOGL_10t_L4_U16_U8_U8_U8_B16_D02", 
                                        "GOOGL_10t_L4_U128_U128_U128_U128_B32_D02", "GOOGL_10t_L4_U128_U128_U128_U64_B32_D02",  "GOOGL_10t_L4_U128_U128_U64_U64_B32_D02",  "GOOGL_10t_L4_U128_U64_U64_U64_B32_D02", "GOOGL_10t_L4_U128_U64_U64_U32_B32_D02","GOOGL_10t_L4_U64_U64_U64_U64_B32_D02",  "GOOGL_10t_L4_U64_U64_U64_U32_B32_D02",  "GOOGL_10t_L4_U64_U64_U32_U32_B32_D02", "GOOGL_10t_L4_U64_U32_U32_U32_B32_D02", "GOOGL_10t_L4_U64_U32_U32_U16_B32_D02", "GOOGL_10t_L4_U32_U32_U32_U32_B32_D02", "GOOGL_10t_L4_U32_U32_U32_U16_B32_D02",  "GOOGL_10t_L4_U32_U32_U16_U16_B32_D02", "GOOGL_10t_L4_U32_U16_U16_U16_B32_D02", "GOOGL_10t_L4_U32_U16_U16_U8_B32_D02", "GOOGL_10t_L4_U16_U16_U16_U16_B32_D02", "GOOGL_10t_L4_U16_U16_U16_U8_B32_D02",  "GOOGL_10t_L4_U16_U16_U8_U8_B32_D02", "GOOGL_10t_L4_U16_U8_U8_U8_B32_D02",
                                        "GOOGL_10t_L4_U128_U128_U128_U128_B64_D02", "GOOGL_10t_L4_U128_U128_U128_U64_B64_D02",  "GOOGL_10t_L4_U128_U128_U64_U64_B64_D02",  "GOOGL_10t_L4_U128_U64_U64_U64_B64_D02", "GOOGL_10t_L4_U128_U64_U64_U32_B64_D02","GOOGL_10t_L4_U64_U64_U64_U64_B64_D02",  "GOOGL_10t_L4_U64_U64_U64_U32_B64_D02",  "GOOGL_10t_L4_U64_U64_U32_U32_B64_D02", "GOOGL_10t_L4_U64_U32_U32_U32_B64_D02", "GOOGL_10t_L4_U64_U32_U32_U16_B64_D02", "GOOGL_10t_L4_U32_U32_U32_U32_B64_D02", "GOOGL_10t_L4_U32_U32_U32_U16_B64_D02",  "GOOGL_10t_L4_U32_U32_U16_U16_B64_D02", "GOOGL_10t_L4_U32_U16_U16_U16_B64_D02", "GOOGL_10t_L4_U32_U16_U16_U8_B64_D02", "GOOGL_10t_L4_U16_U16_U16_U16_B64_D02", "GOOGL_10t_L4_U16_U16_U16_U8_B64_D02",  "GOOGL_10t_L4_U16_U16_U8_U8_B64_D02", "GOOGL_10t_L4_U16_U8_U8_U8_B64_D02"), 
              MSE = c(eval_GOOGL_10t_L4_U128_U128_U128_U128_B16_D02[['mse']], eval_GOOGL_10t_L4_U128_U128_U128_U64_B16_D02[['mse']],  eval_GOOGL_10t_L4_U128_U128_U64_U64_B16_D02[['mse']],  eval_GOOGL_10t_L4_U128_U64_U64_U64_B16_D02[['mse']], eval_GOOGL_10t_L4_U128_U64_U64_U32_B16_D02[['mse']],eval_GOOGL_10t_L4_U64_U64_U64_U64_B16_D02[['mse']],  eval_GOOGL_10t_L4_U64_U64_U64_U32_B16_D02[['mse']],  eval_GOOGL_10t_L4_U64_U64_U32_U32_B16_D02[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U32_B16_D02[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U16_B16_D02[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U32_B16_D02[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U16_B16_D02[['mse']],  eval_GOOGL_10t_L4_U32_U32_U16_U16_B16_D02[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U16_B16_D02[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U8_B16_D02[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U16_B16_D02[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U8_B16_D02[['mse']],  eval_GOOGL_10t_L4_U16_U16_U8_U8_B16_D02[['mse']], eval_GOOGL_10t_L4_U16_U8_U8_U8_B16_D02[['mse']],
                      eval_GOOGL_10t_L4_U128_U128_U128_U128_B32_D02[['mse']], eval_GOOGL_10t_L4_U128_U128_U128_U64_B32_D02[['mse']],  eval_GOOGL_10t_L4_U128_U128_U64_U64_B32_D02[['mse']],  eval_GOOGL_10t_L4_U128_U64_U64_U64_B32_D02[['mse']], eval_GOOGL_10t_L4_U128_U64_U64_U32_B32_D02[['mse']],eval_GOOGL_10t_L4_U64_U64_U64_U64_B32_D02[['mse']],  eval_GOOGL_10t_L4_U64_U64_U64_U32_B32_D02[['mse']],  eval_GOOGL_10t_L4_U64_U64_U32_U32_B32_D02[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U32_B32_D02[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U16_B32_D02[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U32_B32_D02[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U16_B32_D02[['mse']],  eval_GOOGL_10t_L4_U32_U32_U16_U16_B32_D02[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U16_B32_D02[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U8_B32_D02[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U16_B32_D02[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U8_B32_D02[['mse']],  eval_GOOGL_10t_L4_U16_U16_U8_U8_B32_D02[['mse']], eval_GOOGL_10t_L4_U16_U8_U8_U8_B32_D02[['mse']],
                      eval_GOOGL_10t_L4_U128_U128_U128_U128_B64_D02[['mse']], eval_GOOGL_10t_L4_U128_U128_U128_U64_B64_D02[['mse']],  eval_GOOGL_10t_L4_U128_U128_U64_U64_B64_D02[['mse']],  eval_GOOGL_10t_L4_U128_U64_U64_U64_B64_D02[['mse']], eval_GOOGL_10t_L4_U128_U64_U64_U32_B64_D02[['mse']],eval_GOOGL_10t_L4_U64_U64_U64_U64_B64_D02[['mse']],  eval_GOOGL_10t_L4_U64_U64_U64_U32_B64_D02[['mse']],  eval_GOOGL_10t_L4_U64_U64_U32_U32_B64_D02[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U32_B64_D02[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U16_B64_D02[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U32_B64_D02[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U16_B64_D02[['mse']],  eval_GOOGL_10t_L4_U32_U32_U16_U16_B64_D02[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U16_B64_D02[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U8_B64_D02[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U16_B64_D02[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U8_B64_D02[['mse']],  eval_GOOGL_10t_L4_U16_U16_U8_U8_B64_D02[['mse']], eval_GOOGL_10t_L4_U16_U8_U8_U8_B64_D02[['mse']]
                                       
))
```


```{r, warning=FALSE, results='hide'}
MSE_GOOGL_t10_L4_D032 <- data.frame(Model = c("GOOGL_10t_L4_U128_U128_U128_U128_B16_D03", "GOOGL_10t_L4_U128_U128_U128_U64_B16_D03",  "GOOGL_10t_L4_U128_U128_U64_U64_B16_D03",  "GOOGL_10t_L4_U128_U64_U64_U64_B16_D03", "GOOGL_10t_L4_U128_U64_U64_U32_B16_D03","GOOGL_10t_L4_U64_U64_U64_U64_B16_D03",  "GOOGL_10t_L4_U64_U64_U64_U32_B16_D03",  "GOOGL_10t_L4_U64_U64_U32_U32_B16_D03", "GOOGL_10t_L4_U64_U32_U32_U32_B16_D03", "GOOGL_10t_L4_U64_U32_U32_U16_B16_D03", "GOOGL_10t_L4_U32_U32_U32_U32_B16_D03", "GOOGL_10t_L4_U32_U32_U32_U16_B16_D03",  "GOOGL_10t_L4_U32_U32_U16_U16_B16_D03", "GOOGL_10t_L4_U32_U16_U16_U16_B16_D03", "GOOGL_10t_L4_U32_U16_U16_U8_B16_D03", "GOOGL_10t_L4_U16_U16_U16_U16_B16_D03", "GOOGL_10t_L4_U16_U16_U16_U8_B16_D03",  "GOOGL_10t_L4_U16_U16_U8_U8_B16_D03", "GOOGL_10t_L4_U16_U8_U8_U8_B16_D03", 
                                        "GOOGL_10t_L4_U128_U128_U128_U128_B32_D03", "GOOGL_10t_L4_U128_U128_U128_U64_B32_D03",  "GOOGL_10t_L4_U128_U128_U64_U64_B32_D03",  "GOOGL_10t_L4_U128_U64_U64_U64_B32_D03", "GOOGL_10t_L4_U128_U64_U64_U32_B32_D03","GOOGL_10t_L4_U64_U64_U64_U64_B32_D03",  "GOOGL_10t_L4_U64_U64_U64_U32_B32_D03",  "GOOGL_10t_L4_U64_U64_U32_U32_B32_D03", "GOOGL_10t_L4_U64_U32_U32_U32_B32_D03", "GOOGL_10t_L4_U64_U32_U32_U16_B32_D03", "GOOGL_10t_L4_U32_U32_U32_U32_B32_D03", "GOOGL_10t_L4_U32_U32_U32_U16_B32_D03",  "GOOGL_10t_L4_U32_U32_U16_U16_B32_D03", "GOOGL_10t_L4_U32_U16_U16_U16_B32_D03", "GOOGL_10t_L4_U32_U16_U16_U8_B32_D03", "GOOGL_10t_L4_U16_U16_U16_U16_B32_D03", "GOOGL_10t_L4_U16_U16_U16_U8_B32_D03",  "GOOGL_10t_L4_U16_U16_U8_U8_B32_D03", "GOOGL_10t_L4_U16_U8_U8_U8_B32_D03",
                                        "GOOGL_10t_L4_U128_U128_U128_U128_B64_D03", "GOOGL_10t_L4_U128_U128_U128_U64_B64_D03",  "GOOGL_10t_L4_U128_U128_U64_U64_B64_D03",  "GOOGL_10t_L4_U128_U64_U64_U64_B64_D03", "GOOGL_10t_L4_U128_U64_U64_U32_B64_D03","GOOGL_10t_L4_U64_U64_U64_U64_B64_D03",  "GOOGL_10t_L4_U64_U64_U64_U32_B64_D03",  "GOOGL_10t_L4_U64_U64_U32_U32_B64_D03", "GOOGL_10t_L4_U64_U32_U32_U32_B64_D03", "GOOGL_10t_L4_U64_U32_U32_U16_B64_D03", "GOOGL_10t_L4_U32_U32_U32_U32_B64_D03", "GOOGL_10t_L4_U32_U32_U32_U16_B64_D03",  "GOOGL_10t_L4_U32_U32_U16_U16_B64_D03", "GOOGL_10t_L4_U32_U16_U16_U16_B64_D03", "GOOGL_10t_L4_U32_U16_U16_U8_B64_D03", "GOOGL_10t_L4_U16_U16_U16_U16_B64_D03", "GOOGL_10t_L4_U16_U16_U16_U8_B64_D03",  "GOOGL_10t_L4_U16_U16_U8_U8_B64_D03", "GOOGL_10t_L4_U16_U8_U8_U8_B64_D03"), 
              MSE = c(eval_GOOGL_10t_L4_U128_U128_U128_U128_B16_D03[['mse']], eval_GOOGL_10t_L4_U128_U128_U128_U64_B16_D03[['mse']],  eval_GOOGL_10t_L4_U128_U128_U64_U64_B16_D03[['mse']],  eval_GOOGL_10t_L4_U128_U64_U64_U64_B16_D03[['mse']], eval_GOOGL_10t_L4_U128_U64_U64_U32_B16_D03[['mse']],eval_GOOGL_10t_L4_U64_U64_U64_U64_B16_D03[['mse']],  eval_GOOGL_10t_L4_U64_U64_U64_U32_B16_D03[['mse']],  eval_GOOGL_10t_L4_U64_U64_U32_U32_B16_D03[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U32_B16_D03[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U16_B16_D03[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U32_B16_D03[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U16_B16_D03[['mse']],  eval_GOOGL_10t_L4_U32_U32_U16_U16_B16_D03[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U16_B16_D03[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U8_B16_D03[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U16_B16_D03[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U8_B16_D03[['mse']],  eval_GOOGL_10t_L4_U16_U16_U8_U8_B16_D03[['mse']], eval_GOOGL_10t_L4_U16_U8_U8_U8_B16_D03[['mse']],
                      eval_GOOGL_10t_L4_U128_U128_U128_U128_B32_D03[['mse']], eval_GOOGL_10t_L4_U128_U128_U128_U64_B32_D03[['mse']],  eval_GOOGL_10t_L4_U128_U128_U64_U64_B32_D03[['mse']],  eval_GOOGL_10t_L4_U128_U64_U64_U64_B32_D03[['mse']], eval_GOOGL_10t_L4_U128_U64_U64_U32_B32_D03[['mse']],eval_GOOGL_10t_L4_U64_U64_U64_U64_B32_D03[['mse']],  eval_GOOGL_10t_L4_U64_U64_U64_U32_B32_D03[['mse']],  eval_GOOGL_10t_L4_U64_U64_U32_U32_B32_D03[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U32_B32_D03[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U16_B32_D03[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U32_B32_D03[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U16_B32_D03[['mse']],  eval_GOOGL_10t_L4_U32_U32_U16_U16_B32_D03[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U16_B32_D03[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U8_B32_D03[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U16_B32_D03[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U8_B32_D03[['mse']],  eval_GOOGL_10t_L4_U16_U16_U8_U8_B32_D03[['mse']], eval_GOOGL_10t_L4_U16_U8_U8_U8_B32_D03[['mse']],
                      eval_GOOGL_10t_L4_U128_U128_U128_U128_B64_D03[['mse']], eval_GOOGL_10t_L4_U128_U128_U128_U64_B64_D03[['mse']],  eval_GOOGL_10t_L4_U128_U128_U64_U64_B64_D03[['mse']],  eval_GOOGL_10t_L4_U128_U64_U64_U64_B64_D03[['mse']], eval_GOOGL_10t_L4_U128_U64_U64_U32_B64_D03[['mse']],eval_GOOGL_10t_L4_U64_U64_U64_U64_B64_D03[['mse']],  eval_GOOGL_10t_L4_U64_U64_U64_U32_B64_D03[['mse']],  eval_GOOGL_10t_L4_U64_U64_U32_U32_B64_D03[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U32_B64_D03[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U16_B64_D03[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U32_B64_D03[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U16_B64_D03[['mse']],  eval_GOOGL_10t_L4_U32_U32_U16_U16_B64_D03[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U16_B64_D03[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U8_B64_D03[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U16_B64_D03[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U8_B64_D03[['mse']],  eval_GOOGL_10t_L4_U16_U16_U8_U8_B64_D03[['mse']], eval_GOOGL_10t_L4_U16_U8_U8_U8_B64_D03[['mse']]
))
```

```{r, warning=FALSE, results='hide'}
MSE_GOOGL_t10_L4_D03 <- data.frame(Model = c("GOOGL_10t_L4_U128_U128_U128_U128_B16_D03", "GOOGL_10t_L4_U128_U128_U128_U64_B16_D03",  "GOOGL_10t_L4_U128_U128_U64_U64_B16_D03",  "GOOGL_10t_L4_U128_U64_U64_U64_B16_D03", "GOOGL_10t_L4_U128_U64_U64_U32_B16_D03","GOOGL_10t_L4_U64_U64_U64_U64_B16_D03",  "GOOGL_10t_L4_U64_U64_U64_U32_B16_D03",  "GOOGL_10t_L4_U64_U64_U32_U32_B16_D03", "GOOGL_10t_L4_U64_U32_U32_U32_B16_D03", "GOOGL_10t_L4_U64_U32_U32_U16_B16_D03", "GOOGL_10t_L4_U32_U32_U32_U32_B16_D03", "GOOGL_10t_L4_U32_U32_U32_U16_B16_D03",  "GOOGL_10t_L4_U32_U32_U16_U16_B16_D03", "GOOGL_10t_L4_U32_U16_U16_U16_B16_D03", "GOOGL_10t_L4_U32_U16_U16_U8_B16_D03", "GOOGL_10t_L4_U16_U16_U16_U16_B16_D03", "GOOGL_10t_L4_U16_U16_U16_U8_B16_D03",  "GOOGL_10t_L4_U16_U16_U8_U8_B16_D03", "GOOGL_10t_L4_U16_U8_U8_U8_B16_D03", 
                                        "GOOGL_10t_L4_U128_U128_U128_U128_B32_D03", "GOOGL_10t_L4_U128_U128_U128_U64_B32_D03",  "GOOGL_10t_L4_U128_U128_U64_U64_B32_D03",  "GOOGL_10t_L4_U128_U64_U64_U64_B32_D03", "GOOGL_10t_L4_U128_U64_U64_U32_B32_D03","GOOGL_10t_L4_U64_U64_U64_U64_B32_D03",  "GOOGL_10t_L4_U64_U64_U64_U32_B32_D03",  "GOOGL_10t_L4_U64_U64_U32_U32_B32_D03", "GOOGL_10t_L4_U64_U32_U32_U32_B32_D03", "GOOGL_10t_L4_U64_U32_U32_U16_B32_D03", "GOOGL_10t_L4_U32_U32_U32_U32_B32_D03", "GOOGL_10t_L4_U32_U32_U32_U16_B32_D03",  "GOOGL_10t_L4_U32_U32_U16_U16_B32_D03", "GOOGL_10t_L4_U32_U16_U16_U16_B32_D03", "GOOGL_10t_L4_U32_U16_U16_U8_B32_D03", "GOOGL_10t_L4_U16_U16_U16_U16_B32_D03", "GOOGL_10t_L4_U16_U16_U16_U8_B32_D03",  "GOOGL_10t_L4_U16_U16_U8_U8_B32_D03", "GOOGL_10t_L4_U16_U8_U8_U8_B32_D03",
                                        "GOOGL_10t_L4_U128_U128_U128_U128_B64_D03", "GOOGL_10t_L4_U128_U128_U128_U64_B64_D03",  "GOOGL_10t_L4_U128_U128_U64_U64_B64_D03",  "GOOGL_10t_L4_U128_U64_U64_U64_B64_D03", "GOOGL_10t_L4_U128_U64_U64_U32_B64_D03","GOOGL_10t_L4_U64_U64_U64_U64_B64_D03",  "GOOGL_10t_L4_U64_U64_U64_U32_B64_D03",  "GOOGL_10t_L4_U64_U64_U32_U32_B64_D03", "GOOGL_10t_L4_U64_U32_U32_U32_B64_D03", "GOOGL_10t_L4_U64_U32_U32_U16_B64_D03", "GOOGL_10t_L4_U32_U32_U32_U32_B64_D03", "GOOGL_10t_L4_U32_U32_U32_U16_B64_D03",  "GOOGL_10t_L4_U32_U32_U16_U16_B64_D03", "GOOGL_10t_L4_U32_U16_U16_U16_B64_D03", "GOOGL_10t_L4_U32_U16_U16_U8_B64_D03", "GOOGL_10t_L4_U16_U16_U16_U16_B64_D03", "GOOGL_10t_L4_U16_U16_U16_U8_B64_D03",  "GOOGL_10t_L4_U16_U16_U8_U8_B64_D03", "GOOGL_10t_L4_U16_U8_U8_U8_B64_D03"), 
              MSE = c(eval_GOOGL_10t_L4_U128_U128_U128_U128_B16_D03[['mse']], eval_GOOGL_10t_L4_U128_U128_U128_U64_B16_D03[['mse']],  eval_GOOGL_10t_L4_U128_U128_U64_U64_B16_D03[['mse']],  eval_GOOGL_10t_L4_U128_U64_U64_U64_B16_D03[['mse']], eval_GOOGL_10t_L4_U128_U64_U64_U32_B16_D03[['mse']],eval_GOOGL_10t_L4_U64_U64_U64_U64_B16_D03[['mse']],  eval_GOOGL_10t_L4_U64_U64_U64_U32_B16_D03[['mse']],  eval_GOOGL_10t_L4_U64_U64_U32_U32_B16_D03[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U32_B16_D03[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U16_B16_D03[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U32_B16_D03[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U16_B16_D03[['mse']],  eval_GOOGL_10t_L4_U32_U32_U16_U16_B16_D03[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U16_B16_D03[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U8_B16_D03[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U16_B16_D03[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U8_B16_D03[['mse']],  eval_GOOGL_10t_L4_U16_U16_U8_U8_B16_D03[['mse']], eval_GOOGL_10t_L4_U16_U8_U8_U8_B16_D03[['mse']],
                      eval_GOOGL_10t_L4_U128_U128_U128_U128_B32_D03[['mse']], eval_GOOGL_10t_L4_U128_U128_U128_U64_B32_D03[['mse']],  eval_GOOGL_10t_L4_U128_U128_U64_U64_B32_D03[['mse']],  eval_GOOGL_10t_L4_U128_U64_U64_U64_B32_D03[['mse']], eval_GOOGL_10t_L4_U128_U64_U64_U32_B32_D03[['mse']],eval_GOOGL_10t_L4_U64_U64_U64_U64_B32_D03[['mse']],  eval_GOOGL_10t_L4_U64_U64_U64_U32_B32_D03[['mse']],  eval_GOOGL_10t_L4_U64_U64_U32_U32_B32_D03[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U32_B32_D03[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U16_B32_D03[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U32_B32_D03[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U16_B32_D03[['mse']],  eval_GOOGL_10t_L4_U32_U32_U16_U16_B32_D03[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U16_B32_D03[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U8_B32_D03[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U16_B32_D03[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U8_B32_D03[['mse']],  eval_GOOGL_10t_L4_U16_U16_U8_U8_B32_D03[['mse']], eval_GOOGL_10t_L4_U16_U8_U8_U8_B32_D03[['mse']],
                      eval_GOOGL_10t_L4_U128_U128_U128_U128_B64_D03[['mse']], eval_GOOGL_10t_L4_U128_U128_U128_U64_B64_D03[['mse']],  eval_GOOGL_10t_L4_U128_U128_U64_U64_B64_D03[['mse']],  eval_GOOGL_10t_L4_U128_U64_U64_U64_B64_D03[['mse']], eval_GOOGL_10t_L4_U128_U64_U64_U32_B64_D03[['mse']],eval_GOOGL_10t_L4_U64_U64_U64_U64_B64_D03[['mse']],  eval_GOOGL_10t_L4_U64_U64_U64_U32_B64_D03[['mse']],  eval_GOOGL_10t_L4_U64_U64_U32_U32_B64_D03[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U32_B64_D03[['mse']], eval_GOOGL_10t_L4_U64_U32_U32_U16_B64_D03[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U32_B64_D03[['mse']], eval_GOOGL_10t_L4_U32_U32_U32_U16_B64_D03[['mse']],  eval_GOOGL_10t_L4_U32_U32_U16_U16_B64_D03[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U16_B64_D03[['mse']], eval_GOOGL_10t_L4_U32_U16_U16_U8_B64_D03[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U16_B64_D03[['mse']], eval_GOOGL_10t_L4_U16_U16_U16_U8_B64_D03[['mse']],  eval_GOOGL_10t_L4_U16_U16_U8_U8_B64_D03[['mse']], eval_GOOGL_10t_L4_U16_U8_U8_U8_B64_D03[['mse']]
))
```



### Optimal model


```{r}
A <- MSE_GOOGL_t1_L2_D02[which.min(MSE_GOOGL_t1_L2_D02$MSE),]
B <- MSE_GOOGL_t1_L2_D03[which.min(MSE_GOOGL_t1_L2_D03$MSE),]
C <- MSE_GOOGL_t1_L3_D02[which.min(MSE_GOOGL_t1_L3_D02$MSE),]
D <- MSE_GOOGL_t1_L3_D03[which.min(MSE_GOOGL_t1_L3_D03$MSE),] 
E <- MSE_GOOGL_t1_L4_D02[which.min(MSE_GOOGL_t1_L4_D02$MSE),]
G <- MSE_GOOGL_t1_L4_D03[which.min(MSE_GOOGL_t1_L4_D03$MSE),]
H <- MSE_GOOGL_t10_L2_D02[which.min(MSE_GOOGL_t10_L2_D02$MSE),]
I <- MSE_GOOGL_t10_L2_D03[which.min(MSE_GOOGL_t10_L2_D03$MSE),]
J <- MSE_GOOGL_t10_L3_D02[which.min(MSE_GOOGL_t10_L3_D02$MSE),]
K <- MSE_GOOGL_t10_L3_D03[which.min(MSE_GOOGL_t10_L3_D03$MSE),]
L <- MSE_GOOGL_t10_L4_D02[which.min(MSE_GOOGL_t10_L4_D02$MSE),]
M <- MSE_GOOGL_t10_L4_D03[which.min(MSE_GOOGL_t10_L4_D03$MSE),]
List <- rbind(A,B,C,D,E,G,H,I,J,K,L,M)
```

```{r}
write.csv(L,"GOOGL-List.csv")
```


```{r, warning=FALSE, results='hide'}
L <- rbind(MSE_GOOGL_t1_L4_D02, MSE_GOOGL_t1_L4_D03, MSE_GOOGL_t1_L3_D02, MSE_GOOGL_t1_L3_D03, MSE_GOOGL_t1_L2_D03, MSE_GOOGL_t1_L2_D02, MSE_GOOGL_t10_L4_D02, MSE_GOOGL_t10_L4_D03, MSE_GOOGL_t10_L3_D02, MSE_GOOGL_t10_L3_D03, MSE_GOOGL_t10_L2_D03, MSE_GOOGL_t10_L2_D02)
```

```{r}
write.csv(L,"GOOGL-MSE.csv")
```

```{r}
L[which.min(L$MSE),]
```






